[
  {
    "title": "Like the Bitset",
    "url": "https://codeforces.com/problemset/problem/2136/B",
    "description": "  You are given a binary string∗^{\\text{∗}} ss of length nn, as well as an integer kk.Aquawave wants to construct a permutation†^{\\text{†}} pp of length nn, so that for each 1≤i≤n1\\le i\\le n, where si=1s_i=\\mathtt{1}, the following holds:  For each interval [l,r][l, r] (1≤l≤r≤n1\\le l\\le r\\le n) whose length is at least kk (i.e. r−l+1≥kr - l + 1 \\geq k), if it covers position ii (i.e. l≤i≤rl \\leq i \\leq r), then the maximum element among pl,pl+1,…,prp_l, p_{l+1}, \\ldots, p_r is not pip_i. Note that there are no such constraints on indices with si=0s_i = \\mathtt{0}.You have to find such a permutation, or determine that such permutations do not exist.∗^{\\text{∗}}A binary string is a string where each character is either 0\\mathtt{0} or 1\\mathtt{1}.†^{\\text{†}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). "
  },
  {
    "title": "In the Dream",
    "url": "https://codeforces.com/problemset/problem/2136/A",
    "description": "Two football teams, the RiOI team and the KDOI team, are about to have a football match. A football match consists of two halves — the first half and the second half. At the beginning of the match, both teams have a score of 00.As a fan of both teams, Aquawave knows that the two teams have similar levels, so neither team will score three consecutive goals in the same half.Aquawave had a dream the night before the match, in which:  The score at the end of the first half was a:ba:b, where aa is the score of the RiOI team, and bb is the score of the KDOI team;  And, the score at the end of the second half was c:dc:d, where cc is the score of the RiOI team, and dd is the score of the KDOI team. You have to determine whether Aquawave's dream can come true according to the above information."
  },
  {
    "title": "To the Infinity",
    "url": "https://codeforces.com/problemset/problem/2135/F",
    "description": "    You are given a full binary tree∗^{\\text{∗}} of nn nodes, rooted at node 11. For each node uu (1≤u≤n1\\le u\\le n), we define function fu:R+→R+f_u : \\mathbb R_+ \\to \\mathbb R_+ as follows:  If uu is a leaf†^{\\text{†}}, then fu(x)=xf_u(x)=x;  Otherwise, denote the left child of uu as lul_u and the right child of uu as rur_u, then fu(x)=(flu(x))fru(x)f_u(x)=(f_{l_u}(x))^{f_{r_u}(x)}. For two nodes uu and vv, we say u≺vu\\prec v if and only if one of the following holds:  fu(x)<fv(x)f_{u}(x)<f_{v}(x) when x→∞x\\to\\infty;  u<vu<v, and fu(x)=fv(x)f_{u}(x)=f_{v}(x) when x→∞x\\to\\infty‡^{\\text{‡}}. It can be shown that for any two distinct nodes uu and vv, either u≺vu\\prec v or v≺uv\\prec u holds. You have to sort the nodes by order ≺\\prec. Formally, you need to find a permutation§^{\\text{§}} pp of length nn, such that for every 1≤i<n1\\le i<n, pi≺pi+1p_i\\prec p_{i+1}.∗^{\\text{∗}}A full binary tree is a rooted tree, in which each node has 00 or 22 children. †^{\\text{†}}A leaf is any vertex without children. ‡^{\\text{‡}}Here, fu(x)<fv(x)f_u(x) < f_v(x) when x→∞x\\to\\infty is equivalent to the following description: there exists a positive number NN such that for all x>Nx > N, fu(x)<fv(x)f_u(x) < f_v(x) holds. The same is defined for fu(x)=fv(x)f_u(x) = f_v(x) when x→∞x\\to \\infty.§^{\\text{§}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). "
  },
  {
    "title": "Beyond the Palindrome (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2135/E2",
    "description": "   This is the hard version of the problem. The difference between the versions is that in this version, n≤2⋅107n\\le 2\\cdot 10^7, and the sum of nn over all test cases does not exceed 10810^8. You can hack only if you solved all versions of this problem. For a binary string∗^{\\text{∗}} rr, we define f(r)f(r) as the result of the following process: Delete all 10\\texttt{10} substrings†^{\\text{†}} simultaneously from rr;  Repeat the above operation until there are no 10\\texttt{10} substrings in rr.For example, f(100110001)=001f(\\mathtt{100110001})=\\mathtt{001} because rr changes as follows: 10_0110_001→010_01→001\\mathtt{\\underline{10}01\\underline{10}001}\\to \\mathtt{0\\underline{10}01}\\to\\mathtt{001}.We call a binary string ss almost-palindrome if and only if f(s)=f(rev(s))f(s)=f(\\mathrm{rev}(s))‡^{\\text{‡}}.Aquawave has given you an integer nn. You have to help him find the number of distinct almost-palindrome binary strings of length nn, modulo 998244353998\\,244\\,353.∗^{\\text{∗}}A binary string is a string where each character is either 0\\texttt{0} or 1\\texttt{1}.†^{\\text{†}}A string aa is a substring of a string bb if aa can be obtained from bb by the deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end. ‡^{\\text{‡}}rev(s)\\mathrm{rev}(s) is the string obtained by writing ss from right to left. For example, rev(10100)=00101\\mathrm{rev(\\mathtt{10100})=\\mathtt{00101}}."
  },
  {
    "title": "Beyond the Palindrome (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2135/E1",
    "description": "   This is the easy version of the problem. The difference between the versions is that in this version, n≤106n\\le 10^6, and the sum of nn over all test cases does not exceed 10610^6. You can hack only if you solved all versions of this problem. For a binary string∗^{\\text{∗}} rr, we define f(r)f(r) as the result of the following process: Delete all 10\\texttt{10} substrings†^{\\text{†}} simultaneously from rr;  Repeat the above operation until there are no 10\\texttt{10} substrings in rr.For example, f(100110001)=001f(\\mathtt{100110001})=\\mathtt{001} because rr changes as follows: 10_0110_001→010_01→001\\mathtt{\\underline{10}01\\underline{10}001}\\to \\mathtt{0\\underline{10}01}\\to\\mathtt{001}.We call a binary string ss almost-palindrome if and only if f(s)=f(rev(s))f(s)=f(\\mathrm{rev}(s))‡^{\\text{‡}}.Aquawave has given you an integer nn. You have to help him find the number of distinct almost-palindrome binary strings of length nn, modulo 998244353998\\,244\\,353.∗^{\\text{∗}}A binary string is a string where each character is either 0\\texttt{0} or 1\\texttt{1}.†^{\\text{†}}A string aa is a substring of a string bb if aa can be obtained from bb by the deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end. ‡^{\\text{‡}}rev(s)\\mathrm{rev}(s) is the string obtained by writing ss from right to left. For example, rev(10100)=00101\\mathrm{rev(\\mathtt{10100})=\\mathtt{00101}}."
  },
  {
    "title": "From the Unknown (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2135/D2",
    "description": "   This is the hard version of the problem. The difference between the versions is that in this version, the sum of the lengths of the articles over all queries must not exceed 2.5⋅1042.5\\cdot 10^4. You can hack only if you solved all versions of this problem. This is an interactive problem. The RiOI Team has recently developed a text editor named RiOI Editor. The editor works with exactly one integer parameter WW — the width of each line. It is known that 1≤W≤1051 \\leq W \\leq 10^5.As you cannot understand the RiOI Language, from your point of view, words differ from each other only by their length. Hence, an article of length nn is defined as a sequence aa consisting of nn positive integers, where aia_i is the length of the ii-th word in the article. The RiOI Editor displays the article [a1,a2,…,an][a_1, a_2,\\ldots, a_n] on screen as follows:  If max(a1,a2,…,an)>W\\max(a_1, a_2, \\ldots, a_n) > W, the editor is unable to display the article;  Otherwise, the editor is able to display the article by the following process:   Initially, l=1l = 1, and s=0s = 0. During the whole process, ll always denotes the current number of lines in the editor, and ss always denotes the sum of lengths of words in the last line;  Then, for each 1≤i≤n1\\le i\\le n:   If s+ai≤Ws + a_i \\leq W, the word is inserted at the end of the current line. Thus, ll remains unchanged, and ss gets increased by aia_i.  Otherwise, the word is inserted into a new line. Thus, ll becomes l+1l + 1, and ss becomes aia_i.   The number of lines needed to display the article is the final value of ll.  You are very interested in the editor, so you decide to find out the value of WW by inputting some articles into the editor and observing the number of lines needed to display each article. Formally, you can query the jury at most 22 times. In each query, you input an article [a1,a2,…,an][a_1, a_2, \\ldots, a_n] (1≤n≤1051\\leq n \\leq 10^5) to the editor, and the jury will respond to you with:  The number of lines needed to display the article, if the editor is able to display it;  00, if the editor is unable to display the article. Additional constraint in this version: the sum of the lengths of the articles (i.e., nn) over all queries must not exceed 2.5⋅1042.5\\cdot 10^4."
  },
  {
    "title": "From the Unknown (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2135/D1",
    "description": "   This is the easy version of the problem. The difference between the versions is that in this version, there are no constraints on the sum of the lengths of the articles over all queries. You can hack only if you solved all versions of this problem. This is an interactive problem. The RiOI Team has recently developed a text editor named RiOI Editor. The editor works with exactly one integer parameter WW — the width of each line. It is known that 1≤W≤1051 \\leq W \\leq 10^5.As you cannot understand the RiOI Language, from your point of view, words differ from each other only by their length. Hence, an article of length nn is defined as a sequence aa consisting of nn positive integers, where aia_i is the length of the ii-th word in the article. The RiOI Editor displays the article [a1,a2,…,an][a_1, a_2,\\ldots, a_n] on screen as follows:  If max(a1,a2,…,an)>W\\max(a_1, a_2, \\ldots, a_n) > W, the editor is unable to display the article;  Otherwise, the editor is able to display the article by the following process:   Initially, l=1l = 1, and s=0s = 0. During the whole process, ll always denotes the current number of lines in the editor, and ss always denotes the sum of lengths of words in the last line;  Then, for each 1≤i≤n1\\le i\\le n:   If s+ai≤Ws + a_i \\leq W, the word is inserted at the end of the current line. Thus, ll remains unchanged, and ss gets increased by aia_i.  Otherwise, the word is inserted into a new line. Thus, ll becomes l+1l + 1, and ss becomes aia_i.   The number of lines needed to display the article is the final value of ll.  You are very interested in the editor, so you decide to find out the value of WW by inputting some articles into the editor and observing the number of lines needed to display each article. Formally, you can query the jury at most 22 times. In each query, you input an article [a1,a2,…,an][a_1, a_2, \\ldots, a_n] (1≤n≤1051\\leq n \\leq 10^5) to the editor, and the jury will respond to you with:  The number of lines needed to display the article, if the editor is able to display it;  00, if the editor is unable to display the article. "
  },
  {
    "title": "By the Assignment",
    "url": "https://codeforces.com/problemset/problem/2135/C",
    "description": " For an undirected connected graph of nn vertices, where the ii-th vertex has a weight of viv_i, we define the value of a simple path∗^{\\text{∗}} l1,l2,…,lml_1, l_2, \\ldots, l_m as vl1⊕vl2⊕⋯⊕vlmv_{l_1}\\oplus v_{l_2}\\oplus\\cdots\\oplus v_{l_m}†^{\\text{†}}. We call the graph balanced if and only if:  For every 1≤p<q≤n1\\le p<q\\le n, all simple paths from pp to qq have the same value. Aquawave has given you an undirected connected graph of nn vertices and mm edges, and the ii-th vertex in the graph has a weight of aia_i. However, some of the weights are missing, represented by −1-1.Aquawave wants to assign an integer weight between 00 and V−1V-1 to each vertex with ai=−1a_i=-1, so that the graph will be balanced.You have to help Aquawave find the number of ways to assign weights to achieve the goal, modulo 998244353998\\,244\\,353.∗^{\\text{∗}}A simple path from cc to dd is a sequence of vertices l1,l2,…,lml_1, l_2, \\ldots, l_m, where l1=cl_1=c, lm=dl_m=d, such that there is an edge between lil_i and li+1l_{i+1} for every 1≤i≤m−11\\le i\\le m-1, and there are no repeated vertices, i.e. li≠ljl_i\\ne l_j for 1≤i<j≤n1\\le i<j\\le n. †^{\\text{†}}⊕\\oplus denotes the bitwise XOR operation. "
  },
  {
    "title": "For the Champion",
    "url": "https://codeforces.com/problemset/problem/2135/B",
    "description": " This is an interactive problem.The RiOI team is hosting a robot championship! This time, your robot is teleported into an infinite 2D plane with the Cartesian coordinate system on it. There are nn anchor points on the plane, and the coordinates of the ii-th anchor point are (xi,yi)(x_i, y_i) (−109≤xi,yi≤109-10^9\\le x_i,y_i\\le 10^9). These are given to your robot by the jury as soon as it is teleported into the plane. However, your robot doesn't know its initial coordinates at first.To test the IQ of your robot, the RiOI team has come up with an interesting game. Your robot needs to find out the initial coordinates (X,Y)(X, Y) (−109≤X,Y≤109-10^9\\le X, Y\\le 10^9) by making the following moves.In one move, assuming that its current coordinates are (a,b)(a,b), your robot can choose a non-negative integer kk (0≤k≤1090\\le k\\le 10^9) and do one of the following four types of operations:  Move up by kk units, i.e., your robot will move to (a,b+k)(a,b+k);  Move down by kk units, i.e., your robot will move to (a,b−k)(a,b-k);  Move left by kk units, i.e., your robot will move to (a−k,b)(a-k,b);  Move right by kk units, i.e., your robot will move to (a+k,b)(a+k,b). After each move, the jury will give the minimum Manhattan Distance between the current coordinates of your robot and any anchor point. More formally, assuming that the coordinates of your robot are (c,d)(c,d) after the move, the jury will outputmin1≤i≤n(|xi−c|+|yi−d|). \\min_{1\\le i\\le n}\\left ( \\left|x_i-c\\right|+\\left|y_i-d\\right|\\right ). To win the prize, you must prove that your robot has a high IQ. So you have to write a program for your robot to find its initial coordinates (X,Y)(X, Y) in no more than 1010 moves."
  },
  {
    "title": "Against the Difference",
    "url": "https://codeforces.com/problemset/problem/2135/A",
    "description": "  We define that a block is an array where all elements in it are equal to the length of the array. For example, [3,3,3][3, 3, 3], [1][1], and [4,4,4,4][4, 4, 4, 4] are blocks, while [1,1,1][1, 1, 1] and [2,3,3][2, 3, 3] are not.An array is called neat if it can be obtained by the concatenation of an arbitrary number of blocks (possibly zero). Note that an empty array is always neat.You are given an array aa consisting of nn integers. Find the length of its longest neat subsequence∗^{\\text{∗}}. ∗^{\\text{∗}}A sequence cc is a subsequence of a sequence aa if cc can be obtained from aa by the deletion of several (possibly, zero or all) element from arbitrary positions. "
  },
  {
    "title": "Permutation Oddness",
    "url": "https://codeforces.com/problemset/problem/2134/F",
    "description": "  You are given four positive integers c0c_0, c1c_1, c2c_2, and c3c_3.Let n=c0+c1+c2+c3n = c_0 + c_1 + c_2 + c_3. Consider an array aa of nn integers with xx (0≤x≤30\\le x\\le 3) appearing cxc_x times. For any distinct permutation∗^{\\text{∗}} bb of the array aa, define its oddness as†^{\\text{†}}‡^{\\text{‡}}:n−1∑i=1lowbit(bi⊕bi+1)\\sum_{i = 1}^{n-1} \\text{lowbit}(b_i \\oplus b_{i+1})Your task is to count, for each integer kk from 00 to 2⋅(n−1)2 \\cdot (n-1) (inclusive), the number of distinct permutations of aa with an oddness equal to kk.Since the numbers might be too large, you are only required to find them modulo 109+710^9 + 7.∗^{\\text{∗}}A permutation of the array is an arrangement of its elements into any order. For example, [1,2,2][1,2,2] is a permutation of [2,2,1][2,2,1], but [1,1,2][1,1,2] is not. Two permutations are considered distinct if they differ in at least one position.†^{\\text{†}}⊕\\oplus denotes the bitwise XOR operation. ‡^{\\text{‡}}lowbit(x)\\text{lowbit}(x) is the value of the lowest binary bit of xx, e.g. lowbit(12)=4\\text{lowbit}(12)=4, lowbit(8)=8\\text{lowbit}(8)=8. Specifically, we define lowbit(0)=0\\text{lowbit}(0) = 0."
  },
  {
    "title": "Power Boxes",
    "url": "https://codeforces.com/problemset/problem/2134/E",
    "description": " This is an interactive problem.You are given nn boxes, indexed from 11 to nn. The boxes look identical, but each one has a hidden power value aia_i, which is either 11 or 22.You want to determine the power value of each box. To do so, you conduct the following experiment. Initially, the ii-th box is placed at coordinate ii on a number line (1≤i≤n1 \\le i \\le n).You are allowed to perform the following two types of queries:  \"swap xx\" (1≤x≤n−11 \\le x \\le n - 1): Swap the boxes currently located at coordinates xx and x+1x + 1. Note that this change is permanent and affects all subsequent queries.  \"throw xx\" (1≤x≤n1 \\le x \\le n): Throw a ball at the box located at coordinate xx. The ball travels pp units forward to coordinate x+px + p if the power value of the box is pp. If there is a box at the new coordinate, the ball jumps again using the power of that box. This continues until the ball lands on a coordinate without a box. As a response, you are given the total number of jumps the ball made before stopping. Your task is to determine the power value of each box using no more than ⌈3n2⌉\\left\\lceil \\frac{3n}{2} \\right\\rceil queries in total, counting both swap and throw queries."
  },
  {
    "title": "Sliding Tree",
    "url": "https://codeforces.com/problemset/problem/2134/D",
    "description": "  You are given a tree∗^{\\text{∗}} with nn vertices numbered from 11 to nn. You can modify its structure using the following multi-step operation, called a sliding operation:  Choose three distinct vertices aa, bb, and cc such that bb is directly connected to both aa and cc.  Then, for every neighbor dd of bb (excluding aa and cc), remove the edge between bb and dd, and instead connect dd directly to cc. For example, the figure below illustrates this operation with a=4a = 4, b=3b = 3, and c=5c = 5 in the leftmost tree.  It can be proved that after a sliding operation, the resulting graph is still a tree.Your task is to find a sequence of sliding operations that transforms the tree into a path graph†^{\\text{†}}, while minimizing the total number of operations. You only need to output the first sliding operation in an optimal sequence if at least one operation is required. It can be proved that it is possible to transform the tree into a path graph using a finite number of operations.∗^{\\text{∗}}A tree is a connected graph without cycles. †^{\\text{†}}A path graph is a tree where every vertex has a degree of at most 22. Note that a graph with only 11 vertex and no edges is also a path graph."
  },
  {
    "title": "Even Larger",
    "url": "https://codeforces.com/problemset/problem/2134/C",
    "description": "  An array is called good if, for every subarray∗∗^{\\text{∗}} of length at least 22, the sum of the elements at even indices (with respect to the original array) is greater than or equal to the sum of the elements at odd indices. Array indexing starts from 11.For example, the arrays [3,8,4,4][3,8,4,4] and [2,3,1,4,2][2,3,1,4,2] are good. The array [0,2,4,1][0,2,4,1] is not because, in the subarray [2,4,1][2,4,1], the elements at even indices in the original array are 22 (index 22) and 11 (index 44), while the only element at an odd index is 44 (index 33). Since 2+1<42 + 1 < 4, the condition does not hold for this subarray.You are given an array of nn non-negative integers a1,a2,…,ana_1,a_2,\\ldots,a_n. In one operation, you can decrease any element in the array by 11, but all elements must remain non-negative. Your task is to find the minimum number of operations needed to make the array aa good. It can be proved that it is possible to make the array good using a finite number of operations.∗^{\\text{∗}}An array bb is a subarray of an array aa if bb can be obtained from aa by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. "
  },
  {
    "title": "Add 0 or K",
    "url": "https://codeforces.com/problemset/problem/2134/B",
    "description": " You are given an array of nn positive integers a1,a2,…,ana_1, a_2, \\ldots, a_n and a positive integer kk.In one operation, you may add either 00 or kk to each aia_i, i.e., choose another array of nn integers b1,b2,…,bnb_1, b_2, \\ldots, b_n where each bib_i is either 00 or kk, and update aia_i to ai+bia_i + b_i for 1≤i≤n1 \\le i \\le n. Note that you can choose different values for each element of the array bb.Your task is to perform at most kk such operations to make gcd(a1,a2,…,an)>1\\gcd(a_1, a_2, \\ldots, a_n) > 1 ∗^{\\text{∗}}. It can be proved that this is always possible.Output the final array after the operations. You do not have to output the operations themselves.∗^{\\text{∗}}gcd(a1,a2,…,an)\\gcd(a_1, a_2, \\ldots, a_n) denotes the greatest common divisor (GCD) of a1,a2,…,ana_1, a_2, \\ldots, a_n."
  },
  {
    "title": "Painting With Two Colors",
    "url": "https://codeforces.com/problemset/problem/2134/A",
    "description": "You are given three positive integers nn, aa, and bb (1≤a,b≤n1\\leq a,b \\leq n).Consider a row of nn cells, initially all white and indexed from 11 to nn. You will perform the following two steps in order:  Choose an integer xx such that 1≤x≤n−a+11 \\le x \\le n - a + 1, and paint the aa consecutive cells x,x+1,…,x+a−1x, x+1, \\ldots, x+a-1 red.  Choose an integer yy such that 1≤y≤n−b+11 \\le y \\le n - b + 1, and paint the bb consecutive cells y,y+1,…,y+b−1y, y+1, \\ldots, y+b-1 blue. If a cell is painted both red and blue, its final color is blue.A coloring of the grid is considered symmetric if, for every integer ii from 11 to nn (inclusive), the color of cell ii is the same as the color of cell (n+1−i)(n+1-i). Your task is to determine whether there exist integers xx and yy such that the final coloring of the grid is symmetric."
  },
  {
    "title": "Flint and Steel",
    "url": "https://codeforces.com/problemset/problem/2133/F",
    "description": " Steve's creeper farm has overflowed and there are creepers everywhere! There are nn creepers standing in a line, with the ii-th creeper having explosive power eie_i. Steve needs to kill all of them in order to get past.To do this, he can use his trusty Flint and Steel to detonate creepers. Detonating the creeper at position ii kills all creepers at positions jj such that |i−j|<ei|i - j| < e_i. Dead creepers cannot be detonated. Some creepers may be particularly weak and have explosive power 00, meaning they cannot be detonated either.With the Great Hog hot on his tail, there is no time to waste. Find a sequence of detonations that kills all the creepers with as few detonations as possible, or report it is impossible."
  },
  {
    "title": "I Yearned For The Mines",
    "url": "https://codeforces.com/problemset/problem/2133/E",
    "description": "  As a child, Steve yearned for the mines! His mine can be represented as a tree∗^{\\text{∗}} of nn nodes.Unfortunately, Steve's mine has been infiltrated by his greatest nemesis, Herobrine! At any time, Herobrine is hiding in exactly one node; initially, he may be in any of them. Steve can perform the following operations:  1x1\\,\\,x — Check if Herobrine is currently in node xx. If he is, Steve catches him. Otherwise, Herobrine may or may not move to any adjacent node (except the one you just checked).  2x2\\,\\,x — Destroy all edges connected to node xx; Herobrine will no longer be able to use them. Afterwards, Herobrine may or may not move to any adjacent node. Find a sequence of at most ⌊54⋅n⌋\\left\\lfloor \\frac{5}{4} \\cdot n \\right\\rfloor operations that will guarantee Steve catches Herobrine, regardless of Herobrine's initial location and moves. We have a proof that, under the given constraints, this is always possible.∗^{\\text{∗}}A tree is a connected graph without cycles. "
  },
  {
    "title": "Chicken Jockey",
    "url": "https://codeforces.com/problemset/problem/2133/D",
    "description": " Steve made the foolish decision to mine at night, and came across a monstrous creature: the chicken jockeyn^n!A chicken jockeyn^n consists of nn mobs stacked in order on top of each other, with mob 11 at the bottom and mob nn at the top. Mob ii initially has hih_i health.In one attack, Steve can deal 11 damage to any mob. If any mob reaches 00 or less health, it dies, and all the mobs on top of it fall down and form a new stack. The bottom mob in the new stack takes 11 fall damage for every mob it was on top of before falling (i.e. the number of mobs below it in the previous stack, including the one that just died). This may kill it as well, in which case all mobs on top of it fall down again and the process repeats.For example, consider a chicken jockey6^6 with initial mob healths [1,2,1,3,5,2][1, 2, 1, 3, 5, 2]. If Steve damages the third mob in the stack, it dies and the mobs with health [3,5,2][3, 5, 2] fall down in a new stack. The bottom mob takes 33 units of fall damage so it also dies, and the mobs with health [5,2][5, 2] fall down in a new stack. The bottom mob takes 11 unit of fall damage. As a result, after Steve's first attack, there will be two stacks with healths [1,2][1, 2] and [4,2][4, 2].Steve's sword's durability is low, so he wishes to know the minimum attacks required to kill all the mobs."
  },
  {
    "title": "The Nether",
    "url": "https://codeforces.com/problemset/problem/2133/C",
    "description": "   This is an interactive problem. Having recently discovered The Nether, Steve has built a network of nn nether portals, each at a different location in his world.Each portal is connected in one direction to some number (possibly zero) of other portals. To avoid getting lost, Steve has carefully built the network of portals so that there is no sequence of jumps through portals that will bring you from a location back to itself; formally, the network forms a directed acyclic graph.Steve refuses to tell you which portals are connected to which, but he will allow you to ask queries. In each query, you give Steve a set of locations S={s1,s2,…,sk}S = \\{s_1, s_2, \\ldots, s_k\\} and a starting location x∈Sx \\in S. Steve will figure out the longest path starting at xx that only passes through locations in SS and tell you the number of locations in it. (If it is impossible to reach any other location in SS from xx, Steve will reply with 11.)As you are looking to obtain the achievement \"Hot Tourist Destinations\", you want to find any path that visits as many locations as possible. Steve is feeling particularly generous and will give you 2⋅n2 \\cdot n queries to find it."
  },
  {
    "title": "Villagers",
    "url": "https://codeforces.com/problemset/problem/2133/B",
    "description": " Steve lives in a village with nnn other villagers. Unfortunately, due to disputes over the distribution of emeralds, none of those villagers are friends with any other villager. Furthermore, villager ii initially has a grumpiness of gig_i.Steve can perform the following operation any number of times:  Select two villagers ii and jj and give them max(gi,gj)\\text{max}(g_i, g_j) emeralds to share. Both of their grumpinesses decrease by min(gi,gj)\\text{min}(g_i, g_j), and they become friends with each other if they weren't already. Steve wishes to make every villager friends with every other villager (possibly through some intermediate friendships); that is, from any villager, you can follow a path of friendships to reach any other villager. Since he does not want to inflate the village economy too much, calculate the minimum number of emeralds he must give away to accomplish this."
  },
  {
    "title": "Redstone?",
    "url": "https://codeforces.com/problemset/problem/2133/A",
    "description": " Steve stumbled upon a collection of nn gears, where gear ii has aia_i teeth, and he wants to arrange them into a row.After he arranges them, Steve will spin the leftmost gear at a speed of 11 revolution per second. For each of the other gears, let xx be the number of teeth it has, yy be the number of teeth of the gear to its left, and zz be the speed the gear to its left spins at. Then, its speed will be yx⋅z\\frac{y}{x} \\cdot z revolutions per second.Steve considers the contraption satisfactory if the rightmost gear spins at a speed of 11 revolution per second. Determine whether Steve can rearrange the gears into a satisfactory contraption."
  },
  {
    "title": "Famous Choreographer",
    "url": "https://codeforces.com/problemset/problem/2132/G",
    "description": "As all programmers know, there are n×mn \\times m ballerinas performing in a ballet, and their arrangement can be represented as a table with nn rows and mm columns. Each ballerina performs one of 2626 movements, which can be described by one of the English letters.Choreographer Vadim wants to dispel this myth. To do this, he wants to stage a show in which all the ballerinas gracefully move to the opposite side of the stage from their starting positions. Programmers will find it easier to understand this movement as a 180∘180^{\\circ} rotation of the table. To maintain the sequence of visual storytelling in the ballet, the ballerinas perform this movement instantaneously, without stopping their movements, and the final arrangement is identical to the initial one.Unfortunately, Vadim understands that with the current performance and the already planned arrangement of the ballerinas, such a maneuver will not be possible. Therefore, he is ready to invite more ballerinas to the performance. They can perform any movement and occupy any position, but they cannot stand between those already participating in a ballet. The most important thing is that in the end, a rectangular table is formed, possibly larger than the original one. Additionally, it is essential that at least one ballerina from the original arrangement moves to the position of one of the other ballerinas from the original arrangement or remains in her place. Please advise Vadim on the smallest number of ballerinas he will need to invite."
  },
  {
    "title": "Rada and the Chamomile Valley",
    "url": "https://codeforces.com/problemset/problem/2132/F",
    "description": "Yesterday, Rada found a portal that can transport her to the Chamomile Valley and back. Rada's happiness knew no bounds, but it didn't last long — she suddenly realized that she didn't know where and when any of the Smeshariki would be.The Chamomile Valley consists of nn houses and mm lanes connecting the houses. The lanes are numbered from 11 to mm. You can walk along the lanes in both directions. It is known that from any house, you can reach any other house via the lanes, and there is no lane connecting a house to itself. Moreover, any two houses are connected by at most one lane.Rada knows that the Smeshariki walk every day from house number 11 to house number nn, but she doesn't know which specific lanes they will take. Rada will be in the Chamomile Valley on each of the next qq days. On the kk-th day, she will be at house number ckc_k.Since Rada does not know which specific lanes the Smeshariki will take, she is only interested in those lanes that they will definitely use. To ensure she does not miss any of them, she wants to know the index of the nearest such lane on each day. Rada is too busy strolling through the Chamomile Valley, so she asks you to help her determine the required lane indices.The distance from house cc to the lane connecting houses aa and bb is defined as the minimum of ρ(a,c)\\rho(a, c) and ρ(b,c)\\rho(b, c), where ρ(a,b)\\rho(a, b) is the minimum number of lanes needed to reach house number bb starting from house number aa."
  },
  {
    "title": "Arithmetics Competition",
    "url": "https://codeforces.com/problemset/problem/2132/E",
    "description": "In the arithmetic competition, participants need to achieve the highest possible sum from the cards they have. In the team \"fst_ezik\", Vadim has nn cards with numbers aia_i, and Kostya has mm cards with numbers bib_i. In each of the qq rounds, they want to win, but this time the rules of the competition are slightly different from the usual ones.In each round, the participants are given three numbers xix_i, yiy_i, and ziz_i. The team \"fst_ezik\" must choose exactly ziz_i cards from all the cards they have, but Vadim can choose no more than xix_i cards from his set, and Kostya can choose no more than yiy_i cards from his set. Help them find the highest possible sum for each of the qq rounds."
  },
  {
    "title": "From 1 to Infinity",
    "url": "https://codeforces.com/problemset/problem/2132/D",
    "description": "Vadim wanted to understand the infinite sequence of digits that consists of the positive integers written consecutively from 11 to infinity. That is, this sequence looks like 123456789101112131415…123456789101112131415 \\ldotsTo avoid looking into infinity, Vadim cut this sequence at the kk-th digit and discarded everything after it. Thus, exactly kk digits remained in the sequence. Help him find the sum of the digits in the remaining sequence."
  },
  {
    "title": "The Cunning Seller (hard version)",
    "url": "https://codeforces.com/problemset/problem/2132/C2",
    "description": "This is the hard version of the problem. The easy version differs from the hard one in that it requires determining the minimum cost with the least number of deals, while the hard version requires determining the minimum cost with a limited number of deals.After the cunning seller sold three watermelons instead of one, he decided to increase his profit — namely, he bought even more watermelons. Now he can sell 3x3x3^x watermelons for 3x+1+x⋅3x−13^{x+1} + x \\cdot 3^{x-1} coins, where xx is a non-negative integer. Such a sale is called a deal.A calculating buyer came to him, but he has little time, so the buyer can make no more than kk deals and plans to buy exactly nn watermelons.The buyer is in a hurry and has therefore turned to you to determine the minimum number of coins he must pay the seller for nn watermelons if he makes no more than kk deals. If it is impossible to buy exactly nn watermelons while making no more than kk deals, output −1-1."
  },
  {
    "title": "The Cunning Seller (easy version)",
    "url": "https://codeforces.com/problemset/problem/2132/C1",
    "description": "This is the easy version of the problem. The easy version differs from the hard one in that it requires determining the minimum cost with the least number of deals, while the hard version requires determining the minimum cost with a limited number of deals.After the cunning seller sold three watermelons instead of one, he decided to increase his profit — namely, he bought even more watermelons. Now he can sell 3x3^x watermelons for 3x+1+x⋅3x−13^{x+1} + x \\cdot 3^{x-1} coins, where xx is a non-negative integer. Such a sale is called a deal.A calculating buyer came to him, but he has critically little time. Because of this, he wants to buy exactly nn watermelons, making the least possible number of deals.The buyer is in a hurry and has therefore turned to you to determine the minimum number of coins he must pay the seller for nn watermelons, considering that he will make the least possible number of deals."
  },
  {
    "title": "The Secret Number",
    "url": "https://codeforces.com/problemset/problem/2132/B",
    "description": "Vadim has thought of a number xx. To ensure that no one can guess it, he appended a positive number of zeros to the right of it, thus obtaining a new number yy. However, as a precaution, Vadim decided to spread the number n=x+yn = x + y. Find all suitable xx that Vadim could have thought of for the given nn."
  },
  {
    "title": "Homework",
    "url": "https://codeforces.com/problemset/problem/2132/A",
    "description": "Vlad and Dima have been assigned a task in school for their English class. They were given two strings aa and bb and asked to append all characters from bb to string aa in any order. The guys decided to divide the work between themselves and, after lengthy negotiations, determined who would add each character from string bb to aa.Due to his peculiarities, Vlad can only add characters to the beginning of the word, while Dima can only add them to the end. They add characters in the order they appear in string bb. Your task is to determine what string Vlad and Dima will end up with."
  },
  {
    "title": "Sea, You & copriMe",
    "url": "https://codeforces.com/problemset/problem/2131/H",
    "description": " Umi is given an array aa of length nn, whose elements are integers between 11 and mm. She loves coprime integers and wants to find four distinct indices p,q,r,sp, q, r, s (1≤p,q,r,s≤n1 \\le p, q, r, s \\le n), such that gcd(ap,aq)=1\\gcd(a_p, a_q) = 1 and gcd(ar,as)=1\\gcd(a_r, a_s) = 1∗^{\\text{∗}}.If there are multiple solutions, you may output any one of them.∗^{\\text{∗}}gcd(x,y)\\gcd(x, y) denotes the greatest common divisor (GCD) of integers xx and yy. "
  },
  {
    "title": "Wafu!",
    "url": "https://codeforces.com/problemset/problem/2131/G",
    "description": " To help improve her math, Kudryavka is given a set SS that consists of nn distinct positive integers. Initially, her score is 11. She can perform an arbitrary number of the following operations on the set if it is not empty:  Let the minimum value of SS be mm.  Multiply her score by mm.  Remove mm from SS.  For every integer ii such that 1≤i<m1 \\le i < m, add ii to the set SS. It can be shown that no duplicates are added during this step. She is addicted to performing operations, but after kk operations, she realizes she forgot her score. Please help her determine her score, modulo 109+710^9+7."
  },
  {
    "title": "Unjust Binary Life",
    "url": "https://codeforces.com/problemset/problem/2131/F",
    "description": " Yuri is given two binary strings aa and bb, both of which are of length nn. The two strings dynamically define an n×nn \\times n grid. Let (i,j)(i, j) denote the cell in the ii-th row and jj-th column. The initial value of cell (i,j)(i, j) has the value of ai⊕bja_i \\oplus b_j, where ⊕\\oplus denotes the bitwise XOR operation. .Yuri's journey always starts at cell (1,1)(1, 1). From a cell (i,j)(i, j), she can only move down to (i+1,j)(i + 1, j) or right to (i,j+1)(i, j + 1). Her journey is possible if there exists a valid path such that all cells on the path, including (1,1)(1, 1), have a value of 0.Before her departure, she can do the following operation for any number of times:  Choose one index 1≤i≤n1 \\le i \\le n, and flip the value of either aia_i or bib_i (00 becomes 11, and 11 becomes 00). The grid will also change accordingly. Let f(x,y)f(x, y) denote the minimum required operations so that Yuri can make her journey to the cell (x,y)(x,y). You must determine the sum of f(x,y)f(x, y) over all 1≤x,y≤n1 \\leq x, y \\leq n.Note that each of these n2n^2 cases is independent, meaning you need to assume the grid is in its original state in each case (i.e., no actual operations are performed)."
  },
  {
    "title": "Adjacent XOR",
    "url": "https://codeforces.com/problemset/problem/2131/E",
    "description": "  You're given an array aa of length nn. For each index ii such that 1≤i<n1 \\le i < n, you can perform the following operation at most once:  Assign ai:=ai⊕ai+1a_i := a_i \\oplus a_{i+1}, where ⊕\\oplus denotes the bitwise XOR operation. . You can choose indices and perform the operations in any sequential order.Given another array bb of length nn, determine if it is possible to transform aa to bb."
  },
  {
    "title": "Arboris Contractio",
    "url": "https://codeforces.com/problemset/problem/2131/D",
    "description": " Kagari is preparing to archive a tree, and she knows the cost of doing so will depend on its diameter∗^{\\text{∗}}. To keep the expense down, her goal is to shrink the diameter as much as possible first. She can perform the following operation on the tree:  Choose two vertices ss and tt. Let the sequence of vertices on the simple path†^{\\text{†}} from ss to tt be v0,v1,…,vkv_0, v_1, \\dots, v_k, where v0=sv_0 = s and vk=tv_k = t.  Remove all edges along the path. In other words, remove edges (v0,v1),(v1,v2),…,(vk−1,vk)(v_0, v_1), (v_1, v_2), \\dots, (v_{k-1}, v_k).  Connect vertices v1,v2,…,vkv_1, v_2, \\dots, v_k directly to v0v_0. In other words, add edges (v0,v1),(v0,v2),…,(v0,vk)(v_0, v_1), (v_0, v_2), \\dots, (v_0, v_k). It can be shown that the graph is still a tree after the operation.Help her determine the minimum number of operations required to achieve the minimal diameter.∗^{\\text{∗}}The diameter of a tree is the longest possible distance between any pair of vertices. The distance itself is measured by the number of edges on the unique simple path connecting them.†^{\\text{†}}A simple path is a path between two vertices in a tree that does not visit any vertex more than once. It can be shown that the simple path between any two vertices is always unique."
  },
  {
    "title": "Make it Equal",
    "url": "https://codeforces.com/problemset/problem/2131/C",
    "description": "Given two multisets SS and TT of size nn and a positive integer kk, you may perform the following operations any number (including zero) of times on SS:   Select an element xx in SS, and remove one occurrence of xx in SS. Then, either insert x+kx+k into SS, or insert |x−k||x-k| into SS. Determine if it is possible to make SS equal to TT. Two multisets SS and TT are equal if every element appears the same number of times in SS and TT."
  },
  {
    "title": "Alternating Series",
    "url": "https://codeforces.com/problemset/problem/2131/B",
    "description": "  You are given an integer nn. Call an array aa of length nn good if:  For all 1≤i<n1 \\le i < n, ai⋅ai+1<0a_i \\cdot a_{i+1} < 0 (i.e., the product of adjacent elements is negative).  For all subarrays∗^{\\text{∗}} with length at least 22, the sum of all elements in the subarray is positive†^{\\text{†}}. Additionally, we say a good array aa of length nn is better than another good array bb of length nn if [|a1|,|a2|,…,|an|][|a_1|, |a_2|, \\ldots, |a_n|] is lexicographically smaller‡^{\\text{‡}} than [|b1|,|b2|,…,|bn|][|b_1|, |b_2|, \\ldots, |b_n|]. Note that |z||z| denotes the absolute value of integer zz.Output a good array of length nn such that it is better than every other good array of length nn.∗^{\\text{∗}}An array cc is a subarray of an array dd if cc can be obtained from dd by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. †^{\\text{†}}An integer xx is positive if x>0x > 0.‡^{\\text{‡}}A sequence aa is lexicographically smaller than a sequence bb if and only if one of the following holds:   aa is a prefix of bb, but a≠ba \\ne b; or  in the first position where aa and bb differ, the sequence aa has a smaller element than the corresponding element in bb.  "
  },
  {
    "title": "Lever",
    "url": "https://codeforces.com/problemset/problem/2131/A",
    "description": "In Divergent Universe, The Lever iterates itself given two arrays aa and bb of length nn. In each iteration, The Lever will do the following:  Choose a random index ii such that ai>bia_i > b_i. Then, decrease aia_i by 11. If there does not exist such ii, ignore this step.  Choose a random index ii such that ai<bia_i < b_i. Then, increase aia_i by 11. If there does not exist such ii, ignore this step. After each iteration, the Lever will check if step 11 is ignored, and if so, it will end its iteration.You're given the two arrays. Find the number of iterations that the Lever does. It can be shown this number is fixed over all possibilities of random indices that The Lever can choose for each step."
  },
  {
    "title": "Pathless",
    "url": "https://codeforces.com/problemset/problem/2130/B",
    "description": "There is an array a1,a2,…,ana_1, a_2, \\ldots, a_n consisting of values 00, 11, and 22, and an integer ss. It is guaranteed that a1,a2,…,ana_1, a_2, \\ldots, a_n contains at least one 00, one 11, and one 22.Alice wants to start from index 11 and perform steps of length 11 to the right or to the left, and reach index nn at the end. While Alice moves, she calculates the sum of the values she is visiting, and she wants the sum to be exactly ss.Formally, Alice wants to find a sequence [i1,i2,…,im][i_1, i_2, \\ldots, i_m] of indices, such that:  i1=1i_1 = 1, im=ni_m = n.  1≤ij≤n1 \\leq i_j \\leq n for all 1≤j≤m1 \\le j \\le m.  |ij−ij+1|=1|i_{j} - i_{j+1}| = 1 for all 1≤j<m1 \\leq j < m.  ai1+ai2+…+aim=sa_{i_1} + a_{i_2} + \\ldots + a_{i_m} = s. However, Bob wants to rearrange a1,a2,…,ana_1, a_2, \\ldots, a_n to prevent Alice from achieving her target. Determine whether it is possible to rearrange a1,a2,…,ana_1, a_2, \\ldots, a_n such that Alice cannot find her target sequence (even if Alice is smart enough). If it is possible, you also need to output the rearranged array a1,a2,…,ana_1, a_2, \\ldots, a_n."
  },
  {
    "title": "Submission is All You Need",
    "url": "https://codeforces.com/problemset/problem/2130/A",
    "description": "For a multiset TT consisting of non-negative integers, we define:  sum(T)\\text{sum}(T) is the sum of all elements in TT. For example, if T={0,1,1,3}T = \\{0,1, 1, 3\\}, then sum(T)=0+1+1+3=5\\text{sum}(T)= 0+1+1+3=5.  mex(T)\\text{mex}(T) is the smallest non-negative integer not in TT. For example, if T={0,1,1,3}T = \\{0,1, 1, 3\\}, then mex(T)=2\\text{mex}(T) = 2 because 22 is the smallest non-negative integer not present in TT. You are given a multiset SS of size nn consisting of non-negative integers. At first, your score is 00. You can perform the following operations any number of times in any order (possibly zero):  Select a subset S′⊆SS' \\subseteq S (i.e., S′S' contains some of the elements currently in SS), add sum(S′)\\text{sum}(S') to your score, and then remove S′S' from SS.  Select a subset S′⊆SS' \\subseteq S, add mex(S′)\\text{mex}(S') to your score, and then remove S′S' from SS. Find the maximum possible score that can be obtained."
  },
  {
    "title": "Top-K Tracker (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2129/F2",
    "description": "This is an interactive problem.This is the hard version of the problem. The only difference is that n≤890n \\le 890 in this version. You can make hacks only if all versions of the problem are solved.There is a hidden permutation pp, which is a permutation of {1,2,…,n}\\{1,2,\\ldots,n\\}. Let posipos_i denote the position of the value ii in pp, i.e., pospi=ipos_{p_i} = i.To find this permutation, you can ask four types of queries:  \"1 m i1 i2 … im1\\ m\\ i_1\\ i_2\\ \\ldots\\ i_m\" (1≤m≤n1 \\leq m \\leq n, i1, i2, …, imi_1,\\ i_2,\\ \\ldots,\\ i_m must be distinct). Let k=min(60,m)k = \\min(60, m). The jury will return the top kk largest number(s) in [pi1,pi2,…,pim][p_{i_1}, p_{i_2}, \\ldots, p_{i_m}] in increasing order.  \"2 m i1 i2 … im2\\ m\\ i_1\\ i_2\\ \\ldots\\ i_m\" (1≤m≤n1 \\leq m \\leq n, i1, i2, …, imi_1,\\ i_2,\\ \\ldots,\\ i_m must be distinct). Let k=min(60,m)k = \\min(60, m). The jury will return the top kk largest number(s) in [posi1,posi2,…,posim][pos_{i_1}, pos_{i_2}, \\ldots, pos_{i_m}] in increasing order.  \"3 m i1 i2 ... im3\\ m\\ i_1\\ i_2\\ ...\\ i_m\" (1≤m≤n1 \\leq m \\leq n, i1, i2, ..., imi_1,\\ i_2,\\ ...,\\ i_m must be distinct). Let k=min(300,m)k = \\min(300, m). The jury will return the top kk largest number(s) in [pi1,pi2,...,pim][p_{i_1}, p_{i_2}, ..., p_{i_m}] in increasing order.  \"4 m i1 i2 … im4\\ m\\ i_1\\ i_2\\ \\ldots\\ i_m\" (1≤m≤n1 \\leq m \\leq n, i1, i2, …, imi_1,\\ i_2,\\ \\ldots,\\ i_m must be distinct). Let k=min(300,m)k = \\min(300, m). The jury will return the top kk largest number(s) in [posi1,posi2,…,posim][pos_{i_1}, pos_{i_2}, \\ldots, pos_{i_m}] in increasing order. Let cic_i be the usage count of queries of type ii (1≤i≤4)(1 \\le i \\le 4). Your query count must satisfy the following constraints:  c1+c2+c3+c4≤30.c_1+c_2+c_3+c_4 \\le 30.  c3+c4≤1.c_3+c_4 \\le 1. "
  },
  {
    "title": "Top-K Tracker (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2129/F1",
    "description": "This is an interactive problem.This is the easy version of the problem. The only difference is that n≤845n \\le 845 in this version. You can make hacks only if all versions of the problem are solved.There is a hidden permutation pp, which is a permutation of {1,2,…,n}\\{1,2,\\ldots,n\\}. Let posipos_i denote the position of the value ii in pp, i.e., pospi=ipos_{p_i} = i.To find this permutation, you can ask four types of queries:  \"1 m i1 i2 … im1\\ m\\ i_1\\ i_2\\ \\ldots\\ i_m\" (1≤m≤n1 \\leq m \\leq n, i1, i2, …, imi_1,\\ i_2,\\ \\ldots,\\ i_m must be distinct). Let k=min(60,m)k = \\min(60, m). The jury will return the top kk largest number(s) in [pi1,pi2,…,pim][p_{i_1}, p_{i_2}, \\ldots, p_{i_m}] in increasing order.  \"2 m i1 i2 … im2\\ m\\ i_1\\ i_2\\ \\ldots\\ i_m\" (1≤m≤n1 \\leq m \\leq n, i1, i2, …, imi_1,\\ i_2,\\ \\ldots,\\ i_m must be distinct). Let k=min(60,m)k = \\min(60, m). The jury will return the top kk largest number(s) in [posi1,posi2,…,posim][pos_{i_1}, pos_{i_2}, \\ldots, pos_{i_m}] in increasing order.  \"3 m i1 i2 ... im3\\ m\\ i_1\\ i_2\\ ...\\ i_m\" (1≤m≤n1 \\leq m \\leq n, i1, i2, ..., imi_1,\\ i_2,\\ ...,\\ i_m must be distinct). Let k=min(300,m)k = \\min(300, m). The jury will return the top kk largest number(s) in [pi1,pi2,...,pim][p_{i_1}, p_{i_2}, ..., p_{i_m}] in increasing order.  \"4 m i1 i2 … im4\\ m\\ i_1\\ i_2\\ \\ldots\\ i_m\" (1≤m≤n1 \\leq m \\leq n, i1, i2, …, imi_1,\\ i_2,\\ \\ldots,\\ i_m must be distinct). Let k=min(300,m)k = \\min(300, m). The jury will return the top kk largest number(s) in [posi1,posi2,…,posim][pos_{i_1}, pos_{i_2}, \\ldots, pos_{i_m}] in increasing order. Let cic_i be the usage count of queries of type ii (1≤i≤4)(1 \\le i \\le 4). Your query count must satisfy the following constraints:  c1+c2+c3+c4≤30.c_1+c_2+c_3+c_4 \\le 30.  c3+c4≤1.c_3+c_4 \\le 1. "
  },
  {
    "title": "Induced Subgraph Queries",
    "url": "https://codeforces.com/problemset/problem/2129/E",
    "description": "You are given an unweighted, undirected graph GG with nn nodes and mm edges. The graph GG contains no self-loops or multiple edges.We denote the node set of GG as VV. For any node subset V′⊆VV' \\subseteq V, the corresponding induced subgraph, denoted by G[V′]G[V'], is defined as follows:  G[V′]G[V'] is the graph whose node set is V′V', and whose edge set consists of all edges in GG with both endpoints in V′V'. Your task is to answer qq queries. Each query provides three integers ll, rr, and kk. Denoting V′={l,l+1,…,r}V'=\\{l,l+1,\\ldots,r\\}, you need to find the kk-th smallest value among f(l,G[V′])f(l,G[V']), f(l+1,G[V′])f(l+1,G[V']), …\\ldots , f(r,G[V′])f(r,G[V']) (i.e., the kk-th value in increasing order; repeated values are counted multiple times).Here, f(u,G[V′])=⨁(u,v)∈G[V′]vf(u,G[V'])=\\bigoplus_{(u,v)\\in G[V']}v. In other words, it is the bitwise XOR value of the labels of all adjacent nodes of node uu in graph G[V′]G[V'].You might want to read the notes for a better understanding."
  },
  {
    "title": "Permutation Blackhole",
    "url": "https://codeforces.com/problemset/problem/2129/D",
    "description": "For a permutation p1,p2,…,pnp_1, p_2, \\ldots, p_n of length nn, the corresponding coloring sequence ss can be obtained by the following coloring process:  Initially, there are nn white cells indexed from 11 to nn from left to right. At second 00, the score of each cell is 00.  At second ii (1≤i≤n1 \\le i \\le n),   If i>1i > 1, find the nearest black cell to the cell pip_i, and increase the score of that cell by 11. In case there are multiple nearest black cells, choose the cell with the lowest index. Cell yy is called the nearest black cell to cell xx only if cell yy is black and there is no black cell zz satisfying |x−z|<|x−y||x-z|<|x-y|.  Color the cell pip_i black.  After all cells are colored black, denoting sis_i as the score of cell ii (1≤i≤n1 \\le i \\le n), we get the coloring sequence ss.You might want to read the notes for a better understanding.You are given an incomplete coloring sequence ss, where some sis_i are already fixed, while others are not yet determined. Count how many different permutations pp can produce this coloring sequence. Since the answer may be large, you need to output it modulo 998244353998\\,244\\,353."
  },
  {
    "title": "Interactive RBS (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2129/C3",
    "description": "This is an interactive problem.This is the hard version of the problem. The only difference is the limit on the number of queries. You can make hacks only if all versions of the problem are solved.There is a hidden bracket sequence ss of length nn, where ss only contains '('\\texttt{'('} and ')'\\texttt{')'}. It is guaranteed that ss contains at least one '('\\texttt{'('} and one ')'\\texttt{')'}.To find this bracket sequence, you can ask queries. Each query has the following form: you pick an integer kk and arbitrary indices i1,i2,…,iki_1, i_2, \\ldots, i_k (1≤k≤10001 \\le k \\le 1000, 1≤i1,i2,…,ik≤n1 \\le i_1, i_2, \\ldots, i_k \\le n). Note that the indices can be equal. Next, you receive an integer f(si1si2…sik)f(s_{i_1}s_{i_2}\\ldots s_{i_k}) calculated by the jury.For a bracket sequence tt, f(t)f(t) is the number of non-empty regular bracket substrings in tt (the substrings must be contiguous). For example, f(\"()())\")=3f(\\texttt{\"()())\"}) = 3.A bracket sequence is called regular if it can be constructed in the following way.   The empty sequence ∅\\varnothing is regular.  If the bracket sequence AA is regular, then (A)\\mathtt{(}A\\mathtt{)} is also regular.  If the bracket sequences AA and BB are regular, then the concatenated sequence ABA B is also regular. For example, the sequences \"(())()\"\\texttt{\"(())()\"}, \"()\"\\texttt{\"()\"} are regular, while \"(()\"\\texttt{\"(()\"} and \"())(\"\\texttt{\"())(\"} are not.Find the sequence ss using no more than 100100 queries."
  },
  {
    "title": "Interactive RBS (Medium Version)",
    "url": "https://codeforces.com/problemset/problem/2129/C2",
    "description": "This is an interactive problem.This is the medium version of the problem. The only difference is the limit on the number of queries. You can make hacks only if all versions of the problem are solved.There is a hidden bracket sequence ss of length nn, where ss only contains '('\\texttt{'('} and ')'\\texttt{')'}. It is guaranteed that ss contains at least one '('\\texttt{'('} and one ')'\\texttt{')'}.To find this bracket sequence, you can ask queries. Each query has the following form: you pick an integer kk and arbitrary indices i1,i2,…,iki_1, i_2, \\ldots, i_k (1≤k≤10001 \\le k \\le 1000, 1≤i1,i2,…,ik≤n1 \\le i_1, i_2, \\ldots, i_k \\le n). Note that the indices can be equal. Next, you receive an integer f(si1si2…sik)f(s_{i_1}s_{i_2}\\ldots s_{i_k}) calculated by the jury.For a bracket sequence tt, f(t)f(t) is the number of non-empty regular bracket substrings in tt (the substrings must be contiguous). For example, f(\"()())\")=3f(\\texttt{\"()())\"}) = 3.A bracket sequence is called regular if it can be constructed in the following way.   The empty sequence ∅\\varnothing is regular.  If the bracket sequence AA is regular, then (A)\\mathtt{(}A\\mathtt{)} is also regular.  If the bracket sequences AA and BB are regular, then the concatenated sequence ABA B is also regular. For example, the sequences \"(())()\"\\texttt{\"(())()\"}, \"()\"\\texttt{\"()\"} are regular, while \"(()\"\\texttt{\"(()\"} and \"())(\"\\texttt{\"())(\"} are not.Find the sequence ss using no more than 200200 queries."
  },
  {
    "title": "Interactive RBS (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2129/C1",
    "description": "This is an interactive problem.This is the easy version of the problem. The only difference is the limit on the number of queries. You can make hacks only if all versions of the problem are solved.There is a hidden bracket sequence ss of length nn, where ss only contains '('\\texttt{'('} and ')'\\texttt{')'}. It is guaranteed that ss contains at least one '('\\texttt{'('} and one ')'\\texttt{')'}.To find this bracket sequence, you can ask queries. Each query has the following form: you pick an integer kk and arbitrary indices i1,i2,…,iki_1, i_2, \\ldots, i_k (1≤k≤10001 \\le k \\le 1000, 1≤i1,i2,…,ik≤n1 \\le i_1, i_2, \\ldots, i_k \\le n). Note that the indices can be equal. Next, you receive an integer f(si1si2…sik)f(s_{i_1}s_{i_2}\\ldots s_{i_k}) calculated by the jury.For a bracket sequence tt, f(t)f(t) is the number of non-empty regular bracket substrings in tt (the substrings must be contiguous). For example, f(\"()())\")=3f(\\texttt{\"()())\"}) = 3.A bracket sequence is called regular if it can be constructed in the following way.   The empty sequence ∅\\varnothing is regular.  If the bracket sequence AA is regular, then (A)\\mathtt{(}A\\mathtt{)} is also regular.  If the bracket sequences AA and BB are regular, then the concatenated sequence ABA B is also regular. For example, the sequences \"(())()\"\\texttt{\"(())()\"}, \"()\"\\texttt{\"()\"} are regular, while \"(()\"\\texttt{\"(()\"} and \"())(\"\\texttt{\"())(\"} are not.Find the sequence ss using no more than 550550 queries."
  },
  {
    "title": "Stay or Mirror",
    "url": "https://codeforces.com/problemset/problem/2129/B",
    "description": " You are given a permutation p1,p2,…,pnp_1, p_2, \\ldots, p_n of length nn.You have to build an array a1,a2,…,ana_1, a_2, \\ldots, a_n in the following way:  for each 1≤i≤n1 \\leq i \\leq n, set either ai=pia_i = p_i or ai=2n−pia_i = 2n - p_i. Find the minimum possible number of inversions in the array a1,a2,…,ana_1, a_2, \\ldots, a_n.A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). An inversion in the array a1,a2,…,ana_1, a_2, \\ldots, a_n is a pair of indices (i,j)(i, j) such that 1≤i<j≤n1 \\leq i<j \\leq n and ai>aja_i>a_j."
  },
  {
    "title": "Double Perspective",
    "url": "https://codeforces.com/problemset/problem/2129/A",
    "description": "For a set of pairs S={(a1,b1),(a2,b2),…,(am,bm)}S = \\{(a_1, b_1), (a_2, b_2), \\ldots, (a_m, b_m)\\}, where ai<bia_i < b_i for all 1≤i≤m1 \\le i \\le m, we define f(S)f(S) and g(S)g(S) as follows:  Treating each (ai,bi)(a_i, b_i) as a segment on the number line, f(S)f(S) is the length of their union. Formally, f(S)f(S) is the number of integers xx such that there exists an ii (1≤i≤m1 \\leq i \\leq m) where [x,x+1]⊆[ai,bi][x, x+1] \\subseteq [a_i, b_i].  Treating each (ai,bi)(a_i, b_i) as an undirected edge in a graph, g(S)g(S) is the number of nodes that lie on at least one simple cycle with at least 33 edges. Formally, g(S)g(S) is the number of nodes x1x_1 such that there exists a path x1→x2→…→xk→x1x_1 \\to x_2 \\to \\ldots \\to x_k \\to x_1 in the graph, where k≥3k \\geq 3 and all x1,x2,…,xkx_1, x_2, \\ldots, x_k are distinct. For example, S={(1,2),(2,4),(1,4),(4,5),(6,7)}S = \\{(1,2), (2,4), (1,4), (4,5),(6,7)\\}, we can get f(S)=5f(S) = 5 and g(S)=3g(S) = 3.You are given nn distinct pairs. Your task is to select a subset S′S' of these pairs such that f(S′)−g(S′)f(S') - g(S') is maximized. You need to output the indices of the selected pairs."
  },
  {
    "title": "Strict Triangle",
    "url": "https://codeforces.com/problemset/problem/2128/F",
    "description": "You are given an undirected connected graph with nn nodes and mm edges. The weight wiw_i of the ii-th edge is not yet decided and must be a real number between lil_i and rir_i.You are given a node kk. Determine if there exists a valid assignment of weights (w1,…,wm)(w_1, \\ldots, w_m) such that:   li≤wi≤ril_i \\leq w_i \\leq r_i for all ii, and  distw(1,n)≠distw(1,k)+distw(k,n)\\mathrm{dist}_w(1, n) \\neq \\mathrm{dist}_w(1, k) + \\mathrm{dist}_w(k, n)∗^{\\text{∗}}. ∗^{\\text{∗}}Given an assignment of weights ww, distw(u,v)\\mathrm{dist}_w(u, v) is the minimum value of we1+we2+…+wepw_{e_1} + w_{e_2} + \\ldots + w_{e_p} over all sequences of pp edges (e1,e2,…,ep)(e_1, e_2, \\ldots, e_p) that form a path from uu to vv."
  },
  {
    "title": "Submedians (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2128/E2",
    "description": "This is the hard version of the problem. The only difference is that in this version, you are asked to find a subarray for all submedians.You can make hacks only if both versions of the problem are solved.An integer vv is a median of an array bb of length mm if and only if:   vv is greater than or equal to at least ⌈m2⌉\\lceil \\frac{m}{2} \\rceil elements of the array, and  vv is less than or equal to at least ⌈m2⌉\\lceil \\frac{m}{2} \\rceil elements of the array.  For instance:   the only median of [9,3,7][9, 3, 7] is 77,  the medians of [5,3,7,9][5, 3, 7, 9] are 55, 66, and 77, and  the only median of [2,2,2][2, 2, 2] is 22. You're given an integer kk and an array a1,…,ana_1, \\ldots, a_n of integers between 11 and nn.An integer vv from 11 to nn is said to be a submedian if there exists at least one pair of indices (l,r)(l, r) such that   1≤l≤r≤n1 \\leq l \\leq r \\leq n,  r−l+1≥kr - l + 1 \\geq k,  vv is a median of the subarray [al,…,ar][a_l, \\ldots, a_r]. Find all submedians and for each of them, find any corresponding pair of indices (l,r)(l, r)."
  },
  {
    "title": "Submedians (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2128/E1",
    "description": "This is the easy version of the problem. The only difference is that in this version, you are asked to find a subarray only for the maximum submedian.You can make hacks only if both versions of the problem are solved.An integer vv is a median of an array bb of length mm if and only if:   vv is greater than or equal to at least ⌈m2⌉\\lceil \\frac{m}{2} \\rceil elements of the array, and  vv is less than or equal to at least ⌈m2⌉\\lceil \\frac{m}{2} \\rceil elements of the array.  For instance:   the only median of [9,3,7][9, 3, 7] is 77,  the medians of [5,3,7,9][5, 3, 7, 9] are 55, 66, and 77, and  the only median of [2,2,2][2, 2, 2] is 22. You're given an integer kk and an array a1,…,ana_1, \\ldots, a_n of integers between 11 and nn.An integer vv from 11 to nn is said to be a submedian if there exists at least one pair of indices (l,r)(l, r) such that   1≤l≤r≤n1 \\leq l \\leq r \\leq n,  r−l+1≥kr - l + 1 \\geq k,  vv is a median of the subarray [al,…,ar][a_l, \\ldots, a_r]. It can be proven that there always exists at least one submedian. Find the maximum submedian vmaxv_\\max and any corresponding pair of indices (l,r)(l, r)."
  },
  {
    "title": "Sum of LDS",
    "url": "https://codeforces.com/problemset/problem/2128/D",
    "description": " You're given a permutation∗^{\\text{∗}} p1,…,pnp_1, \\ldots, p_n such that max(pi,pi+1)>pi+2\\max(p_i, p_{i+1}) > p_{i+2} for all 1≤i≤n−21 \\leq i \\leq n-2.Compute the sum of the length of the longest decreasing subsequence†^{\\text{†}} of the subarray [pl,pl+1,…,pr][p_l, p_{l+1}, \\ldots, p_r] over all pairs 1≤l≤r≤n1 \\leq l \\leq r \\leq n.∗^{\\text{∗}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). †^{\\text{†}}Given an array bb of size |b||b|, a decreasing subsequence of length kk is a sequence of indices i1,…,iki_1, \\ldots, i_k such that:  1≤i1<i2<…<ik≤|b|1 \\leq i_1 < i_2 < \\ldots < i_k \\leq |b|  bi1>bi2>…>bikb_{i_1} > b_{i_2} > \\ldots > b_{i_k} "
  },
  {
    "title": "Leftmost Below",
    "url": "https://codeforces.com/problemset/problem/2128/C",
    "description": "Consider an array a1,…,ana1,…,ana_1, \\ldots, a_n. Initially, ai=0ai=0a_i = 0 for every iii.You can do operations of the following form.   You choose an integer xxx greater than min(a)min(a)\\min(a).  Then, iii is defined as the minimum index such that ai<xai<xa_i < x. In other words, iii is the unique integer between 111 and nnn inclusive such that ai<xai<xa_i < x and aj≥xaj≥xa_j \\geq x for every 1≤j≤i−11≤j≤i−11 \\leq j \\leq i-1.  Finally, aiaia_i is incremented by xxx. For example, if a=[6,8,2,1]a=[6,8,2,1]a = [6, 8, 2, 1] and you choose x=6x=6x = 6, then iii will be equal to 333 (since a1≥6a1≥6a_1 \\geq 6, a2≥6a2≥6a_2 \\geq 6, and a3<6a3<6a_3 < 6) and aaa will become [6,8,8,1][6,8,8,1][6, 8, 8, 1].You can do as many operations as you want. Can you reach a target array b1,…,bnb1,…,bnb_1, \\ldots, b_n?"
  },
  {
    "title": "Deque Process",
    "url": "https://codeforces.com/problemset/problem/2128/B",
    "description": " We say that an array aaa of size nn is bad if and only if there exists 1≤i≤n−41 \\leq i \\leq n - 4 such that one of the following conditions holds:  ai<ai+1<ai+2<ai+3<ai+4a_i < a_{i+1} < a_{i+2} < a_{i+3} < a_{i+4}  ai>ai+1>ai+2>ai+3>ai+4a_i > a_{i+1} > a_{i+2} > a_{i+3} > a_{i+4} An array is good if and only if it's not bad. For example:   a=[3,1,2,4,5,6]a = [3, \\color{red}{1, 2, 4, 5, 6}] is bad because a2<a3<a4<a5<a6a_2 < a_3 < a_4 < a_5 < a_6.  a=[7,6,5,4,1,2,3]a = [\\color{red}{7, 6, 5, 4, 1}, 2, 3] is bad because a1>a2>a3>a4>a5a_1 > a_2 > a_3 > a_4 > a_5.  a=[7,6,5,1,2,3,4]a = [7, 6, 5, 1, 2, 3, 4] is good. You're given a permutation∗^{\\text{∗}} p1,p2,…,pnp_1, p_2, \\ldots, p_n.You must perform nn turns. At each turn, you must remove either the leftmost or the rightmost remaining element in pp. Let qiq_i be the element removed at the ii-th turn.Choose which element to remove at each turn so that the resulting array qq is good. We can show that under the given constraints, it's always possible.∗^{\\text{∗}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). "
  },
  {
    "title": "Recycling Center",
    "url": "https://codeforces.com/problemset/problem/2128/A",
    "description": "In the recycling center, there are nn trash bags, the ii-th bag has a weight of aia_i. At each second, two actions will happen successively:   First, you must choose a trash bag and destroy it. It will cost 11 coin if the weight of the trash bag is strictly greater than cc, and it will cost 00 coins otherwise.  Then, the weight of each remaining trash bag will get multiplied by two.  What is the minimum number of coins you have to spend to get rid of all trash bags?"
  },
  {
    "title": "23 Rises Again",
    "url": "https://codeforces.com/problemset/problem/2127/H",
    "description": " Kiarash is picking strawberries to take home...A graph is called candy if and only if the degree of every vertex in it is at most 22.You are given a simple, undirected, and connected graph GG of n≤30n\\le 30 vertices, with a special property: each vertex belongs to at most 55 simple cycles∗^{\\text{∗}}.What is the maximum number of edges among all subgraphs†^{\\text{†}} of GG that are candy?∗^{\\text{∗}}A simple cycle is a connected subgraph such that each vertex has a degree of exactly 22†^{\\text{†}}A subgraph of GG is a graph whose vertices and edges are subsets of GG."
  },
  {
    "title": "Inter Active (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2127/G2",
    "description": "     This is the hard version of the problem. The difference between the versions is that in this version, you can make at most 10⋅n10⋅n10\\cdot n queries. You can hack only if you solved all versions of this problem. Ali loved Bahamin's gift (from problem E) so much that he illegally traveled from Qazvin to Liverpool to have the gift signed by football players. Now Interpol is searching for him, but they've offered a deal: solve a problem, and he can stay in Liverpool. But since he's currently at the stadium, he can't solve it — so he asked you to do it.This is an interactive problem. There is a hidden permutation∗^{\\text{∗}} pp of length n≥4n\\ge 4, where pi≠ip_i \\neq i for each 1≤i≤n1 \\leq i \\leq n.Initially, you should give the jury a positive integer k≤nk\\le n, which will be constant through future queries. Then you need to find permutation pp using some queries.In each query, you give a permutation q1,q2,…,qnq_1, q_2, \\ldots, q_n to the jury. In response, you will receive the number of pairs (i,j)(i, j) such that all of the following conditions hold:  i<ji \\lt j;  pqi=qjp_{q_i} = q_j;  i≠ki \\neq k. (kk is the constant you have given to the jury) You are given nn, and you need to find the permutation pp in at most 10⋅n10\\cdot n queries.∗^{\\text{∗}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). "
  },
  {
    "title": "Inter Active (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2127/G1",
    "description": "     This is the easy version of the problem. The difference between the versions is that in this version, you can make at most 15⋅n15\\cdot n queries. You can hack only if you solved all versions of this problem. Ali loved Bahamin's gift (from problem E) so much that he illegally traveled from Qazvin to Liverpool to have the gift signed by football players. Now Interpol is searching for him, but they've offered a deal: solve a problem, and he can stay in Liverpool. But since he's currently at the stadium, he can't solve it — so he asked you to do it.This is an interactive problem. There is a hidden permutation∗^{\\text{∗}} pp of length n≥4n\\ge 4, where pi≠ip_i \\neq i for each 1≤i≤n1 \\leq i \\leq n.Initially, you should give the jury a positive integer k≤nk\\le n, which will be constant through future queries. Then you need to find permutation pp using some queries.In each query, you give a permutation q1,q2,…,qnq_1, q_2, \\ldots, q_n to the jury. In response, you will receive the number of pairs (i,j)(i, j) such that all of the following conditions hold:  i<ji \\lt j;  pqi=qjp_{q_i} = q_j;  i≠ki \\neq k. (kk is the constant you have given to the jury) You are given nn, and you need to find the permutation pp in at most 15⋅n15\\cdot n queries.∗^{\\text{∗}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). "
  },
  {
    "title": "Hamed and AghaBalaSar",
    "url": "https://codeforces.com/problemset/problem/2127/F",
    "description": " Hamid wrote 30143014 lines of code for the a+b problem and gave 1010 lines of it to Hamed; then the following problem came to Hamed's mind.You are given two integers nn and mm.An array a1,a2,…,ana_1,a_2,\\ldots,a_n is called snake if and only if all of the following conditions hold:   All elements in aa are integers between 00 and mm;  a1+a2+⋯+an=ma_1 + a_2 + \\cdots + a_n = m;  an=max([a1,a2,…,an])a_n=\\max\\left([a_1, a_2, \\ldots, a_n]\\right). We define f(a)f(a) as in the following pseudocode:function f(array a):    pos := 1    res := 0    let nxt[x] be an array such that nxt[x] is the smallest index y such that                                    y > x and a[y] > a[x],                              or undefined if no such y exists    while pos < n:        if a[pos] < a[n]:            res += a[nxt[pos]] - a[pos]            pos := nxt[pos]        else:            pos += 1    return resFind the sum of f(a)f(a) over all snake arrays a1,a2,…,ana_1,a_2,\\ldots,a_n, modulo 109+710^9+7."
  },
  {
    "title": "Ancient Tree",
    "url": "https://codeforces.com/problemset/problem/2127/E",
    "description": "   Bahamin came from the past to visit Ali — who came from the future. He also brought an ancient tree as a gift for Ali. He noticed some of its vertices have lost their color. Bahamin needs to repaint these vertices, but he is very busy with fixing his time machine. Fortunately (or unfortunately), dinosaurs now handle such tasks — for a fee, of course. He needs your help to find the coloring with minimum cost. So he gives you the problem as follows.You are given a rooted tree∗∗^{\\text{∗}} of nn vertices, where vertex 11 is the root. Each vertex has an integer weight wiw_i and a color cic_i, where the colors are integers between 11 and kk. However, some vertices have lost their colors, represented by ci=0c_i = 0.We call vertex vv cutie if there exists two vertices xx and yy, such that  lca(x,y)\\operatorname{lca}(x, y)†^{\\text{†}} =v= v,  cx=cyc_x = c_y, and  cx≠cvc_x \\neq c_v. The cost of the tree is the sum of weights of all cutie vertices.You have to assign colors between 11 and kk to all the vertices which have lost their colors. Find the minimum possible cost among all valid colorings and provide a coloring with the minimum possible cost.∗^{\\text{∗}}A tree is a connected graph without cycles.  A rooted tree is a tree where one vertex is special and called the root. †^{\\text{†}}lca(x,y)\\operatorname{lca}(x, y) denotes the lowest common ancestor (LCA) of xx and yy."
  },
  {
    "title": "Root was Built by Love, Broken by Destiny",
    "url": "https://codeforces.com/problemset/problem/2127/D",
    "description": "Heartfall River runs horizontally through Destinyland and divides it into the northern and southern sides.Engineer Root wants to build nn houses along the river, numbered from 11 to nn. All houses on the northern side and all houses on the southern side must lie along straight lines parallel to Heartfall River.There will be mm bridges, with the ii-th bridge connecting house uiu_i and house viv_i (ui≠viu_i \\ne v_i). It is guaranteed that all nn houses are connected by these bridges, that is, you can travel from any house to any other by crossing bridges. Also, there are no two bridges connecting the same pair of houses.Root wants to know how many ways there are to arrange the nn houses along the river, modulo 109+710^9+7, such that the following conditions hold for the planned mm bridges:  For every bridge, the two houses it connects lie on opposite sides of the river;  The bridges do not cross when drawn as straight lines between the houses.   A possible arrangement of the houses when n=5n=5. Two arrangements are considered different if at least one of the following conditions holds:  There exists a house that lies on a different side in each arrangement;  There exist two houses aa and bb that are on the same side in both arrangements, but aa comes before bb in one arrangement and bb comes before aa in the other. Since Root is distracted by his ex, whom destiny separated from him, he asks you to calculate the number of ways to arrange the houses along the river, modulo 109+710^9+7."
  },
  {
    "title": "Trip Shopping",
    "url": "https://codeforces.com/problemset/problem/2127/C",
    "description": " Ali and Bahamin decided to spend their summer vacation on the beautiful southern coasts of Iran. They also agreed to do some shopping during the trip — but instead of setting a fixed budget, they decided to determine how much they would spend by playing a game.The game is played on two arrays aa and bb, each containing nn integers.The game will last for kk rounds. In one round:   First, Ali selects two indices ii and jj (1≤i<j≤n1 \\leq i < j \\leq n);  Then, Bahamin rearranges the four integers aia_i, aja_j, bib_i, and bjb_j arbitrarily. Note that Bahamin can swap numbers between two arrays. He can also keep the two arrays unchanged.  After all the kk rounds, the value of the game is defined as v=n∑i=1|ai−bi|v=\\sum\\limits_{i=1}^{n} |a_i-b_i|. Ali and Bahamin will spend exactly vv coins during their trip.However, their goals are quite different:   Ali wants to spend as little as possible, that is, to minimize vv;  Bahamin wants to spend as much as possible, that is, to maximize vv. You have to find the final amount of coins they will spend if both Ali and Bahamin play optimally."
  },
  {
    "title": "Hamiiid, Haaamid..",
    "url": "https://codeforces.com/problemset/problem/2127/B",
    "description": " Mani has locked Hamid in a 1×n1 \\times n grid. Initially, some cells of the grid contain walls and the rest are empty, and Hamid is in an empty cell.In each day, the following events happen in order: Mani selects an empty cell and builds a wall in that cell. Note that he can not build a wall in the cell which Hamid currently is at;  Hamid selects a direction (left or right), then If there are no walls in that direction, he will escape the grid;  Otherwise, he will move to the nearest wall in that direction and destroy that wall. Hamid is at the position of the destroyed wall after this day.Here is an example of a possible sequence of actions when n=6n=6:   Hamid is always aware of where the walls are. He wants to minimize the number of days that he needs to escape the grid, while Mani wants to maximize it.You have to determine the number of days Hamid needs to escape the grid if they both act optimally."
  },
  {
    "title": "Mix Mex Max",
    "url": "https://codeforces.com/problemset/problem/2127/A",
    "description": " You are given an array aa consisting of nn non-negative integers. However, some elements of aa are missing, and they are represented by −1−1.We define that the array aa is good if and only if the following holds for every 1≤i≤n−21 \\leq i \\leq n-2:mex([ai,ai+1,ai+2])=max([ai,ai+1,ai+2])−min([ai,ai+1,ai+2]), \\operatorname{mex}([a_i, a_{i+1}, a_{i+2}]) = \\max([a_i, a_{i+1}, a_{i+2}]) - \\min([a_i, a_{i+1}, a_{i+2}]), where mex(b)\\operatorname{mex}(b) denotes the minimum excluded (MEX)∗^{\\text{∗}} of the integers in bb. You have to determine whether you can make aa good after replacing each −1-1 in aa with a non-negative integer.∗^{\\text{∗}}The minimum excluded (MEX) of a collection of integers b1,b2,…,bkb_1, b_2, \\ldots, b_k is defined as the smallest non-negative integer xx which does not occur in the collection bb.  For example, mex([2,2,1])=0\\operatorname{mex}([2,2,1])=0 because 00 does not belong to the array, and mex([0,3,1,2])=4\\operatorname{mex}([0,3,1,2])=4 because 00, 11, 22, and 33 appear in the array, but 44 does not."
  },
  {
    "title": "Big Wins! (hard version)",
    "url": "https://codeforces.com/problemset/problem/2126/G2",
    "description": "This is the hard version of the problem. The difference between the versions is that in this version ai≤na_i \\leq n.You are given an array of nn integers a1,a2,…,ana_1, a_2, \\dots, a_n.Your task is to find a subarray a[l,r]a[l, r] (a continuous sequence of elements al,al+1,…,ara_l, a_{l + 1}, \\dots, a_r) for which the value of the expression med(a[l,r])−min(a[l,r])\\text{med}(a[l, r]) - \\min(a[l, r]) is maximized.Here:   med\\text{med} is the median of the subarray, that is, the element at position ⌈k+12⌉\\left\\lceil \\frac{k + 1}{2} \\right\\rceil after sorting the subarray, where kk is its length;  min\\min is the minimum element of this subarray. For example, consider the array a=[1,4,1,5,3,3]a=[1, 4, 1, 5, 3, 3] and choose the subarray a[2,5]=[4,1,5,3]a[2, 5] = [4, 1, 5, 3]. In sorted form, it looks like [1,3,4,5][1, 3, 4, 5].  med(a[2,5])=4\\text{med}(a[2, 5]) = 4, since ⌈4+12⌉=\\left\\lceil \\frac{4 + 1}{2} \\right\\rceil =  the third element in the sorted subarray is 44;  min(a[2,5])=1\\min(a[2, 5]) = 1, since the minimum element is 11. In this example, the value med−min=4−1=3\\text{med} - \\min = 4 - 1 = 3."
  },
  {
    "title": "Big Wins! (easy version)",
    "url": "https://codeforces.com/problemset/problem/2126/G1",
    "description": "This is the easy version of the problem. The difference between the versions is that in this version ai≤min(n,100)a_i \\leq \\min(n,100).You are given an array of nn integers a1,a2,…,ana_1, a_2, \\dots, a_n.Your task is to find a subarray a[l,r]a[l, r] (a continuous sequence of elements al,al+1,…,ara_l, a_{l + 1}, \\dots, a_r) for which the value of the expression med(a[l,r])−min(a[l,r])\\text{med}(a[l, r]) - \\min(a[l, r]) is maximized.Here:   med\\text{med} — the median of the subarray, which is the element at position ⌈k+12⌉\\left\\lceil \\frac{k + 1}{2} \\right\\rceil after sorting the subarray, where kk is its length;  min\\min — the minimum element of this subarray. For example, consider the array a=[1,4,1,5,3,3]a=[1, 4, 1, 5, 3, 3] and choose the subarray a[2,5]=[4,1,5,3]a[2, 5] = [4, 1, 5, 3]. In sorted form, it looks like [1,3,4,5][1, 3, 4, 5].  med(a[2,5])=4\\text{med}(a[2, 5]) = 4, since ⌈4+12⌉=\\left\\lceil \\frac{4 + 1}{2} \\right\\rceil =  the third element in the sorted subarray is 44;  min(a[2,5])=1\\min(a[2, 5]) = 1, since the minimum element is 11. In this example, the value med−min=4−1=3\\text{med} - \\min = 4 - 1 = 3."
  },
  {
    "title": "1-1-1, Free Tree!",
    "url": "https://codeforces.com/problemset/problem/2126/F",
    "description": "Given a tree∗^{\\text{∗}} with nn vertices numbered from 11 to nn. Each vertex has an initial color aia_i.Each edge of the tree is defined by three numbers: uiu_i, viv_i, and cic_i, where uiu_i and viv_i are the endpoints of the edge, and cic_i is the edge parameter. The cost of the edge is defined as follows: if the colors of vertices uiu_i and viv_i are the same, the cost is 00; otherwise, the cost is cic_i.You are also given qq queries. Each query has the form: repaint vertex vv to color xx. The queries depend on each other (after each query, the color change is preserved). After each query, you need to output the sum of the costs of all edges in the tree.∗^{\\text{∗}}A tree is a connected graph without cycles. "
  },
  {
    "title": "G-C-D, Unlucky!",
    "url": "https://codeforces.com/problemset/problem/2126/E",
    "description": "Two arrays ppp and sss of length nnn are given, where ppp is the prefix GCD∗∗^{\\text{∗}} of some array aaa, and sss is the suffix GCD of the same array aaa. In other words, if the array aaa existed, then for each 1≤i≤n1≤i≤n1 \\le i \\le n, the following equalities would hold both:   pi=gcd(a1,a2,…,ai)pi=gcd(a1,a2,…,ai)p_i = \\gcd(a_1, a_2, \\dots, a_i)  si=gcd(ai,ai+1,…,an)si=gcd(ai,ai+1,…,an)s_i = \\gcd(a_i, a_{i+1}, \\dots, a_n).  Determine whether there exists such an array aaa for which the given arrays ppp and sss can be obtained.∗∗^{\\text{∗}}gcd(x,y)gcd(x,y)\\gcd(x, y) denotes the greatest common divisor (GCD) of integers xxx and yyy. "
  },
  {
    "title": "This Is the Last Time",
    "url": "https://codeforces.com/problemset/problem/2126/D",
    "description": "You are given nnn casinos, numbered from 11 to nn. Each casino is described by three integers: lil_i, rir_i, and realireal_i (li≤reali≤ril_i \\le real_i \\le r_i). You initially have kk coins.You can play at casino ii only if the current number of coins xx satisfies li≤x≤ril_i \\le x \\le r_i. After playing, your number of coins becomes realireal_i.You can visit the casinos in any order and are not required to visit all of them. Each casino can be visited no more than once.Your task is to find the maximum final number of coins you can obtain."
  },
  {
    "title": "I Will Definitely Make It",
    "url": "https://codeforces.com/problemset/problem/2126/C",
    "description": "You are given nn towers, numbered from 11 to nn. Tower ii has a height of hih_i. At time 00, you are on the tower with index kk, and the current water level is 11.Every second, the water level rises by 11 unit. At any moment, if the water level becomes strictly greater than the height of the tower you are on, you perish.You have a magical ability: at moment xx, you can start teleporting from tower ii to tower jj, which will take |hi−hj|\\lvert h_i - h_j \\rvert seconds. That is, until moment x+|hi−hj|x + \\lvert h_i - h_j \\rvert, you will be on tower ii, and at moment x+|hi−hj|x + \\lvert h_i - h_j \\rvert, you will move to tower jj. You can start a new teleportation at the same moment you just arrived at tower jj.For example, if n=k=4n=k=4, h=[4,4,4,2]h=[4, 4, 4, 2], then if you start teleporting from tower 44 to tower 11 at moment 00, the movement will look as follows:   Note that if the height of tower 11 were 55, you would not be able to teleport to it immediately, as you would be submerged at moment 22.Your goal is to reach any tower with the maximum height before the water covers you.Determine if this is possible."
  },
  {
    "title": "No Casino in the Mountains",
    "url": "https://codeforces.com/problemset/problem/2126/B",
    "description": "You are given an array aa of nn numbers and a number kk. The value aia_i describes the weather on the ii-th day: if it rains on the ii-th day, then ai=1a_i = 1; otherwise, if the weather is good on the ii-th day, then ai=0a_i = 0.Jean wants to visit as many peaks as possible. One hike to a peak takes exactly kk days, and during each of these days, the weather must be good (ai=0a_i = 0). That is, formally, he can start a hike on day ii only if all aj=0a_j = 0 for all jj (i≤j≤i+k−1)(i \\leq j \\leq i + k - 1).After each hike, before starting the next one, Jean must take a break of at least one day, meaning that on the day following a hike, he cannot go on another hike.Find the maximum number of peaks that Jean can visit."
  },
  {
    "title": "Only One Digit",
    "url": "https://codeforces.com/problemset/problem/2126/A",
    "description": "You are given an integer xx. You need to find the smallest non-negative integer yy such that the numbers xx and yy share at least one common digit. In other words, there must exist a decimal digit dd that appears in both the representation of the number xx and the number yy."
  },
  {
    "title": "Timofey and Docker",
    "url": "https://codeforces.com/problemset/problem/2125/F",
    "description": "Not so long ago, a certain Timofey learned about docker and now wants to present a report about it at a conference. He has already prepared the text ss.There are nn people attending the conference. The ii-th attendee will understand Timofey's report if the number of occurrences of the word \"docker\" as a contiguous substring in the text is not less than lil_i and not greater than rir_i.To ensure that as many people as possible learn about docker, Timofey can change characters in his text.Help Timofey determine the minimum number of characters that need to be changed so that the topic is understood by the maximum possible number of attendees."
  },
  {
    "title": "Sets of Complementary Sums",
    "url": "https://codeforces.com/problemset/problem/2125/E",
    "description": "We call a set of integers QQ a set of complementary sums if it can be obtained through the following actions:  choose an array aa consisting of mm positive integers (mm is any positive integer);  calculate the sum ss of all elements in the array aa;  for each element aia_{i} in the array, add the number s−ais - a_{i} to the set, more formally the set Q={s−ai|1≤i≤m}Q = \\{s - a_{i}\\;|\\; 1 \\le i \\le m\\}. Note that QQ is not a multiset, meaning each number in it is unique. For example, if the array a=[1,3,3,7]a = [1, 3, 3, 7] was chosen, then s=14s = 14 and Q={7,11,13}Q = \\{7, 11, 13\\}.Your task is to count the number of distinct sets of complementary sums for which the following holds:  the set contains exactly nn elements;  each element of the set is an integer from 11 to xx. Two sets are considered different if there exists an element in the first set that is not included in the second set.Since the answer can be huge, output it modulo 998244353998\\,244\\,353."
  },
  {
    "title": "Segments Covering",
    "url": "https://codeforces.com/problemset/problem/2125/D",
    "description": "There is a linear strip divided into mm cells, numbered from 11 to mm from left to right.You are given nn segments. Each segment is defined by four numbers: ll, rr, pp and qq — the segment covers cells from ll to rr inclusively and exists with probability pq\\frac{p}{q} (independently).Your task is to calculate the probability that each cell is covered by exactly one segment."
  },
  {
    "title": "Count Good Numbers",
    "url": "https://codeforces.com/problemset/problem/2125/C",
    "description": "A prime number is a positive integer that has exactly two divisors: 11 and itself. The first several prime numbers are 2,3,5,7,11,…2, 3, 5, 7, 11, \\dots.Prime factorization of a positive integer is representing it as a product of prime numbers. For example:  the prime factorization of 111111 is 3⋅373 \\cdot 37;  the prime factorization of 4343 is 4343;  the prime factorization of 1212 is 2⋅2⋅32 \\cdot 2 \\cdot 3. For every positive integer, its prime factorization is unique (if you don't consider the order of primes in the product).We call a positive integer good if all primes in its factorization consist of at least two digits. For example:  343=7⋅7⋅7343 = 7 \\cdot 7 \\cdot 7 is not good;  111=3⋅37111 = 3 \\cdot 37 is not good;  1111=11⋅1011111 = 11 \\cdot 101 is good;  43=4343 = 43 is good. You have to calculate the number of good integers from ll to rr (endpoints included)."
  },
  {
    "title": "Left and Down",
    "url": "https://codeforces.com/problemset/problem/2125/B",
    "description": "There is a robot located in the cell (a,b)(a,b)(a,b) of an infinite grid. Misha wants to move it to the cell (0,0)(0,0). To do this, he has fixed some integer kk.Misha can perform the following operation: choose two integers dxdx and dydy (both from 00 to kk inclusive) and move the robot dxdx cells to the left (in the direction of decreasing xx coordinate) and dydy cells down (in the direction of decreasing yy coordinate). In other words, move the robot from (x,y)(x,y) to (x−dx,y−dy)(x - dx, y - dy).The cost of the operation is:   11, if the chosen pair (dx,dy)(dx,dy) is used for the first time;  00, if the pair (dx,dy)(dx,dy) has been chosen before. Note that if dx≠dydx \\ne dy, the pairs (dx,dy)(dx, dy) and (dy,dx)(dy, dx) are considered different.Help Misha bring the robot to the cell (0,0)(0,0) with minimum total cost. Note that you don't have to minimize the number of operations."
  },
  {
    "title": "Difficult Contest",
    "url": "https://codeforces.com/problemset/problem/2125/A",
    "description": "It is known that a contest can be represented by a string ss, consisting of uppercase Latin letters that denote problems. It is also known that a contest is difficult if it contains \"FFT\" or \"NTT\" as a contiguous substring.Your task is to rearrange the problem in contest ss in such a way that this contest is not difficult. If the initial contest is not difficult, you may leave it as it is."
  },
  {
    "title": "Lexicographic Partition",
    "url": "https://codeforces.com/problemset/problem/2124/I",
    "description": "   Given an array aaa, define f(a)f(a)f(a) as follows:   Let kkk be an integer with 1≤k≤n1≤k≤n1 \\leq k \\leq n.  Partition aaa into kkk subarrays∗∗^{\\text{∗}} s1,s2,…,sks1,s2,…,sks_1,s_2,\\ldots,s_k such that s1+s2+…+sk=as1+s2+…+sk=as_1+s_2+\\ldots+s_k=a. Here, +++ represents array concatenation.  Let bbb be an empty array. For each iii from 111 to kkk in order, append the minimum element of sisis_i to the end of bbb.  Over all possible kkk and partitions, f(a)f(a)f(a) is the value of kkk such that there exists a partition that produces the lexicographically largest bbb††^{\\text{†}}. You are given nnn integers x1,x2,…,xnx1,x2,…,xnx_1,x_2,\\ldots,x_n. Please determine if there exists a permutation‡‡^{\\text{‡}} aaa such that f([a1,a2,…,ai])=xif([a1,a2,…,ai])=xif([a_1,a_2,\\ldots,a_i])=x_i for each 1≤i≤n1 \\leq i \\leq n. If there is a permutation, print one. If there are multiple possible answers, you may output any one.∗^{\\text{∗}}An array cc is a subarray of an array dd if cc can be obtained from dd by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. †^{\\text{†}}An array cc is lexicographically smaller than an array dd if and only if one of the following holds:   cc is a prefix of dd, but c≠dc \\ne d; or  in the first position where cc and dd differ, the array cc has a smaller element than the corresponding element in dd.  ‡^{\\text{‡}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). "
  },
  {
    "title": "Longest Good Subsequence",
    "url": "https://codeforces.com/problemset/problem/2124/H",
    "description": "  Call an array bb of size mm good if the following conditions hold:   1≤bi≤i1 \\leq b_i \\leq i for each 1≤i≤m1 \\leq i \\leq m.  There exists a permutation∗^{\\text{∗}} pp of size mm such that for each 1≤i≤m1 \\leq i \\leq m, bib_i is the smallest integer where min(pbi,pbi+1,…,pi)=pi\\min(p_{b_i}, p_{b_i+1}, \\ldots, p_i)=p_i. For example, the array [1,1,3,3,5][1,1,3,3,5] is good (where the permutation p=[2,1,5,3,4]p=[2,1,5,3,4] satisfies the second requirement), but the array [1,1,2][1,1,2] isn't.Note the empty array is considered to be good.You are given an array aa of size nn. Find the length of the longest good subsequence†^{\\text{†}} of aa.∗^{\\text{∗}}A permutation of length mm is an array consisting of mm distinct integers from 11 to mm in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (m=3m=3 but there is 44 in the array). †^{\\text{†}}A sequence cc is a subsequence of a sequence dd if cc can be obtained from dd by the deletion of several (possibly, zero or all) element from arbitrary positions. "
  },
  {
    "title": "Maximise Sum",
    "url": "https://codeforces.com/problemset/problem/2124/G",
    "description": "This problem differs from problem B. In this problem, you must output the maximum sum of prefix minimums over all operations that cost at least xx for each integer xx from 00 to n−1n-1.You are given an array aa of length nn, with elements satisfying 0≤ai≤n\\boldsymbol{0 \\le a_i \\le n}. You can perform the following operation at most once:  Choose two indices ii and jj such that i<ji < j. Set ai:=ai+aja_i := a_i + a_j. Then, set aj=0a_j = 0. Let the cost of one operation be the value of j−ij-i. The cost of not performing an operation is 00.For each integer xx from 00 to n−1n-1 inclusive, output the maximum possible value of min(a1)+min(a1,a2)+…+min(a1,a2,…,an)\\min(a_1) + \\min(a_1,a_2) + \\ldots + \\min(a_1, a_2, \\ldots, a_n) over all possible operations that have a cost of at least xx."
  },
  {
    "title": "Appending Permutations (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2124/F2",
    "description": " This is the hard version of the problem. The difference between the versions is that in this version, n≤5000n \\leq 5000. You can hack only if you solved all versions of this problem. You are given an initially empty array aa. You may perform the following operation any number of times:  Choose an integer s≥1s \\ge 1 and append a cyclic shift of the array [1,2,…,s][1, 2, \\ldots, s] to the end of aa. Formally, select integers ss and rr such that 1≤r≤s1 \\le r \\le s, and append the array [r,r+1,…,s,1,2,…,r−1] [r, r+1, \\ldots, s, 1, 2, \\ldots, r-1]  to the end of aa.  You are also given an integer nn and mm restrictions of the form ai≠xa_i \\ne x. That is, for each of the mm restrictions, the value at position ii in the final array must not be equal to xx.Your task is to count the number of distinct arrays of length exactly nn that can be constructed using the allowed operation and satisfy all of the given restrictions. Two arrays are considered different if they differ at any position from 11 to nn.Print the answer modulo 998244353998\\,244\\,353."
  },
  {
    "title": "Appending Permutations (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2124/F1",
    "description": " This is the easy version of the problem. The difference between the versions is that in this version, n≤100n \\leq 100. You can hack only if you solved all versions of this problem. You are given an initially empty array aa. You may perform the following operation any number of times:  Choose an integer s≥1s \\ge 1 and append a cyclic shift of the array [1,2,…,s][1, 2, \\ldots, s] to the end of aa. Formally, select integers ss and rr such that 1≤r≤s1 \\le r \\le s, and append the array [r,r+1,…,s,1,2,…,r−1] [r, r+1, \\ldots, s, 1, 2, \\ldots, r-1]  to the end of aa.  You are also given an integer nn and mm restrictions of the form ai≠xa_i \\ne x. That is, for each of the mm restrictions, the value at position ii in the final array must not be equal to xx.Your task is to count the number of distinct arrays of length exactly nn that can be constructed using the allowed operation and satisfy all of the given restrictions. Two arrays are considered different if they differ at any position from 11 to nn.Print the answer modulo 998244353998\\,244\\,353."
  },
  {
    "title": "Make it Zero",
    "url": "https://codeforces.com/problemset/problem/2124/E",
    "description": "You are given an array aaa, consisting of nn positive integers. You are allowed to do the following operation:   Select an array bb of size nn such that the following properties hold:  0≤bi≤ai0 \\leq b_i \\leq a_i for each 1≤i≤n1 \\leq i \\leq n  There exists an index 1≤i<n1\\leq i < n such that b1+b2+…+bi=bi+1+bi+2+…+bnb_1+b_2+\\ldots+b_i=b_{i+1}+b_{i+2}+\\ldots+b_n. That is, the sum of the prefix of length ii is equal to the sum of the suffix of length n−in-i.   Then, subtract bib_i from aia_i for each 1≤i≤n1 \\leq i \\leq n. Your task is to change all the elements to 00. Find the minimum number of operations required. Then, output a way to perform the operations. If it is impossible to change all the elements of aa to 00 no matter how many operations are used, print −1-1 instead. It can be shown that under the constraints of this problem, the smallest number of operations required is at most 1717."
  },
  {
    "title": "Make a Palindrome",
    "url": "https://codeforces.com/problemset/problem/2124/D",
    "description": "You are given an array aa of size nn, and an integer kk. You may perform the following operation any number of times:   Select two integers ll and rr (1≤l≤r≤|a|)(1 \\le l \\le r \\le |a|) such that r−l+1≥kr-l+1 \\geq k.  Then, select an index ii such that l≤i≤rl\\leq i \\leq r where aia_i is the kk-th smallest number out of the subarray [al,al+1,…,ar][a_l,a_{l+1},\\ldots,a_r]. If there are multiple possible ii, you may select any. For example, consider a=[1,2,2,1,3],l=1,r=5a = [1, 2, 2, 1, 3], l = 1, r = 5 and k=3k = 3, the possible candidates of ii are indices 22 and 33.  Then, delete aia_i from aa, concatenating the remaining parts of the array. Determine if it is possible to get an array that is a palindrome∗^{\\text{∗}} after any number of operations. Note that an empty array is considered a palindrome. ∗^{\\text{∗}}An array b=[b1,b2,…,bm]b=[b_1,b_2,\\ldots,b_m] is a palindrome if for each 1≤i≤m1 \\leq i \\leq m, bi=bm+1−ib_i=b_{m+1-i}."
  },
  {
    "title": "Subset Multiplication",
    "url": "https://codeforces.com/problemset/problem/2124/C",
    "description": "Alice has an array aa, consisting of nn positive integers. The array satisfies the beautiful property that aia_i divides ai+1a_{i+1} for each 1≤i≤n−11 \\leq i \\leq n - 1. Bob sees Alice's beautiful array and is jealous. To sabotage her, Bob first creates an array bb of size nn such that bi=aib_i=a_i for each 1≤i≤n1 \\leq i \\leq n. Then, he chooses a positive integer xx and multiplies some (possibly none, possibly all) elements in bb by xx. Formally, he chooses a (possibly-empty) subset S⊆{1,2,…,n}S\\subseteq\\{1,2,\\ldots,n\\}, and for each i∈Si\\in S, he sets bi:=bi⋅xb_i:=b_i\\cdot x. You are given an array bb, but you don't know array aa and the chosen number xx. Please output any integer xx that Bob could choose, so that multiplying some subset of elements of the correct array aa by xx would result in array bb. It is guaranteed that the answer exists. If there are multiple possible integers, you can output any of them."
  },
  {
    "title": "Minimise Sum",
    "url": "https://codeforces.com/problemset/problem/2124/B",
    "description": "This problem differs from problem G. In this problem, you must output the minimum sum of prefix minimums after at most one operation.You are given an array aa of length nn, with elements satisfying 0≤ai≤n\\boldsymbol{0 \\le a_i \\le n}. You can perform the following operation at most once:  Choose two indices ii and jj such that i<ji < j. Set ai:=ai+aja_i := a_i + a_j. Then, set aj=0a_j = 0. Output the minimum possible value of min(a1)+min(a1,a2)+…+min(a1,a2,…,an)\\min(a_1) + \\min(a_1,a_2) + \\ldots + \\min(a_1, a_2, \\ldots, a_n) that you can get."
  },
  {
    "title": "Deranged Deletions",
    "url": "https://codeforces.com/problemset/problem/2124/A",
    "description": "Call an array bb of length mm a derangement if the following property holds:  Let cc be an array of length mm such that ci=bic_i = b_i over all 1≤i≤m1 \\leq i \\leq m.  Sort cc in non-decreasing order.  If bi≠cib_i\\neq c_i over all 1≤i≤m1\\leq i \\leq m, then bb is a derangement. For example,  If b=[4,8,3,1]b = [4,8,3,1], then c=[1,3,4,8]c = [1, 3, 4, 8] after getting sorted. Since bi≠cib_i \\neq c_i in all positions, bb is a derangement.  If b=[3,2,1]b = [3,2,1], then c=[1,2,3]c = [1, 2, 3] after getting sorted. Since b2=c2b_2 = c_2, bb is not a derangement. You are given an array aa of length nn. In one operation, you can delete an element from aa. The order of the remaining elements is preserved after each deletion.Output whether it is possible to perform some (possibly none) operations such that the remaining elements form a derangement. If it is possible, output any possible remaining array. The remaining array must be non-empty."
  },
  {
    "title": "Modular Sorting",
    "url": "https://codeforces.com/problemset/problem/2123/G",
    "description": "You are given an integer mm (2≤m≤5⋅1052\\leq m\\leq 5\\cdot 10^5) and an array aa consisting of nonnegative integers smaller than mm.Answer queries of the following form:   11 ii xx: assign ai:=xa_i := x  22 kk: in one operation, you may choose an element aia_i and assign ai:=(ai+k)(modm)a_i := (a_i + k) \\pmod m∗^{\\text{∗}} — determine if there exists some sequence of (possibly zero) operations to make aa nondecreasing†^{\\text{†}}. Note that instances of query 22 are independent; that is, no actual operations are taking place. Instances of query 11 are persistent.∗^{\\text{∗}}a(modm)a\\pmod m is defined as the unique integer bb such that 0≤b<m0\\leq b<m and a−ba-b is an integer multiple of mm.†^{\\text{†}}An array aa of size nn is called nondecreasing if and only if ai≤ai+1a_i\\leq a_{i+1} for all 1≤i<n1\\leq i<n."
  },
  {
    "title": "Minimize Fixed Points",
    "url": "https://codeforces.com/problemset/problem/2123/F",
    "description": "Call a permutation∗^{\\text{∗}} pp of length nn good if gcd(pi,i)\\gcd(p_i, i)†^{\\text{†}} >1 > 1 for all 2≤i≤n2 \\leq i \\leq n. Find a good permutation with the minimum number of fixed points‡^{\\text{‡}} across all good permutations of length nn. If there are multiple such permutations, print any of them.∗^{\\text{∗}} A permutation of length nn is an array that contains every integer from 11 to nn exactly once, in any order. †^{\\text{†}}gcd(x,y)\\gcd(x, y) denotes the greatest common divisor (GCD) of xx and yy.‡^{\\text{‡}}A fixed point of a permutation pp is an index jj (1≤j≤n1\\leq j\\leq n) such that pj=jp_j = j."
  },
  {
    "title": "MEX Count",
    "url": "https://codeforces.com/problemset/problem/2123/E",
    "description": "Define the MEXMEX\\mathrm{MEX} (minimum excluded value) of an array to be the smallest nonnegative integer not present in the array. For example,  MEX([2,2,1])=0\\mathrm{MEX}([2, 2, 1]) = 0 because 00 is not in the array.  MEX([3,1,0,1])=2\\mathrm{MEX}([3, 1, 0, 1]) = 2 because 00 and 11 are in the array but 22 is not.  MEX([0,3,1,2])=4\\mathrm{MEX}([0, 3, 1, 2]) = 4 because 00, 11, 22, and 33 are in the array but 44 is not. You are given an array aa of size nn of nonnegative integers.For all kk (0≤k≤n0\\leq k \\leq n), count the number of possible values of MEX(a)\\mathrm{MEX}(a) after removing exactly kk values from aa."
  },
  {
    "title": "Binary String Battle",
    "url": "https://codeforces.com/problemset/problem/2123/D",
    "description": "Alice and Bob are given a binary string ss of length nn, and an integer kk (1≤k<n1\\leq k < n).Alice wins if she is able to transform all characters of ss into zeroes. If Alice is unable to win in a finite number of moves, then Bob wins.Alice and Bob take turns, with Alice going first.   On Alice's turn, she may choose any subsequence∗^{\\text{∗}} of length kk in ss, then set all characters in that subsequence to zero.  On Bob's turn, he may choose any substring†^{\\text{†}} of length kk in ss, then set all characters in that substring to one. Note that Alice wins if the string consists of all zeros at any point during the game, including in between Alice's and Bob's turns.Determine who wins with optimal play.∗^{\\text{∗}}A subsequence of a string ss is a set of characters in ss. Note that these characters do not have to be adjacent.†^{\\text{†}}A substring of a string ss is a contiguous group of characters in ss. Note that these characters must be adjacent."
  },
  {
    "title": "Prefix Min and Suffix Max",
    "url": "https://codeforces.com/problemset/problem/2123/C",
    "description": "You are given an array aaa of distinct integers.In one operation, you may either:   choose a nonempty prefix∗^{\\text{∗}} of aa and replace it with its minimum value, or  choose a nonempty suffix†^{\\text{†}} of aa and replace it with its maximum value. Note that you may choose the entire array aa.For each element aia_i, determine if there exists some sequence of operations to transform aa into [ai][a_i]; that is, make the array aa consist of only one element, which is aia_i. Output your answer as a binary string of length nn, where the ii-th character is 11 if there exists a sequence to transform aa into [ai][a_i], and 00 otherwise.∗^{\\text{∗}}A prefix of an array is a subarray consisting of the first kk elements of the array, for some integer kk.†^{\\text{†}}A suffix of an array is a subarray consisting of the last kk elements of the array, for some integer kk."
  },
  {
    "title": "Tournament",
    "url": "https://codeforces.com/problemset/problem/2123/B",
    "description": "You are given an array of integers a1,a2,…,ana_1,a_2,\\dots,a_n. A tournament is held with nn players. Player ii has strength aia_i.While more than kk players remain,   Two remaining players are chosen at random;  Then the chosen player with the lower strength is eliminated. If the chosen players have the same strength, one is eliminated at random. Given integers jj and kk (1≤j,k≤n1 \\leq j,k \\leq n), determine if there is any way for player jj to be one of the last kk remaining players."
  },
  {
    "title": "Blackboard Game",
    "url": "https://codeforces.com/problemset/problem/2123/A",
    "description": "Initially, the integers from 00 to n−1n-1 are written on a blackboard.In one round,   Alice chooses an integer aa on the blackboard and erases it;  then Bob chooses an integer bb on the blackboard such that a+b≡3(mod4)a+b \\equiv 3 \\pmod 4∗^{\\text{∗}} and erases it. Rounds take place in succession until a player is unable to make a move — the first player who is unable to make a move loses. Determine who wins with optimal play. ∗^{\\text{∗}}We define that x≡y(modm)x\\equiv y\\pmod m whenever x−yx-y is an integer multiple of mm."
  },
  {
    "title": "Tree Parking",
    "url": "https://codeforces.com/problemset/problem/2122/G",
    "description": " Consider the following problem statement: You are given a tree with nnn vertices rooted at 11. For each 1≤i≤n1 \\leq i \\leq n, a car will enter the root at time lil_i. It will then instantaneously travel from the root to vertex ii through the unique simple path and park there. It will leave through the same path in the other direction at time rir_i.During the time when a car is parked in a vertex, it blocks other cars from traveling through that vertex. The tree is called valid if and only if all cars are able to enter and leave the tree at their desired times.Count the number of pairs of sequences ll, rr such that li<ril_i < r_i, their concatenation is a permutation of 1…2n1 \\ldots 2n, and the tree is valid. Calculate the sum of the answers to the problem over all labeled trees∗^{\\text{∗}} with nn vertices and kk leaves. The root is not considered a leaf. Since the answer may be large, calculate it modulo 998244353998\\,244\\,353.∗^{\\text{∗}}Two labeled trees are considered different if and only if their edge sets are different."
  },
  {
    "title": "Colorful Polygon",
    "url": "https://codeforces.com/problemset/problem/2122/F",
    "description": "You are given an array a1,a2,…,ana1,a2,…,ana_1, a_2, \\ldots, a_n, where n≤8n \\leq 8 and a1+a2+⋯+an≤100a_1 + a_2 + \\cdots + a_n \\leq 100.Construct a simple polygon∗^{\\text{∗}} with at most 333333 vertices that has exactly (a1+a2+⋯+an)!a1!a2!⋯an!\\frac{(a_1 + a_2 + \\cdots + a_n)!}{a_1! a_2! \\cdots a_n!} different triangulations†^{\\text{†}}. It can be proven that such a polygon always exists.∗^{\\text{∗}}A simple polygon is a polygon that does not intersect itself and has no holes. In other words, no two non-consecutive edges can have common points, and consecutive edges must have exactly one common point — the vertex between them. Consecutive edges may be collinear.†^{\\text{†}}A triangulation of a polygon with mm vertices is a set of m−3m-3 diagonals that intersect only at vertices. A diagonal is a segment between two vertices which lies inside the polygon and has exactly two common points with the polygon sides — the vertices it connects."
  },
  {
    "title": "Greedy Grid Counting",
    "url": "https://codeforces.com/problemset/problem/2122/E",
    "description": "A path in a grid is called greedy if it starts at the top-left cell and moves only to the right or downward, always moving to its neighbor with the greater value (or either if the values are equal).The value of a path is the sum of the values of the cells it visits, including the start and end.Given a partially filled 2×n2×n2 \\times n grid of integers between 11 and kk, count the number of ways to fill the empty cells such that in every subgrid∗^{\\text{∗}}, there exists a greedy path that achieves the maximum value out of all down/right paths. Since the answer may be large, calculate it modulo 998244353998\\,244\\,353.∗^{\\text{∗}} A subgrid of a 2×n2 \\times n grid ai,ja_{i,j} is a grid formed from all cells ax,ya_{x,y} such that lx≤x≤rxl_x \\leq x \\leq r_x, ly≤y≤ryl_y \\leq y \\leq r_y for some 1≤lx≤rx≤21 \\leq l_x \\leq r_x \\leq 2, 1≤ly≤ry≤n1 \\leq l_y \\leq r_y \\leq n. "
  },
  {
    "title": "Traffic Lights",
    "url": "https://codeforces.com/problemset/problem/2122/D",
    "description": " You are given a simple undirected connected graph of nn vertices and mm edges.There is a token in vertex 11. We consider the initial time to be at 00 seconds. After tt seconds, if the token is in vertex uu, you must do exactly one of the following:  wait one second,  move the token through the (tmoddeg(u)+1)(t \\bmod \\mathrm{deg}(u) + 1)∗^{\\text{∗}}-th edge of uu, which takes one second. The order of edges of a vertex is the order that they appear in the input.Calculate the minimum time required to move the token from vertex 11 to vertex nn, and the minimum time spent waiting that can be achieved while minimizing the total time.∗^{\\text{∗}}xmodyx \\bmod y denotes the remainder from dividing xx by yy. "
  },
  {
    "title": "Manhattan Pairs",
    "url": "https://codeforces.com/problemset/problem/2122/C",
    "description": " You are given nnn points (xi,yi)(x_i, y_i) on a 2D plane, where nn is even. Select n2\\tfrac{n}{2} disjoint pairs (ai,bi)(a_i, b_i) to maximize the sum of Manhattan distances between points in pairs. In other words, maximize n/2∑i=1|xai−xbi|+|yai−ybi|.\\sum_{i=1}^{n/2} |x_{a_i} - x_{b_i}| + |y_{a_i} - y_{b_i}|."
  },
  {
    "title": "Pile Shuffling",
    "url": "https://codeforces.com/problemset/problem/2122/B",
    "description": " You are given nn binary piles, the ii-th of which consists of aia_i zeros on the top and bib_i ones on the bottom.In one operation, you can take the top element of any pile and move it to any position in any pile, including the pile it was taken from.     Solution of the first example test case.  Calculate the minimum number of operations required to make it so that the ii-th pile consists of cic_i zeros on the top and did_i ones on the bottom."
  },
  {
    "title": "Greedy Grid",
    "url": "https://codeforces.com/problemset/problem/2122/A",
    "description": "A path in a grid is called greedy if it starts at the top-left cell and moves only to the right or downward, always moving to its neighbor with the greater value (or either if the values are equal).The value of a path is the sum of the values of the cells it visits, including the start and end.Does there exist an n×mn \\times m grid of nonnegative integers such that no greedy path achieves the maximum value among all down/right paths?"
  },
  {
    "title": "Ice Baby",
    "url": "https://codeforces.com/problemset/problem/2121/H",
    "description": "The longest non-decreasing subsequence of an array of integers a1,a2,…,ana1,a2,…,ana_1, a_2, \\ldots, a_n is the longest sequence of indices 1≤i1<i2<…<ik≤n1 \\leq i_1 < i_2 < \\ldots < i_k \\leq n such that ai1≤ai2≤…≤aika_{i_1} \\leq a_{i_2} \\leq \\ldots \\leq a_{i_k}. The length of the sequence is defined as the number of elements in the sequence. For example, the length of the longest non-decreasing subsequence of the array a=[3,1,4,1,2]a = [3, 1, 4, 1, 2] is 33.You are given two arrays of integers l1,l2,…,lnl_1, l_2, \\ldots, l_n and r1,r2,…,rnr_1, r_2, \\ldots, r_n. For each 1≤k≤n1 \\le k \\le n, solve the following problem: Consider all arrays of integers aa of length kk, such that for each 1≤i≤k1 \\leq i \\leq k, it holds that li≤ai≤ril_i \\leq a_i \\leq r_i. Find the maximum length of the longest non-decreasing subsequence among all such arrays."
  },
  {
    "title": "Gangsta",
    "url": "https://codeforces.com/problemset/problem/2121/G",
    "description": "You are given a binary string s1s2…sns1s2…sns_1s_2 \\ldots s_n of length nn. A string ss is called binary if it consists only of zeros and ones.For a string pp, we define the function f(p)f(p) as the maximum number of occurrences of any character in the string pp. For example, f(00110)=3f(00110) = 3, f(01)=1f(01) = 1.You need to find the sum f(slsl+1…sr)f(s_ls_{l+1} \\ldots s_r) for all pairs 1≤l≤r≤n1 \\leq l \\leq r \\leq n."
  },
  {
    "title": "Yamakasi",
    "url": "https://codeforces.com/problemset/problem/2121/F",
    "description": "You are given an array of integers a1,a2,…,ana_1, a_2, \\ldots, a_n and two integers ss and xx. Count the number of subsegments of the array whose sum of elements equals ss and whose maximum value equals xx.More formally, count the number of pairs 1≤l≤r≤n1 \\leq l \\leq r \\leq n such that: al+al+1+…+ar=sa_l + a_{l + 1} + \\ldots + a_r = s.  max(al,al+1,…,ar)=x\\max(a_l, a_{l + 1}, \\ldots, a_r) = x. "
  },
  {
    "title": "Sponsor of Your Problems",
    "url": "https://codeforces.com/problemset/problem/2121/E",
    "description": "For two integers aaa and bbb, we define f(a,b)f(a,b)f(a, b) as the number of positions in the decimal representation of the numbers aaa and bbb where their digits are the same. For example, f(12,21)=0f(12,21)=0f(12, 21) = 0, f(31,37)=1f(31,37)=1f(31, 37) = 1, f(19891,18981)=2f(19891,18981)=2f(19891, 18981) = 2, f(54321,24361)=3f(54321,24361)=3f(54321, 24361) = 3.You are given two integers lll and rrr of the same length in decimal representation. Consider all integers l≤x≤rl≤x≤rl \\leq x \\leq r. Your task is to find the minimum value of f(l,x)+f(x,r)f(l,x)+f(x,r)f(l, x) + f(x, r)."
  },
  {
    "title": "1709",
    "url": "https://codeforces.com/problemset/problem/2121/D",
    "description": "You are given two arrays of integers a1,a2,…,ana1,a2,…,ana_1, a_2, \\ldots, a_n and b1,b2,…,bnb1,b2,…,bnb_1, b_2, \\ldots, b_n. It is guaranteed that each integer from 111 to 2⋅n2⋅n2 \\cdot n appears in exactly one of the arrays.You need to perform a certain number of operations (possibly zero) so that both of the following conditions are satisfied: For each 1≤i<n1≤i<n1 \\leq i < n, it holds that ai<ai+1ai<ai+1a_i < a_{i + 1} and bi<bi+1bi<bi+1b_i < b_{i + 1}.  For each 1≤i≤n1≤i≤n1 \\leq i \\leq n, it holds that ai<biai<bia_i < b_i. During each operation, you can perform exactly one of the following three actions: Choose an index 1≤i<n1≤i<n1 \\leq i < n and swap the values aiaia_i and ai+1ai+1a_{i + 1}.  Choose an index 1≤i<n1≤i<n1 \\leq i < n and swap the values bibib_i and bi+1bi+1b_{i + 1}. Choose an index 1≤i≤n1≤i≤n1 \\leq i \\leq n and swap the values aiaia_i and bibib_i.You do not need to minimize the number of operations, but the total number must not exceed 170917091709. Find any sequence of operations that satisfies both conditions."
  },
  {
    "title": "Those Who Are With Us",
    "url": "https://codeforces.com/problemset/problem/2121/C",
    "description": "You are given a matrix of integers with nnn rows and mmm columns. The cell at the intersection of the iii-th row and the jjj-th column contains the number aijaija_{ij}.You can perform the following operation exactly once: Choose two numbers 1≤r≤n1≤r≤n1 \\leq r \\leq n and 1≤c≤m1≤c≤m1 \\leq c \\leq m. For all cells (i,j)(i,j)(i, j) in the matrix such that i=ri=ri = r or j=cj=cj = c, decrease aijaija_{ij} by one.You need to find the minimal possible maximum value in the matrix aaa after performing exactly one such operation."
  },
  {
    "title": "Above the Clouds",
    "url": "https://codeforces.com/problemset/problem/2121/B",
    "description": "You are given a string sss of length nnn, consisting of lowercase letters of the Latin alphabet. Determine whether there exist three non-empty strings aaa, bbb, and ccc such that: a+b+c=sa+b+c=sa + b + c = s, meaning the concatenation∗∗^{\\text{∗}} of strings aaa, bbb, and ccc equals sss. The string bbb is a substring††^{\\text{†}} of the string a+ca+ca + c, which is the concatenation of strings aaa and ccc. ∗∗^{\\text{∗}}Concatenation of strings aaa and bbb is defined as the string a+b=a1a2…apb1b2…bqa+b=a1a2…apb1b2…bqa + b = a_1a_2 \\ldots a_pb_1b_2 \\ldots b_q, where ppp and qqq are the lengths of strings aaa and bbb, respectively. For example, the concatenation of the strings \"code\" and \"forces\" is \"codeforces\". ††^{\\text{†}}A string aaa is a substring of a string bbb if aaa can be obtained from bbb by the deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end. "
  },
  {
    "title": "Letter Home",
    "url": "https://codeforces.com/problemset/problem/2121/A",
    "description": "You are given an array of distinct integers x1,x2,…,xnx1,x2,…,xnx_1, x_2, \\ldots, x_n and an integer sss. Initially, you are at position pos=spos=spos = s on the XXX axis. In one step, you can perform exactly one of the following two actions: Move from position pospospos to position pos+1pos+1pos + 1.  Move from position pospospos to position pos−1pos−1pos - 1. A sequence of steps will be considered successful if, during the entire journey, you visit each position xixix_i on the XXX axis at least once. Note that the initial position pos=spos=spos = s is also considered visited. Your task is to determine the minimum number of steps in any successful sequence of steps."
  },
  {
    "title": "Eulerian Line Graph",
    "url": "https://codeforces.com/problemset/problem/2120/G",
    "description": " Aryan loves graph theory more than anything. Well, no, he likes to flex his research paper on line graphs to everyone more. To start a conversation with you, he decides to give you a problem on line graphs. In the mathematical discipline of graph theory, the line graph of a simple undirected graph GG is another simple undirected graph L(G)L(G) that represents the adjacency between every two edges in GG.Precisely speaking, for an undirected graph GG without self-loops or multiple edges, its line graph L(G)L(G) is a graph such that  Each vertex of L(G)L(G) represents an edge of GG.  Two vertices of L(G)L(G) are adjacent if and only if their corresponding edges share a common endpoint in GG.   Also, L0(G)=GL^0(G)=G and Lk(G)=L(Lk−1(G))L^k(G)=L(L^{k-1}(G)) for k≥1k\\geq 1. An Euler trail is a sequence of edges that visits every edge of the graph exactly once. This trail can be either a path (starting and ending at different vertices) or a cycle (starting and ending at the same vertex). Vertices may be revisited during the trail, but each edge must be used exactly once.Aryan gives you a simple connected graph GG with nn vertices and mm edges and an integer kk, and it is guaranteed that GG has an Euler trail and it is not a path graph∗^{\\text{∗}}. He asks you to determine if Lk(G)L^k(G) has an Euler trail. ∗^{\\text{∗}}A path graph is a tree where every vertex is connected to atmost two other vertices."
  },
  {
    "title": "Superb Graphs",
    "url": "https://codeforces.com/problemset/problem/2120/F",
    "description": " As we all know, Aryan is a funny guy. He decides to create fun graphs. For a graph GG, he defines fun graph G′G' of GG as follows:  Every vertex v′v' of G′G' maps to a non-empty independent set∗^{\\text{∗}} or clique†^{\\text{†}} in GG.  The sets of vertices of GG that the vertices of G′G' map to are pairwise disjoint and combined cover all the vertices of GG, i.e., the sets of vertices of GG mapped by vertices of G′G' form a partition of the vertex set of GG.  If an edge connects two vertices v′1v_1' and v′2v_2' in G′G', then there is an edge between every vertex of GG in the set mapped to v′1v_1' and every vertex of GG in the set mapped to v′2v_2'.  If an edge does not connect two vertices v′1v_1' and v′2v_2' in G′G', then there is not an edge between any vertex of GG in the set mapped to v′1v_1' and any vertex of GG in the set mapped to v′2v_2'. As we all know again, Harshith is a superb guy. He decides to use fun graphs to create his own superb graphs. For a graph GG, a fun graph G″G' ' is called a superb graph of GG if G″G' ' has the minimum number of vertices among all possible fun graphs of GG.Aryan gives Harshith kk simple undirected graphs‡^{\\text{‡}} G1,G2,…,GkG_1, G_2,\\ldots,G_k, all on the same vertex set VV. Harshith then wonders if there exist kk other graphs H1,H2,…,HkH_1, H_2,\\ldots,H_k, all on some other vertex set V′V' such that:  GiG_i is a superb graph of HiH_i for all i∈{1,2,…,k}i\\in \\{1,2,\\ldots,k\\}.  If a vertex v∈Vv\\in V maps to an independent set of size greater than 11 in one Gi,HiG_i, H_i (1≤i≤k1\\leq i\\leq k) pair, then there exists no pair Gj,HjG_j, H_j (1≤j≤k,j≠i1\\leq j\\leq k, j\\neq i) where vv maps to a clique of size greater than 11. Help Harshith solve his wonder.∗^{\\text{∗}}For a graph GG, a subset SS of vertices is called an independent set if no two vertices of SS are connected with an edge.†^{\\text{†}}For a graph GG, a subset SS of vertices is called a clique if every vertex of SS is connected to every other vertex of SS with an edge.‡^{\\text{‡}}A graph is a simple undirected graph if its edges are undirected and there are no self-loops or multiple edges between the same pair of vertices."
  },
  {
    "title": "Lanes of Cars",
    "url": "https://codeforces.com/problemset/problem/2120/E",
    "description": "Harshith is the president of TollClub. He tasks his subordinate Aryan to oversee a toll plaza with nn lanes. Initially, the ii-th lane has aia_i cars waiting in a queue. Exactly one car from the front of each lane passes through the toll every second.The angriness of a car is defined as the number of seconds it had to wait before passing through the toll. Consider it takes 1 sec for each car to pass the toll, i.e., the first car in a lane has angriness 11, the second car has angriness 22, and so on.To reduce congestion and frustration, cars are allowed to switch lanes. A car can instantly move to the back of any other lane at any time. However, changing lanes increases its angriness by an additional kk units due to the confusion caused by the lane change.Harshith, being the awesome person he is, wants to help the drivers by minimising the total angriness of all cars. He asks Aryan to do so or get fired. Aryan is allowed to change lanes of any car anytime (possibly zero), but his goal is to find the minimum possible total angriness if the lane changes are done optimally. Help Aryan retain his job by determining the minimum angriness he can achieve."
  },
  {
    "title": "Matrix game",
    "url": "https://codeforces.com/problemset/problem/2120/D",
    "description": "Aryan and Harshith play a game. They both start with three integers aa, bb, and kk. Aryan then gives Harshith two integers nn and mm. Harshith then gives Aryan a matrix XX with nn rows and mm columns, such that each of the elements of XX is between 11 and kk(inclusive). After that, Aryan wins if he can find a submatrix∗^{\\text{∗}} YY of XX with aa rows and bb columns such that all elements of YY are equal.For example, when a=2,b=2,k=6,n=3a=2, b=2, k=6, n=3 and m=3m=3, if Harshith gives Aryan the matrix below, it is a win for Aryan as it has a submatrix of size 2×22\\times 2 with all elements equal to 11 as shown below.  Example of a matrix where Aryan wins Aryan gives you the values of aa, bb, and kk. He asks you to find the lexicographically minimum tuple (n,m)(n,m) that he should give to Harshith such that Aryan always wins. Help Aryan win the game. Assume that Harshith plays optimally. The values of nn and mm can be large, so output them modulo 109+710^9+7. A tuple (n1,m1)(n_1, m_1) is said to be lexicographically smaller than (n2,m2)(n_2, m_2) if either n1<n2n_1<n_2 or n1=n2n_1=n_2 and m1<m2m_1<m_2.∗^{\\text{∗}}A submatrix of a matrix is obtained by removing some rows and/or columns from the original matrix."
  },
  {
    "title": "Divine Tree",
    "url": "https://codeforces.com/problemset/problem/2120/C",
    "description": "  Harshith attained enlightenment in Competitive Programming by training under a Divine Tree. A divine tree is a rooted tree∗^{\\text{∗}} with nn nodes, labelled from 11 to nn. The divineness of a node vv, denoted d(v)d(v), is defined as the smallest node label on the unique simple path from the root to node vv.Aryan, being a hungry Competitive Programmer, asked Harshith to pass on the knowledge. Harshith agreed on the condition that Aryan would be given two positive integers nn and mm, and he had to construct a divine tree with nn nodes such that the total divineness of the tree is mm, i.e., n∑i=1d(i)=m\\displaystyle\\sum\\limits_{i=1}^n d(i)=m. If no such tree exists, Aryan must report that it is impossible.Desperate for knowledge, Aryan turned to you for help in completing this task. As a good friend of his, help him solve the task.∗^{\\text{∗}}A tree is a connected graph without cycles.  A rooted tree is a tree where one vertex is special and called the root. "
  },
  {
    "title": "Square Pool",
    "url": "https://codeforces.com/problemset/problem/2120/B",
    "description": "Aryan and Harshith are playing pool in universe AX120 on a fixed square pool table of side sss with pockets at its 444 corners. The corners are situated at (0,0)(0,0)(0,0), (0,s)(0,s)(0,s), (s,0)(s,0)(s,0), and (s,s)(s,s)(s,s). In this game variation, nnn identical balls are placed on the table with integral coordinates such that no ball lies on the edge or corner of the table. Then, they are all simultaneously shot at 101001010010^{100} units/sec speed (only at 454545 degrees with the axes).In universe AX120, balls and pockets are almost point-sized, and the collisions are elastic, i.e., the ball, on hitting any surface, bounces off at the same angle and with the same speed.  Harshith shot the balls, and he provided Aryan with the balls' positions and the angles at which he shot them. Help Aryan determine the number of balls potted into the pockets by Harshith.It is guaranteed that multiple collisions do not occur at the same moment and position."
  },
  {
    "title": "Square of Rectangles",
    "url": "https://codeforces.com/problemset/problem/2120/A",
    "description": "Aryan is an ardent lover of squares but a hater of rectangles (Yes, he knows all squares are rectangles). But Harshith likes to mess with Aryan. Harshith gives Aryan three rectangles of sizes l1×b1l_1\\times b_1, l2×b2l_2\\times b_2, and l3×b3l_3\\times b_3 such that l3≤l2≤l1l_3\\leq l_2\\leq l_1 and b3≤b2≤b1b_3\\leq b_2\\leq b_1. Aryan, in order to defeat Harshith, decides to arrange these three rectangles to form a square such that no two rectangles overlap and the rectangles are aligned along edges. Rotating rectangles is not allowed. Help Aryan determine if he can defeat Harshith."
  },
  {
    "title": "Volcanic Eruptions",
    "url": "https://codeforces.com/problemset/problem/2119/F",
    "description": "There is an undirected tree with root 111 where each vertex has a weight wi∈{1,−1}w_i\\in\\{1,-1\\}.A volcano at the root erupts at time 00. At time tt, lava floods all vertices whose distance from the root is at most tt, where the distance is the number of edges in the shortest path between the two vertices.At time 00, you are at vertex stst with life value SS, initially S=1S=1. Starting at time 00 (including time 00), the following events happen in order at each time stamp:   Let uu be the vertex you are currently at. Your life value increases by wuw_u, i.e., S←S+wuS\\gets S+w_u.  If S=0S=0 or if vertex uu is flooded with lava at this time, you die immediately.  You must move to an adjacent vertex (includes father and sons; staying in place is not allowed). You arrive at the chosen vertex at the next time stamp. Find the maximum number of moves you can make before you die."
  },
  {
    "title": "And Constraint",
    "url": "https://codeforces.com/problemset/problem/2119/E",
    "description": "wowaka & Hatsune Miku - Tosenbo You are given a sequence aa of length n−1n-1 and a sequence bb of length nn. You can perform the following operation any number of times (possibly zero):  choose an index 1≤i≤n1 \\le i \\le n and increment bib_i by 11 (i.e., set bi←bi+1b_i \\leftarrow b_i + 1). Your goal is to perform the minimum number of operations such that for every 1≤i≤n−11 \\le i \\le n-1, the condition bi&bi+1=aib_i \\, \\& \\, b_{i+1} = a_i holds, where &\\& denotes the bitwise AND operation. If it is impossible to satisfy the condition, report it as well."
  },
  {
    "title": "Token Removing",
    "url": "https://codeforces.com/problemset/problem/2119/D",
    "description": "r-906 & Hatsune Miku - All I Can See Is You Define a sequence of integers aa valid if and only if ∀1≤i≤n,0≤ai≤i\\forall 1 \\le i \\le n, 0 \\le a_i \\le i.Define the weight f(a)f(a) of a valid sequence aa of length nn:  Initially, a token is placed at each integer point in the closed segment [1,n][1, n] on the number axis.  Perform nn operations in sequence. During the ii-th operation, if ai≠0a_i \\ne 0, remove a token in the closed segment [ai,i][a_i, i] that has not been removed; otherwise, do nothing.  f(a)f(a) is the number of ways to remove tokens. Two ways are considered different if there exists a tt such that the positions of the tokens removed by the two ways are different at the tt-th operation. For example, f([0,2,1])=2f([0, 2, 1]) = 2, because we can remove tokens on 2,12, 1 or 2,32, 3 in sequence.JT gives you two integers n,mn, m and asks you to find the sum of the weights over all (n+1)!(n + 1)! valid sequences of length nn. Since the answer may be too large, print it modulo mm."
  },
  {
    "title": "A Good Problem",
    "url": "https://codeforces.com/problemset/problem/2119/C",
    "description": " Juggernaut. - Lost Dream feat.星名はる You are given four positive integers n,l,r,kn, l, r, k. You need to find the lexicographically smallest∗^{\\text{∗}} array aa of length nn, consisting of integers, such that:  For every 1≤i≤n1 \\leq i \\leq n, l≤ai≤rl \\leq a_i \\leq r.  a1&a2&…&an=a1⊕a2⊕…⊕ana_1 \\, \\& \\, a_2 \\, \\& \\, \\ldots \\, \\& \\, a_n = a_1 \\oplus a_2 \\oplus \\ldots \\oplus a_n, where &\\& denotes the bitwise AND operation and ⊕\\oplus denotes the bitwise XOR operation. If no such array exists, output −1-1. Otherwise, since the entire array might be too large to output, output aka_k only.∗^{\\text{∗}}An array aa is lexicographically smaller than an array bb if and only if one of the following holds:   aa is a prefix of bb, but a≠ba \\ne b; or  in the first position where aa and bb differ, the array aa has a smaller element than the corresponding element in bb.  "
  },
  {
    "title": "Line Segments",
    "url": "https://codeforces.com/problemset/problem/2119/B",
    "description": "PIKASONIC - Lost My Mind (feat.nakotanmaru) You are given two points (px,py)(p_x,p_y) and (qx,qy)(q_x,q_y) on a Euclidean plane.You start at the starting point (px,py)(p_x,p_y) and will perform nn operations. In the ii-th operation, you must choose any point such that the Euclidean distance∗^{\\text{∗}} between your current position and the point is exactly aia_i, and then move to that point.Determine whether it is possible to reach the terminal point (qx,qy)(q_x,q_y) after performing all operations.∗^{\\text{∗}}The Euclidean distance between (x1,y1)(x_1, y_1) and (x2,y2)(x_2, y_2) is √(x1−x2)2+(y1−y2)2\\sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2}"
  },
  {
    "title": "Add or XOR",
    "url": "https://codeforces.com/problemset/problem/2119/A",
    "description": "r-906 & IA AI - Psychologic Disco You are given two non-negative integers a,ba, b. You can apply two types of operations on aa any number of times and in any order:  a←a+1a \\gets a + 1. The cost of this operation is xx;  a←a⊕1a \\gets a \\oplus 1, where ⊕\\oplus denotes the bitwise XOR operation. The cost of this operation is yy. Now you are asked to make a=ba = b. If it's possible, output the minimum cost; otherwise, report it."
  },
  {
    "title": "Shifts and Swaps",
    "url": "https://codeforces.com/problemset/problem/2118/F",
    "description": "You are given arrays aa and bb of length nn and an integer mm. The arrays only contain integers from 11 to mm, and both arrays contain all integers from 11 to mm.You may repeatedly perform either of the following operations on aa:   cyclic shift∗^{\\text{∗}} the array to the left  swap two neighboring elements if their difference is at least 22. Is it possible to transform the first array into the second?∗^{\\text{∗}}A left cyclic shift of a zero-indexed array pp of length nn is an array qq such that qi=p(i+1)modnq_i = p_{(i + 1) \\bmod n} for all 0≤i<n0 \\le i < n."
  },
  {
    "title": "Grid Coloring",
    "url": "https://codeforces.com/problemset/problem/2118/E",
    "description": "There is a n×mn\\times m grid with each cell initially white. You have to color all the cells one-by-one. After you color a cell, all the colored cells furthest from it receive a penalty. Find a coloring order, where no cell has more than 33 penalties.Note that nn and mm are both odd.The distance metric used is the chessboard distance while we decide ties between cells with Manhattan distance. Formally, a cell (x2,y2)(x_2, y_2) is further away than (x3,y3)(x_3, y_3) from a cell (x1,y1)(x_1, y_1) if one of the following holds:   max(|x1−x2|,|y1−y2|)>max(|x1−x3|,|y1−y3|)\\max\\big(\\lvert x_1 - x_2 \\rvert, \\lvert y_1 - y_2 \\rvert\\big)>\\max\\big(\\lvert x_1 - x_3 \\rvert, \\lvert y_1 - y_3 \\rvert\\big)  max(|x1−x2|,|y1−y2|)=max(|x1−x3|,|y1−y3|)\\max\\big(\\lvert x_1 - x_2 \\rvert, \\lvert y_1 - y_2 \\rvert\\big)=\\max\\big(\\lvert x_1 - x_3 \\rvert, \\lvert y_1 - y_3 \\rvert\\big) and |x1−x2|+|y1−y2|>|x1−x3|+|y1−y3|\\lvert x_1 - x_2 \\rvert + \\lvert y_1 - y_2 \\rvert>\\lvert x_1 - x_3 \\rvert + \\lvert y_1 - y_3 \\rvert It can be proven that at least one solution always exists.    Example showing penalty changes after coloring the center of a 5×55 \\times 5 grid. The numbers indicate the penalty of the cells.  "
  },
  {
    "title": "Red Light, Green Light (Hard version)",
    "url": "https://codeforces.com/problemset/problem/2118/D2",
    "description": "This is the hard version of the problem. The only difference is the constraint on kk and the total sum of nn and qq across all test cases. You can make hacks only if both versions of the problem are solved.You are given a strip of length 101510^{15} and a constant kk. There are exactly nn cells that contain a traffic light; each has a position pip_i and an initial delay did_i for which di<kd_i < k. The ii-th traffic light works the following way:   it shows red at the l⋅k+dil \\cdot k + d_i-th second, where ll is an integer,  it shows green otherwise. At second 00, you are initially positioned at some cell on the strip, facing the positive direction. At each second, you perform the following actions in order:   If the current cell contains a red traffic light, you turn around.  Move one cell in the direction you are currently facing. You are given qq different starting positions. For each one, determine whether you will eventually leave the strip within 1010010^{100} seconds."
  },
  {
    "title": "Red Light, Green Light (Easy version)",
    "url": "https://codeforces.com/problemset/problem/2118/D1",
    "description": "This is the easy version of the problem. The only difference is the constraint on kk and the total sum of nn and qq across all test cases. You can make hacks only if both versions of the problem are solved.You are given a strip of length 101510^{15} and a constant kk. There are exactly nn cells that contain a traffic light; each has a position pip_i and an initial delay did_i for which di<kd_i < k. The ii-th traffic light works the following way:   it shows red at the l⋅k+dil \\cdot k + d_i-th second, where ll is an integer,  it shows green otherwise. At second 00, you are initially positioned at some cell on the strip, facing the positive direction. At each second, you perform the following actions in order:   If the current cell contains a red traffic light, you turn around.  Move one cell in the direction you are currently facing. You are given qq different starting positions. For each one, determine whether you will eventually leave the strip within 1010010^{100} seconds."
  },
  {
    "title": "Make It Beautiful",
    "url": "https://codeforces.com/problemset/problem/2118/C",
    "description": "You are given an array aaa of nn integers. We define the beauty\\text{beauty} of a number xx to be the number of 11 bits in its binary representation. We define the beauty of an array to be the sum of beauties of the numbers it contains. In one operation, you can select an index ii (1≤i≤n)(1 \\le i \\le n) and increase aia_i by 11. Find the maximum beauty of the array after doing at most kk operations."
  },
  {
    "title": "Make It Permutation",
    "url": "https://codeforces.com/problemset/problem/2118/B",
    "description": "There is a matrix AA of size n×nn\\times n where Ai,j=jA_{i,j}=j for all 1≤i,j≤n1 \\le i,j \\le n. In one operation, you can select a row and reverse any subarray∗^{\\text{∗}} in it. Find a sequence of at most 2n2n operations such that every column will contain a permutation†^{\\text{†}} of length nn.It can be proven that the construction is always possible. If there are multiple solutions, output any of them.∗^{\\text{∗}}An array aa is a subarray of an array bb if aa can be obtained from bb by deleting zero or more elements from the beginning and zero or more elements from the end.†^{\\text{†}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array)."
  },
  {
    "title": "Equal Subsequences",
    "url": "https://codeforces.com/problemset/problem/2118/A",
    "description": "We call a bitstring∗^{\\text{∗}} perfect if it has the same number of 101\\mathtt{101} and 010\\mathtt{010} subsequences†^{\\text{†}}. Construct a perfect bitstring of length nn where the number of 1\\mathtt{1} characters it contains is exactly kk.It can be proven that the construction is always possible. If there are multiple solutions, output any of them.∗^{\\text{∗}}A bitstring is a string consisting only of the characters 0\\mathtt{0} and 1\\mathtt{1}.†^{\\text{†}}A sequence aa is a subsequence of a string bb if aa can be obtained from bb by the deletion of several (possibly zero or all) characters."
  },
  {
    "title": "Incessant Rain",
    "url": "https://codeforces.com/problemset/problem/2117/H",
    "description": "Note the unusual memory limit.Silver Wolf gives you an array aa of length nn and qq queries. In each query, she replaces an element in aa. After each query, she asks you to output the maximum integer kk such that there exists an integer xx such that it is the kk-majority of a subarray∗^{\\text{∗}} of aa.An integer yy is the kk-majority of array bb if yy appears at least ⌊|b|+12⌋+k\\lfloor \\frac{|b|+1}{2} \\rfloor +k times in bb, where |b||b| represents the length of bb. Note that bb may not necessarily have a kk-majority.∗^{\\text{∗}}An array bb is a subarray of an array aa if bb can be obtained from aa by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end."
  },
  {
    "title": "Omg Graph",
    "url": "https://codeforces.com/problemset/problem/2117/G",
    "description": "You are given an undirected connected weighted graph. Define the cost of a path of length kk to be as follows:  Let the weights of all the edges on the path be w1,...,wkw_1,...,w_k.  The cost of the path is (minki=1wi)+(maxki=1wi)(\\min_{i = 1}^{k}{w_i}) + (\\max_{i=1}^{k}{w_i}), or in other words, the maximum edge weight + the minimum edge weight. Across all paths from vertex 11 to nn, report the cost of the path with minimum cost. Note that the path is not necessarily simple."
  },
  {
    "title": "Wildflower",
    "url": "https://codeforces.com/problemset/problem/2117/F",
    "description": "Yousef has a rooted tree∗^{\\text{∗}} consisting of exactly nn vertices, which is rooted at vertex 11. You would like to give Yousef an array aa of length nn, where each aia_i (1≤i≤n)(1 \\le i \\le n) can either be 11 or 22.Let sus_u denote the sum of ava_v where vertex vv is in the subtree†^{\\text{†}} of vertex uu. Yousef considers the tree special if all the values in ss are pairwise distinct (i.e., all subtree sums are unique).Your task is to help Yousef count the number of different arrays aa that result in the tree being special. Two arrays bb and cc are different if there exists an index ii such that bi≠cib_i \\neq c_i.As the result can be very large, you should print it modulo 109+710^9 + 7.∗^{\\text{∗}}A tree is a connected undirected graph with n−1n - 1 edges.†^{\\text{†}}The subtree of a vertex vv is the set of all vertices that pass through vv on a simple path to the root. Note that vertex vv is also included in the set."
  },
  {
    "title": "Lost Soul",
    "url": "https://codeforces.com/problemset/problem/2117/E",
    "description": "You are given two integer arrays aaa and bbb, each of length nnn.You may perform the following operation any number of times:   Choose an index iii (1≤i≤n−1)(1≤i≤n−1)(1 \\le i \\le n - 1), and set ai:=bi+1ai:=bi+1a_i := b_{i + 1}, or set bi:=ai+1bi:=ai+1b_i := a_{i + 1}. Before performing any operations, you are allowed to choose an index iii (1≤i≤n)(1≤i≤n)(1 \\le i \\le n) and remove both aiaia_i and bibib_i from the arrays. This removal can be done at most once.Let the number of matches between two arrays ccc and ddd of length mmm be the number of positions jjj (1≤j≤m)(1≤j≤m)(1 \\le j \\le m) such that cj=djcj=djc_j = d_j.Your task is to compute the maximum number of matches you can achieve."
  },
  {
    "title": "Retaliation",
    "url": "https://codeforces.com/problemset/problem/2117/D",
    "description": "Yousef wants to explode an array a1,a2,…,ana_1, a_2, \\dots, a_n. An array gets exploded when all of its elements become equal to zero.In one operation, Yousef can do exactly one of the following:   For every index ii in aa, decrease aia_i by ii.  For every index ii in aa, decrease aia_i by n−i+1n - i + 1. Your task is to help Yousef determine if it is possible to explode the array using any number of operations."
  },
  {
    "title": "Cool Partition",
    "url": "https://codeforces.com/problemset/problem/2117/C",
    "description": "Yousef has an array aa of size nn. He wants to partition the array into one or more contiguous segments such that each element aia_i belongs to exactly one segment.A partition is called cool if, for every segment bjb_j, all elements in bjb_j also appear in bj+1b_{j + 1} (if it exists). That is, every element in a segment must also be present in the segment following it.For example, if a=[1,2,2,3,1,5]a = [1, 2, 2, 3, 1, 5], a cool partition Yousef can make is b1=[1,2]b_1 = [1, 2], b2=[2,3,1,5]b_2 = [2, 3, 1, 5]. This is a cool partition because every element in b1b_1 (which are 11 and 22) also appears in b2b_2. In contrast, b1=[1,2,2]b_1 = [1, 2, 2], b2=[3,1,5]b_2 = [3, 1, 5] is not a cool partition, since 22 appears in b1b_1 but not in b2b_2.Note that after partitioning the array, you do not change the order of the segments. Also, note that if an element appears several times in some segment bjb_j, it only needs to appear at least once in bj+1b_{j + 1}.Your task is to help Yousef by finding the maximum number of segments that make a cool partition."
  },
  {
    "title": "Shrink",
    "url": "https://codeforces.com/problemset/problem/2117/B",
    "description": "A shrink operation on an array aa of size mm is defined as follows:  Choose an index ii (2≤i≤m−12 \\le i \\le m - 1) such that ai>ai−1a_i \\gt a_{i - 1} and ai>ai+1a_i \\gt a_{i + 1}.  Remove aia_i from the array. Define the score of a permutation∗^{\\text{∗}} pp as the maximum number of times that you can perform the shrink operation on pp.Yousef has given you a single integer nn. Construct a permutation pp of length nn with the maximum possible score. If there are multiple answers, you can output any of them.∗^{\\text{∗}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array)."
  },
  {
    "title": "False Alarm",
    "url": "https://codeforces.com/problemset/problem/2117/A",
    "description": "Yousef is at the entrance of a long hallway with nn doors in a row, numbered from 11 to nn. He needs to pass through all the doors from 11 to nn in order of numbering and reach the exit (past door nn). Each door can be open or closed. If a door is open, Yousef passes through it in 11 second. If the door is closed, Yousef can't pass through it.However, Yousef has a special button which he can use at most once at any moment. This button makes all closed doors become open for xx seconds.Your task is to determine if Yousef can pass through all the doors if he can use the button at most once."
  },
  {
    "title": "Gellyfish and Baby's Breath",
    "url": "https://codeforces.com/problemset/problem/2116/B",
    "description": "Flower gives Gellyfish two permutations∗^{\\text{∗}} of [0,1,…,n−1][0, 1, \\ldots, n-1]: p0,p1,…,pn−1p_0, p_1, \\ldots, p_{n-1} and q0,q1,…,qn−1q_0, q_1, \\ldots, q_{n-1}.Now Gellyfish wants to calculate an array r0,r1,…,rn−1r_0,r_1,\\ldots,r_{n-1} through the following method:  For all ii (0≤i≤n−10 \\leq i \\leq n-1), ri=imaxj=0(2pj+2qi−j)r_i = \\max\\limits_{j=0}^{i} \\left(2^{p_j} + 2^{q_{i-j}} \\right) But since Gellyfish is very lazy, you have to help her figure out the elements of rr.Since the elements of rr are very large, you are only required to output the elements of rr modulo 998244353998\\,244\\,353.∗^{\\text{∗}}An array bb is a permutation of an array aa if bb consists of the elements of aa in arbitrary order. For example, [4,2,3,4][4,2,3,4] is a permutation of [3,2,4,4][3,2,4,4] while [1,2,2][1,2,2] is not a permutation of [1,2,3][1,2,3]."
  },
  {
    "title": "Gellyfish and Tricolor Pansy",
    "url": "https://codeforces.com/problemset/problem/2116/A",
    "description": "Gellyfish and Flower are playing a game called \"Duel\".Gellyfish has aa HP, while Flower has bb HP.Each of them has a knight. Gellyfish's knight has cc HP, while Flower's knight has dd HP.They will play a game in rounds until one of the players wins. For k=1,2,…k = 1, 2, \\ldots in this order, they will perform the following actions: If kk is odd and Gellyfish's knight is alive:  Gellyfish's knight can attack Flower and reduce bb by 11. If b≤0b \\leq 0, Gellyfish wins. Or,  Gellyfish's knight can attack Flower's knight and reduce dd by 11. If d≤0d \\leq 0, Flower's knight dies.  If kk is even and Flower's knight is alive:  Flower's knight can attack Gellyfish and reduce aa by 11. If a≤0a \\leq 0, Flower wins. Or,  Flower's knight can attack Gellyfish's knight and reduce cc by 11. If c≤0c \\leq 0, Gellyfish's knight dies. As one of the smartest people in the world, you want to tell them who will win before the game. Assume both players play optimally.It can be proven that the game will never end in a draw. That is, one player has a strategy to end the game in a finite number of moves."
  },
  {
    "title": "Gellyfish and Lycoris Radiata (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2115/F2",
    "description": "This is the hard version of the problem. The difference between the versions is that in this version, the time limit and the constraints on nn and qq are higher. You can hack only if you solved all versions of this problem. Gellyfish has an array consisting of nn sets. Initially, all the sets are empty.Now Gellyfish will do qq operations. Each operation contains one modification operation and one query operation, for the ii-th (1≤i≤q1 \\leq i \\leq q) operation:First, there will be a modification operation, which is one of the following:  Insert operation: You are given an integer rr. For the 11-th to rr-th sets, insert element ii. Note that the element inserted here is ii, the index of the operation, not the index of the set.  Reverse operation: You are given an integer rr. Reverse the 11-th to rr-th sets.  Delete operation: You are given an integer xx. Delete element xx from all sets that contain xx. Followed by a query operation:  Query operation: You are given an integer pp. Output the smallest element in the pp-th set (If the pp-th set is empty, the answer is considered to be 00). Now, Flower needs to provide the answer for each query operation. Please help her!Additional constraint on the problem: Gellyfish will only give the next operation after Flower has answered the previous query operation. That is, you need to solve this problem online. Please refer to the input format for more details."
  },
  {
    "title": "Gellyfish and Lycoris Radiata (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2115/F1",
    "description": "This is the easy version of the problem. The difference between the versions is that in this version, the time limit and the constraints on nn and qq are lower. You can hack only if you solved all versions of this problem. Gellyfish has an array consisting of nn sets. Initially, all the sets are empty.Now Gellyfish will do qq operations. Each operation contains one modification operation and one query operation, for the ii-th (1≤i≤q1 \\leq i \\leq q) operation:First, there will be a modification operation, which is one of the following:  Insert operation: You are given an integer rr. For the 11-th to rr-th sets, insert element ii. Note that the element inserted here is ii, the index of the operation, not the index of the set.  Reverse operation: You are given an integer rr. Reverse the 11-th to rr-th sets.  Delete operation: You are given an integer xx. Delete element xx from all sets that contain xx. Followed by a query operation:  Query operation: You are given an integer pp. Output the smallest element in the pp-th set (If the pp-th set is empty, the answer is considered to be 00). Now, Flower needs to provide the answer for each query operation. Please help her!Additional constraint on the problem: Gellyfish will only give the next operation after Flower has answered the previous query operation. That is, you need to solve this problem online. Please refer to the input format for more details."
  },
  {
    "title": "Gellyfish and Mayflower",
    "url": "https://codeforces.com/problemset/problem/2115/E",
    "description": "Mayflower by PlumMay, Gellyfish's friend, loves playing a game called \"Inscryption\" which is played on a directed acyclic graph with nn vertices and mm edges. All edges a→b a \\rightarrow b satisfy a<ba<b.You start in vertex 11 with some coins. You need to move from vertex 11 to the vertex where the boss is located along the directed edges, and then fight with the final boss.Each of the nn vertices of the graph contains a Trader who will sell you a card with power wiw_i for cic_i coins. You can buy as many cards as you want from each Trader. However, you can only trade with the trader on the ii-th vertex if you are currently on the ii-th vertex.In order to defeat the boss, you want the sum of the power of your cards to be as large as possible.You will have to answer the following qq queries:  Given integers pp and rr. If the final boss is located at vertex pp, and you have rr coins in the beginning, what is the maximum sum of the power of your cards when you fight the final boss? Note that you are allowed to trade cards on vertex pp. "
  },
  {
    "title": "Gellyfish and Forget-Me-Not",
    "url": "https://codeforces.com/problemset/problem/2115/D",
    "description": " Gellyfish and Flower are playing a game.The game consists of two arrays of nn integers a1,a2,…,ana_1,a_2,\\ldots,a_n and b1,b2,…,bnb_1,b_2,\\ldots,b_n, along with a binary string c1c2…cnc_1c_2\\ldots c_n of length nn.There is also an integer xx which is initialized to 00.The game consists of nn rounds. For i=1,2,…,ni = 1,2,\\ldots,n, the round proceeds as follows:  If ci=0c_i = \\mathtt{0}, Gellyfish will be the active player. Otherwise, if ci=1c_i = \\mathtt{1}, Flower will be the active player.  The active player will perform exactly one of the following operations:   Set x:=x⊕aix:=x \\oplus a_i.  Set x:=x⊕bix:=x \\oplus b_i.  Here, ⊕\\oplus denotes the bitwise XOR operation. Gellyfish wants to minimize the final value of x x  after n n  rounds, while Flower wants to maximize it. Find the final value of x x  after all n n  rounds if both players play optimally."
  },
  {
    "title": "Gellyfish and Eternal Violet",
    "url": "https://codeforces.com/problemset/problem/2115/C",
    "description": " There are nn monsters, numbered from 11 to nn, in front of Gellyfish. The HP of the ii-th monster is hih_i.Gellyfish doesn't want to kill them, but she wants to keep these monsters from being a threat to her. So she wants to reduce the HP of all the monsters to exactly 11.Now, Gellyfish, with The Sword Sharpened with Tears, is going to attack the monsters for mm rounds. For each round:  The Sword Sharpened with Tears shines with a probability of pp.  Gellyfish can choose whether to attack:   If Gellyfish doesn't attack, nothing happens.  If Gellyfish chooses to attack and The Sword Sharpened with Tears shines, the HP of all the monsters will be reduced by 11.  If Gellyfish chooses to attack and The Sword Sharpened with Tears does not shine, Gellyfish can choose one of the monsters and reduce its HP by 11.  Please note that before Gellyfish decides whether or not to attack, she will know whether the sword shines or not. Also, when the sword shines, Gellyfish can only make attacks on all the monsters and cannot make an attack on only one monster.Now, Gellyfish wants to know what the probability is that she will reach her goal if she makes choices optimally during the battle."
  },
  {
    "title": "Gellyfish and Camellia Japonica",
    "url": "https://codeforces.com/problemset/problem/2115/B",
    "description": "Gellyfish has an array of nn integers c1,c2,…,cnc_1, c_2, \\ldots, c_n. In the beginning, c=[a1,a2,…,an]c = [a_1, a_2, \\ldots, a_n].Gellyfish will make qq modifications to cc.For i=1,2,…,qi = 1,2,\\ldots,q, Gellyfish is given three integers xix_i, yiy_i, and ziz_i between 11 and nn. Then Gellyfish will set czi:=min(cxi,cyi)c_{z_i} := \\min(c_{x_i}, c_{y_i}).After the qq modifications, c=[b1,b2,…,bn]c = [b_1, b_2, \\ldots, b_n].Now Flower knows the value of bb and the value of the integers xix_i, yiy_i, and ziz_i for all 1≤i≤q1 \\leq i \\leq q, but she doesn't know the value of aa.Flower wants to find any possible value of the array aa or report that no such aa exists.If there are multiple possible values of the array aa, you may output any of them."
  },
  {
    "title": "Gellyfish and Flaming Peony",
    "url": "https://codeforces.com/problemset/problem/2115/A",
    "description": "Gellyfish hates math problems, but she has to finish her math homework:Gellyfish is given an array of nn positive integers a1,a2,…,ana_1, a_2, \\ldots, a_n.She needs to do the following two-step operation until all elements of aa are equal:  Select two indexes ii, jj satisfying 1≤i,j≤n1 \\leq i, j \\leq n and i≠ji \\neq j.  Replace aia_i with gcd(ai,aj)\\gcd(a_i, a_j). Now, Gellyfish asks you for the minimum number of operations to achieve her goal.It can be proven that Gellyfish can always achieve her goal."
  },
  {
    "title": "Build an Array",
    "url": "https://codeforces.com/problemset/problem/2114/G",
    "description": "Yesterday, Dima found an empty array and decided to add some integers to it. He can perform the following operation an unlimited number of times:  add any integer to the left or right end of the array.  then, as long as there is a pair of identical adjacent elements in the array, they will be replaced by their sum. It can be shown that there can be at most one such pair in the array at the same time.For example, if the array is [3,6,4][3, 6, 4] and we add the number 33 to the left, the array will first become [3,3,6,4][3, 3, 6, 4], then the first two elements will be replaced by 66, and the array will become [6,6,4][6, 6, 4], and then — [12,4][12, 4].After performing the operation exactly kk times, he thinks he has obtained an array aa of length nn, but he does not remember which operations he applied. Determine if there exists a sequence of kk operations that could result in the given array aa from an empty array, or determine that it is impossible."
  },
  {
    "title": "Small Operations",
    "url": "https://codeforces.com/problemset/problem/2114/F",
    "description": "Given an integer xx and an integer kk. In one operation, you can perform one of two actions:  choose an integer 1≤a≤k1 \\le a \\le k and assign x=x⋅ax = x \\cdot a;  choose an integer 1≤a≤k1 \\le a \\le k and assign x=xax = \\frac{x}{a}, where the value of xa\\frac{x}{a} must be an integer. Find the minimum number of operations required to make the number xx equal to yy, or determine that it is impossible."
  },
  {
    "title": "Kirei Attacks the Estate",
    "url": "https://codeforces.com/problemset/problem/2114/E",
    "description": "Once, Kirei stealthily infiltrated the trap-filled estate of the Ainzbern family but was discovered by Kiritugu's familiar. Assessing his strength, Kirei decided to retreat. The estate is represented as a tree with nn vertices, with the root at vertex 11. Each vertex of the tree has a number aia_i recorded, which represents the danger of vertex ii. Recall that a tree is a connected undirected graph without cycles.For a successful retreat, Kirei must compute the threat value for each vertex. The threat of a vertex is equal to the maximum alternating sum along the vertical path starting from that vertex. The alternating sum along the vertical path starting from vertex ii is defined as ai−api+appi−…a_i - a_{p_i} + a_{p_{p_i}} - \\ldots, where pip_i is the parent of vertex ii on the path to the root (to vertex 11).For example, in the tree below, vertex 44 has the following vertical paths:   [4][4] with an alternating sum of a4=6a_4 = 6;  [4,3][4, 3] with an alternating sum of a4−a3=6−2=4a_4 - a_3 = 6 - 2 = 4;  [4,3,2][4, 3, 2] with an alternating sum of a4−a3+a2=6−2+5=9a_4 - a_3 + a_2 = 6 - 2 + 5 = 9;  [4,3,2,1][4, 3, 2, 1] with an alternating sum of a4−a3+a2−a1=6−2+5−4=5a_4 - a_3 + a_2 - a_1 = 6 - 2 + 5 - 4 = 5.   The dangers of the vertices are indicated in red. Help Kirei compute the threat values for all vertices and escape the estate."
  },
  {
    "title": "Come a Little Closer",
    "url": "https://codeforces.com/problemset/problem/2114/D",
    "description": "The game field is a matrix of size 109×10910^9 \\times 10^9, with a cell at the intersection of the aa-th row and the bb-th column denoted as (a,ba, b).There are nn monsters on the game field, with the ii-th monster located in the cell (xi,yix_i, y_i), while the other cells are empty. No more than one monster can occupy a single cell.You can move one monster to any cell on the field that is not occupied by another monster at most once .After that, you must select one rectangle on the field; all monsters within the selected rectangle will be destroyed. You must pay 11 coin for each cell in the selected rectangle.Your task is to find the minimum number of coins required to destroy all the monsters."
  },
  {
    "title": "Need More Arrays",
    "url": "https://codeforces.com/problemset/problem/2114/C",
    "description": "Given an array aa and nn integers. It is sorted in non-decreasing order, that is, ai≤ai+1a_i \\le a_{i + 1} for all 1≤i<n1 \\le i < n.You can remove any number of elements from the array (including the option of not removing any at all) without changing the order of the remaining elements. After the removals, the following will occur:  a1a_1 is written to a new array; if a1+1<a2a_1 + 1 < a_2, then a2a_2 is written to a new array; otherwise, a2a_2 is written to the same array as a1a_1; if a2+1<a3a_2 + 1 < a_3, then a3a_3 is written to a new array; otherwise, a3a_3 is written to the same array as a2a_2; ⋯\\cdots For example, if a=[1,2,4,6]a=[1, 2, 4, 6], then:  a1=1a_1 = 1 is written to the new array, resulting in arrays: [1][1];  a1+1=2a_1 + 1 = 2, so a2=2a_2 = 2 is added to the existing array, resulting in arrays: [1,2][1, 2];  a2+1=3a_2 + 1 = 3, so a3=4a_3 = 4 is written to a new array, resulting in arrays: [1,2][1, 2] and [4][4];  a3+1=5a_3 + 1 = 5, so a4=6a_4 = 6 is written to a new array, resulting in arrays: [1,2][1, 2], [4][4], and [6][6]. Your task is to remove elements in such a way that the described algorithm creates as many arrays as possible. If you remove all elements from the array, no new arrays will be created."
  },
  {
    "title": "Not Quite a Palindromic String",
    "url": "https://codeforces.com/problemset/problem/2114/B",
    "description": "Vlad found a binary string∗^{\\text{∗}} ss of even length nn. He considers a pair of indices (i,n−i+1i, n - i + 1), where 1≤i<n−i+11 \\le i < n - i + 1, to be good if si=sn−i+1s_i = s_{n - i + 1} holds true.For example, in the string '010001' there is only 11 good pair, since s1≠s6s_1 \\ne s_6, s2≠s5s_2 \\ne s_5, and s3=s4s_3=s_4. In the string '0101' there are no good pairs.Vlad loves palindromes, but not too much, so he wants to rearrange some characters of the string so that there are exactly kk good pairs of indices.Determine whether it is possible to rearrange the characters in the given string so that there are exactly kk good pairs of indices (i,n−i+1i, n - i + 1).∗^{\\text{∗}}A string ss is called binary if it consists only of the characters '0' and '1' "
  },
  {
    "title": "Square Year",
    "url": "https://codeforces.com/problemset/problem/2114/A",
    "description": "One can notice the following remarkable mathematical fact: the number 20252025 can be represented as (20+25)2(20+25)^2.You are given a year represented by a string ss, consisting of exactly 44 characters. Thus, leading zeros are allowed in the year representation. For example, \"0001\", \"0185\", \"1375\" are valid year representations. You need to express it in the form (a+b)2(a + b)^2, where aa and bb are non-negative integers, or determine that it is impossible.For example, if ss = \"0001\", you can choose a=0a = 0, b=1b = 1, and write the year as (0+1)2=1(0 + 1)^2 = 1."
  },
  {
    "title": "Two Arrays",
    "url": "https://codeforces.com/problemset/problem/2113/F",
    "description": "You are given two arrays aa and bb of length nn. You can perform the following operation an unlimited number of times:  Choose an integer ii from 11 to nn and swap aia_i and bib_i. Let f(c)f(c) be the number of distinct numbers in array cc. Find the maximum value of f(a)+f(b)f(a) + f(b). Also, output the arrays aa and bb after performing all operations."
  },
  {
    "title": "From Kazan with Love",
    "url": "https://codeforces.com/problemset/problem/2113/E",
    "description": "Marat is a native of Kazan. Kazan can be represented as an undirected tree consisting of nn vertices. In his youth, Marat often got into street fights, and now he has mm enemies, numbered from 11 to mm, living in Kazan along with him.Every day, all the people living in the city go to work. Marat knows that the ii-th of his enemies lives at vertex aia_i and works at vertex bib_i. He himself lives at vertex xx and works at vertex yy. It is guaranteed that ai≠xa_i \\ne x.All enemies go to work via the shortest path and leave their homes at time 11. That is, if we represent the shortest path between vertices aia_i and bib_i as c1,c2,c3,…,ckc_1, c_2, c_3, \\ldots, c_k (where c1=aic_1 = a_i and ck=bic_k = b_i), then at the moment pp (1≤p≤k1 \\le p \\le k), the enemy numbered ii will be at vertex cpc_p.Marat really does not want to meet any of his enemies at the same vertex at the same time, as this would create an awkward situation, but they can meet on an edge. Marat also leaves his home at time 11, and at each subsequent moment in time, he can either move to an adjacent vertex or stay at his current one.Note that Marat can only meet the ii-th enemy at the moments 2,3,…,k2, 3, \\ldots, k (where c1,c2,…,ckc_1, c_2, \\ldots, c_k is the shortest path between vertices aia_i and bib_i). In other words, starting from the moment after the enemy reaches work, Marat can no longer meet him.Help Marat find the earliest moment in time when he can reach work without encountering any enemies along the way, or determine that it is impossible."
  },
  {
    "title": "Cheater",
    "url": "https://codeforces.com/problemset/problem/2113/D",
    "description": "You are playing a new card game in a casino with the following rules:  The game uses a deck of 2n2n cards with different values.  The deck is evenly split between the player and the dealer: each receives nn cards.  Over nn rounds, the player and the dealer simultaneously play one top card from their hand. The cards are compared, and the point goes to the one whose card has a higher value. The winning card is removed from the game, while the losing card is returned to the hand and placed on top of the other cards in the hand of the player who played it. Note that the game always lasts exactly nn rounds.You have tracked the shuffling of the cards and know the order of the cards in the dealer's hand (from top to bottom). You want to maximize your score, so you can swap any two cards in your hand no more than once (to avoid raising suspicion).Determine the maximum number of points you can achieve."
  },
  {
    "title": "Smilo and Minecraft",
    "url": "https://codeforces.com/problemset/problem/2113/C",
    "description": "The boy Smilo is playing Minecraft! To prepare for the battle with the dragon, he needs a lot of golden apples, and for that, he requires a lot of gold. Therefore, Smilo goes to the mine.The mine is a rectangular grid of size n×mn \\times m, where each cell can be either gold ore, stone, or an empty cell. Smilo can blow up dynamite in any empty cell. When dynamite explodes in an empty cell with coordinates (x,y)(x, y), all cells within a square of side 2k+12k + 1 centered at cell (x,y)(x, y) become empty. If gold ore was located strictly inside this square (not on the boundary), it disappears. However, if the gold ore was on the boundary of this square, Smilo collects that gold.Dynamite can only be detonated inside the mine, but the explosion square can extend beyond the mine's boundaries.Determine the maximum amount of gold that Smilo can collect."
  },
  {
    "title": "Good Start",
    "url": "https://codeforces.com/problemset/problem/2113/B",
    "description": "The roof is a rectangle of size w×hw \\times h with the bottom left corner at the point (0,0)(0, 0) on the plane. Your team needs to completely cover this roof with identical roofing sheets of size a×ba \\times b, with the following conditions:  The sheets cannot be rotated (not even by 90∘90^\\circ).  The sheets must not overlap (but they can touch at the edges).  The sheets can extend beyond the boundaries of the rectangular roof. A novice from your team has already placed two such sheets on the roof in such a way that the sheets do not overlap and each of them partially covers the roof.Your task is to determine whether it is possible to completely tile the roof without removing either of the two already placed sheets."
  },
  {
    "title": "Shashliks",
    "url": "https://codeforces.com/problemset/problem/2113/A",
    "description": "You are the owner of a popular shashlik restaurant, and your grill is the heart of your kitchen. However, the grill has a peculiarity: after cooking each shashlik, its temperature drops.You need to cook as many portions of shashlik as possible, and you have an unlimited number of portions of two types available for cooking: The first type requires a temperature of at least aa degrees at the start of cooking, and after cooking, the grill's temperature decreases by xx degrees. The second type requires a temperature of at least bb degrees at the start of cooking, and after cooking, the grill's temperature decreases by yy degrees.Initially, the grill's temperature is kk degrees. Determine the maximum total number of portions of shashlik that can be cooked.Note that the grill's temperature can be negative."
  },
  {
    "title": "Variables and Operations",
    "url": "https://codeforces.com/problemset/problem/2112/F",
    "description": "There are nn variables; let's denote the value of the ii-th variable as aia_i.There are also mm operations which will be applied to these variables; the ii-th operation is described by three integers xi,yi,zix_i, y_i, z_i. When the ii-th operation is applied, the variable xix_i gets assigned the following value: min(axi,ayi+zi)\\min(a_{x_i}, a_{y_i} + z_i).Every operation will be applied exactly once, but their order is not fixed; they can be applied in any order.Let's call a sequence of initial variable values a1,a2,…,ana_1, a_2, \\dots, a_n stable, if no matter in which order we apply operations, the resulting values will be the same. If the resulting value of the ii-th variable depends on the order of operations, then the sequence of initial variable values is called ii-unstable.You have to process qq queries. In each query, you will be given initial values a1,a2,…,ana_1, a_2, \\dots, a_n and an integer kk; before applying the operations, you can at most kk times choose a variable and decrease it by 11. For every variable ii, you have to independently determine if it is possible to transform the given values into an ii-unstable sequence."
  },
  {
    "title": "Tree Colorings",
    "url": "https://codeforces.com/problemset/problem/2112/E",
    "description": "Consider a rooted undirected tree. Each vertex can be colored blue, green, or yellow. A coloring is called beautiful if it meets these conditions:   the root of the tree is green;  if you consider all blue and green vertices, they are reachable from each other without passing through any yellow vertices;  if you consider all yellow and green vertices, they are reachable from each other without passing through any blue vertices; You are given an integer mmm. Your task is to calculate the minimum number of vertices in a tree with exactly mm beautiful colorings."
  },
  {
    "title": "Reachability and Tree",
    "url": "https://codeforces.com/problemset/problem/2112/D",
    "description": "Let uu and vv be two distinct vertices in a directed graph. Let's call the ordered pair (u,v)(u, v) good if there exists a path from vertex uu to vertex vv along the edges of the graph.You are given an undirected tree with nn vertices and n−1n - 1 edges. Determine whether it is possible to assign a direction to each edge of this tree so that the number of good pairs in it is exactly nn. If it is possible, print any way to direct the edges resulting in exactly nn good pairs.  One possible directed version of the tree for the first test case. "
  },
  {
    "title": "Coloring Game",
    "url": "https://codeforces.com/problemset/problem/2112/C",
    "description": "Alice and Bob are playing a game using an integer array aaa of size nn.Initially, all elements of the array are colorless. First, Alice chooses 33 elements and colors them red. Then Bob chooses any element and colors it blue (if it was red — recolor it). Alice wins if the sum of the red elements is strictly greater than the value of the blue element.Your task is to calculate the number of ways that Alice can choose 33 elements in order to win regardless of Bob's actions."
  },
  {
    "title": "Shrinking Array",
    "url": "https://codeforces.com/problemset/problem/2112/B",
    "description": "Let's call an array bb beautiful if it consists of at least two elements and there exists a position ii such that |bi−bi+1|≤1|b_i - b_{i + 1}| \\le 1 (where |x||x| is the absolute value of xx).You are given an array aa, and as long as it consists of at least two elements, you can perform the following operation:   Choose two adjacent positions ii and i+1i + 1 in the array aa.  Choose an integer xx such that min(ai,ai+1)≤x≤max(ai,ai+1)\\min(a_i, a_{i + 1}) \\le x \\le \\max(a_i, a_{i + 1}).  Remove the numbers aia_i and ai+1a_{i + 1} from the array, and insert the number xx in their place. Obviously, the size of the array will decrease by 11. Calculate the minimum number of operations required to make the array beautiful, or report that it is impossible."
  },
  {
    "title": "Race",
    "url": "https://codeforces.com/problemset/problem/2112/A",
    "description": "Alice and Bob participate in a game TV show. When the game starts, the prize will be dropped to a certain point, and whoever gets to it first will get the prize.Alice decided that she would start running from point aa. Bob, however, has not yet chosen his starting position.Bob knows that the prize could drop either at point xx or at point yy. He also knows that he can reach the prize faster than Alice if the distance from his starting position to the prize is strictly less than the distance from Alice's starting position to the prize. The distance between any two points cc and dd is calculated as |c−d||c-d|.Your task is to determine whether Bob can choose an integer point that is guarantee to get to the prize faster, regardless of where it appears (at point xx or yy). Bob can choose any integer point, except for aa (in particular, he can choose to start in point xx, point yy, or any other point, but not aa)."
  },
  {
    "title": "Divisible Subarrays",
    "url": "https://codeforces.com/problemset/problem/2111/G",
    "description": "Technically, this is an interactive problem.An array aa of mm numbers is called divisible if at least one of the following conditions holds:  There exists an index ii (1≤i<m1 \\le i < m) and an integer xx such that for all indices jj (j≤ij \\le i), it holds that aj≤xa_{j} \\le x and for all indices kk (k>ik > i), it holds that ak>xa_{k} > x.  There exists an index ii (1≤i<m1 \\le i < m) and an integer xx such that for all indices jj (j≤ij \\le i), it holds that aj>xa_{j} > x and for all indices kk (k>ik > i), it holds that ak≤xa_{k} \\le x. You are given a permutation pp of integers 1,2,…,n1, 2, \\dots, n. Your task is to answer queries of the following form fast: if we take only the segment [ll, rr] from the permutation, that is, the numbers pl,pl+1,…,prp_{l}, p_{l + 1}, \\dots, p_{r}, is this subarray of numbers divisible?Queries will be submitted in interactive mode in groups of 1010, meaning you will not receive the next group of queries until you output all answers for the current group."
  },
  {
    "title": "Puzzle",
    "url": "https://codeforces.com/problemset/problem/2111/F",
    "description": "You have been gifted a puzzle, where each piece of this puzzle is a square with a side length of one. You can glue any picture onto this puzzle, cut it, and obtain an almost ordinary jigsaw puzzle.Your friend is an avid mathematician, so he suggested you consider the following problem. Is it possible to arrange the puzzle pieces in such a way that the following conditions are met:  the pieces are aligned parallel to the coordinate axes;  the pieces do not overlap each other;  all pieces form a single connected component (i.e., there exists a path from each piece to every other piece along the pieces, where each two consecutive pieces share a side);  the ratio of the perimeter of this component to the area of this component equals ps\\frac{p}{s};  the number of pieces used does not exceed 5000050\\,000. Can you handle it?    For this figure, the ratio of the perimeter to the area is 119\\frac{11}{9} "
  },
  {
    "title": "Changing the String",
    "url": "https://codeforces.com/problemset/problem/2111/E",
    "description": "Given a string sss that consists only of the first three letters of the Latin alphabet, meaning each character of the string is either a, b, or c.Also given are qqq operations that need to be performed on the string. In each operation, two letters xxx and yyy from the set of the first three letters of the Latin alphabet are provided, and for each operation, one of the following two actions must be taken:  change any (one) occurrence of the letter xxx in the string sss to the letter yyy (if at least one occurrence of the letter xxx exists);  do nothing. The goal is to perform all operations in the given order in such a way that the string sss becomes lexicographically minimal.Recall that a string aaa is lexicographically less than a string bbb if and only if one of the following conditions holds:  aaa is a prefix of bbb, but a≠ba≠ba \\neq b;  at the first position where aaa and bbb differ, the string aaa has a letter that comes earlier in the alphabet than the corresponding letter in bbb. "
  },
  {
    "title": "Creating a Schedule",
    "url": "https://codeforces.com/problemset/problem/2111/D",
    "description": "A new semester is about to begin, and it is necessary to create a schedule for the first day. There are a total of nnn groups and mmm classrooms in the faculty. It is also known that each group has exactly 666 classes on the first day, and the kkk-th class of each group takes place at the same time. Each class must be held in a classroom, and at the same time, there cannot be classes for more than one group in the same classroom.Each classroom has its own index (at least three digits), and all digits of this index, except for the last two, indicate the floor on which the classroom is located. For example, classroom 479479479 is located on the 444-th floor, while classroom 314153141531415 is on the 314314314-th floor. Between floors, one can move by stairs; for any floor x>1x>1x > 1, one can either go down to floor x−1x−1x - 1 or go up to floor x+1x+1x + 1; from the first floor, one can only go up to the second; from the floor 10710710^7 (which is the last one), it is possible to go only to the floor 999999999999999999999.The faculty's dean's office has decided to create the schedule in such a way that students move as much as possible between floors, meaning that the total number of movements between floors across all groups should be maximized. When the students move from one floor to another floor, they take the shortest path.For example, if there are n=2n=2n = 2 groups and m=4m=4m = 4 classrooms [479,290,478,293][479,290,478,293][479, 290, 478, 293], the schedule can be arranged as follows: Class No.Group 1Group 2111290290290293293293222478478478479479479333293293293290290290444479479479478478478555293293293290290290666479479479478478478 In such a schedule, the groups will move between the 222nd and 444th floors each time, resulting in a total of 202020 movements between floors.Help the dean's office create any suitable schedule!"
  },
  {
    "title": "Equal Values",
    "url": "https://codeforces.com/problemset/problem/2111/C",
    "description": "You are given an array a1,a2,…,ana1,a2,…,ana_1, a_2, \\dots, a_n, consisting of nn integers.In one operation, you are allowed to perform one of the following actions:   Choose a position ii (1<i≤n1 < i \\le n) and make all elements to the left of ii equal to aia_i. That is, assign the value aia_i to all aja_j (1≤j<i1 \\le j < i). The cost of such an operation is (i−1)⋅ai(i - 1) \\cdot a_i.  Choose a position ii (1≤i<n1 \\le i < n) and make all elements to the right of ii equal to aia_i. That is, assign the value aia_i to all aja_j (i<j≤ni < j \\le n). The cost of such an operation is (n−i)⋅ai(n - i) \\cdot a_i. Note that the elements affected by an operation may already be equal to aia_i, but that doesn't change the cost.You are allowed to perform any number of operations (including zero). What is the minimum total cost to make all elements of the array equal?"
  },
  {
    "title": "Fibonacci Cubes",
    "url": "https://codeforces.com/problemset/problem/2111/B",
    "description": "There are nn Fibonacci cubes, where the side of the ii-th cube is equal to fif_{i}, where fif_{i} is the ii-th Fibonacci number.In this problem, the Fibonacci numbers are defined as follows:  f1=1f_{1} = 1  f2=2f_{2} = 2  fi=fi−1+fi−2f_{i} = f_{i - 1} + f_{i - 2} for i>2i > 2 There are also mm empty boxes, where the ii-th box has a width of wiw_{i}, a length of lil_{i}, and a height of hih_{i}.For each of the mm boxes, you need to determine whether all the cubes can fit inside that box. The cubes must be placed in the box following these rules:  The cubes can only be stacked in the box such that the sides of the cubes are parallel to the sides of the box;  Every cube must be placed either on the bottom of the box or on top of other cubes in such a way that all space below the cube is occupied;  A larger cube cannot be placed on top of a smaller cube. "
  },
  {
    "title": "Energy Crystals",
    "url": "https://codeforces.com/problemset/problem/2111/A",
    "description": "There are three energy crystals numbered 111, 222, and 333; let's denote the energy level of the iii-th crystal as aiaia_i. Initially, all of them are discharged, meaning their energy levels are equal to 000. Each crystal needs to be charged to level xxx (exactly xxx, not greater).In one action, you can increase the energy level of any one crystal by any positive amount; however, the energy crystals are synchronized with each other, so an action can only be performed if the following condition is met afterward:  for each pair of crystals iii, jjj, it must hold that ai≥⌊aj2⌋ai≥⌊aj2⌋a_{i} \\ge \\lfloor\\frac{a_{j}}{2}\\rfloor. What is the minimum number of actions required to charge all the crystals?"
  },
  {
    "title": "Faculty",
    "url": "https://codeforces.com/problemset/problem/2110/F",
    "description": "In 2077, after the world was enslaved by robots, the robots decided to implement an educational reform, and now the operation of taking the modulus is only taught in the faculty of \"Ancient World History\". Here is one of the entrance tasks for this faculty:We define the beauty of an array of positive integers bb as the maximum f(bi,bj)f(b_i, b_j) over all pairs 1≤i,j≤n1 \\leq i, j \\leq n, where f(x,y)=(xmody)+(ymodx)f(x, y) = (x \\bmod y) + (y \\bmod x).Given an array of positive integers aa of length nn, output nn numbers, where the ii-th number (1≤i≤n1 \\leq i \\leq n) is the beauty of the array a1,a2,…,aia_1, a_2, \\ldots, a_i.xmodyx \\bmod y is the remainder of the division of xx by yy."
  },
  {
    "title": "Melody",
    "url": "https://codeforces.com/problemset/problem/2110/E",
    "description": "In 2077, the robots that took over the world realized that human music wasn't that great, so they started composing their own.To write music, the robots have a special musical instrument capable of producing nn different sounds. Each sound is characterized by its volume and pitch. A sequence of sounds is called music. Music is considered beautiful if any two consecutive sounds differ either only in volume or only in pitch. Music is considered boring if the volume or pitch of any three consecutive sounds is the same.You want to compose beautiful, non-boring music that contains each sound produced by your musical instrument exactly once."
  },
  {
    "title": "Fewer Batteries",
    "url": "https://codeforces.com/problemset/problem/2110/D",
    "description": "In 2077, when robots took over the world, they decided to compete in the following game.There are nnn checkpoints, and the iii-th checkpoint contains bibib_i batteries. Initially, the Robot starts at the 111-st checkpoint with no batteries and must reach the nnn-th checkpoint.There are a total of mmm one-way passages between the checkpoints. The iii-th passage allows movement from point sisis_i to point titit_i (si<tisi<tis_i < t_i), but not the other way. Additionally, the iii-th passage can only be used if the robot has at least wiwiw_i charged batteries; otherwise, it will run out of power on the way.When the robot arrives at point vvv, it can additionally take any number of batteries from 000 to bvbvb_v, inclusive. Moreover, it always carries all previously collected batteries, and at each checkpoint, it recharges all previously collected batteries.Find the minimum number of batteries that the robot can have at the end of the journey, or report that it is impossible to reach from the first checkpoint to the last."
  },
  {
    "title": "Racing",
    "url": "https://codeforces.com/problemset/problem/2110/C",
    "description": "In 2077, a sport called hobby-droning is gaining popularity among robots.You already have a drone, and you want to win. For this, your drone needs to fly through a course with nnn obstacles.The iii-th obstacle is defined by two numbers li,rili,ril_i, r_i. Let the height of your drone at the iii-th obstacle be hihih_i. Then the drone passes through this obstacle if li≤hi≤rili≤hi≤ril_i \\le h_i \\le r_i. Initially, the drone is on the ground, meaning h0=0h0=0h_0 = 0.The flight program for the drone is represented by an array d1,d2,…,dnd1,d2,…,dnd_1, d_2, \\ldots, d_n, where hi−hi−1=dihi−hi−1=dih_{i} - h_{i-1} = d_i, and 0≤di≤10≤di≤10 \\leq d_i \\leq 1. This means that your drone either does not change height between obstacles or rises by 111. You already have a flight program, but some didid_i in it are unknown and marked as −1−1-1. Replace the unknown didid_i with numbers 000 and 111 to create a flight program that passes through the entire obstacle course, or report that it is impossible."
  },
  {
    "title": "Down with Brackets",
    "url": "https://codeforces.com/problemset/problem/2110/B",
    "description": "In 2077, robots decided to get rid of balanced bracket sequences once and for all!A bracket sequence is called balanced if it can be constructed by the following formal grammar.   The empty sequence ∅\\varnothing is balanced.  If the bracket sequence AA is balanced, then (A)\\mathtt{(}A\\mathtt{)} is also balanced.  If the bracket sequences AA and BB are balanced, then the concatenated sequence ABA B is also balanced. You are the head of the department for combating balanced bracket sequences, and your main task is to determine which brackets you can destroy and which you cannot.You are given a balanced bracket sequence represented by a string ss, consisting of the characters ( and ). Since the robots' capabilities are not limitless, they can remove exactly one opening bracket and exactly one closing bracket from the string.Your task is to determine whether the robots can delete such two brackets so that the string ss is no longer a balanced bracket sequence."
  },
  {
    "title": "Fashionable Array",
    "url": "https://codeforces.com/problemset/problem/2110/A",
    "description": "In 2077, everything became fashionable among robots, even arrays...We will call an array of integers aa fashionable if min(a)+max(a)\\min(a) + \\max(a) is divisible by 22 without a remainder, where min(a)\\min(a) — the value of the minimum element of the array aa, and max(a)\\max(a) — the value of the maximum element of the array aa.You are given an array of integers a1,a2,…,ana_1, a_2, \\ldots, a_n. In one operation, you can remove any element from this array. Your task is to determine the minimum number of operations required to make the array aa fashionable."
  },
  {
    "title": "Penguin Steps",
    "url": "https://codeforces.com/problemset/problem/2109/F",
    "description": "Mouf, the clever master of Darkness, and Fouad, the brave champion of Light, have entered the Grid Realm once more. This time, they have found the exit, but it is guarded by fierce monsters! They must fight with their bare hands instead of summoning monsters!Mouf and Fouad are standing on an n×nn×nn \\times n grid. Each cell (i,j)(i,j)(i, j) has a value ai,jai,ja_{i,j} and a color. The color of a cell is white if ci,j=0ci,j=0c_{i,j} = 0 and black if ci,j=1ci,j=1c_{i,j} = 1.Mouf starts at the top-left corner (1,1)(1,1)(1, 1), and Fouad starts at the bottom-left corner (n,1)(n,1)(n, 1). Both are trying to reach the exit cell at (r,n)(r,n)(r, n).A path is defined as a sequence of adjacent cells (sharing a horizontal or vertical edge). The cost of a path is the maximum value of ai,jai,ja_{i, j} among all cells included in the path (including the first and last cells).Let:   disMdisM\\mathrm{dis}_M denote the minimum possible cost of a valid path from Mouf's starting position (1,1)(1,1)(1, 1) to the exit (r,n)(r,n)(r, n);  disFdisF\\mathrm{dis}_F denote the minimum possible cost of a valid path from Fouad's starting position (n,1)(n,1)(n, 1) to the exit (r,n)(r,n)(r, n). Before moving, Mouf can perform up to kkk operations. In each operation, he may select any black cell and increment its value by 111 (possibly choosing the same cell multiple times).Mouf wants to maximize disFdisF\\mathrm{dis}_F while ensuring that his own cost disMdisM\\mathrm{dis}_M remains unchanged (as if he performed no operations). If Mouf acts optimally, what are the values of disMdisM\\mathrm{dis}_M and disFdisF\\mathrm{dis}_F?"
  },
  {
    "title": "Binary String Wowee",
    "url": "https://codeforces.com/problemset/problem/2109/E",
    "description": "Mouf is bored with themes, so he decided not to use any themes for this problem.You are given a binary∗∗^{\\text{∗}} string ss of length nn. You are to perform the following operation exactly kk times:  select an index ii (1≤i≤n1 \\le i \\le n) such that si=0s_i = \\mathtt{0};  then flip†^{\\text{†}} each sjs_j for all indices jj (1≤j≤i1 \\le j \\le i). You need to count the number of possible ways to perform all kk operations. Since the answer could be ginormous, print it modulo 998244353998\\,244\\,353.Two sequences of operations are considered different if they differ in the index selected at any step.∗^{\\text{∗}}A binary string is a string that consists only of the characters 0\\mathtt{0} and 1\\mathtt{1}.†^{\\text{†}}Flipping a binary character is changing it from 0\\mathtt{0} to 1\\mathtt{1} or vice versa."
  },
  {
    "title": "D/D/D",
    "url": "https://codeforces.com/problemset/problem/2109/D",
    "description": "Of course, a problem with the letter D is sponsored by Declan Akaba.You are given a simple, connected, undirected graph with nnn vertices and mmm edges. The graph contains no self-loops or multiple edges. You are also given a multiset AAA consisting of ℓ\\ell elements: A={A1,A2,…,Aℓ} A = \\{A_1, A_2, \\ldots, A_\\ell\\} Starting from vertex 11, you may perform the following move any number of times, as long as the multiset AA is not empty:   Select an element k∈Ak \\in A and remove it from the multiset . You must remove exactly one occurrence of kk from AA.  Traverse any walk∗^{\\text{∗}} of exactly kk edges to reach some vertex (possibly the same one you started from). For each ii (1≤i≤n1 \\le i \\le n), determine whether there exists a sequence of such moves that starts at vertex 11 and ends at vertex ii, using the original multiset AA. Note that the check for each vertex ii is independent — you restart from vertex 11 and use the original multiset AA for each case.∗^{\\text{∗}}A walk of length kk is a sequence of vertices v0,v1,…,vk−1,vkv_0, v_1, \\ldots, v_{k - 1}, v_k such that each consecutive pair of vertices (vi,vi+1)(v_i, v_{i + 1}) is connected by an edge in the graph. The sequence may include repeated vertices."
  },
  {
    "title": "Hacking Numbers (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2109/C3",
    "description": "This is the hard version of the problem. In this version, the limit of commands you can send is described in the statement. You can make hacks only if all versions of the problem are solved.This is an interactive problem.Welcome, Duelists! In this interactive challenge, there is an unknown integer xxx (1≤x≤1091≤x≤1091 \\le x \\le 10^9). You must make it equal to a given integer in the input nnn. By harnessing the power of \"Mathmech\" monsters, you can send a command to do one of the following: CommandConstraintResultCaseUpdateJury's response\"add yyy\"−1018≤y≤1018−1018≤y≤1018-10^{18} \\le y \\le 10^{18}res=x+yres=x+y\\mathrm{res} = x + yif 1≤res≤1018if 1≤res≤1018\\text{if } 1 \\le \\mathrm{res} \\le 10^{18}x←resx←resx \\leftarrow \\mathrm{res}\"1\"elseelse\\mathrm{else}x←xx←xx \\leftarrow x\"0\"\"mul yyy\"1≤y≤10181≤y≤10181 \\le y \\le 10^{18}res=x⋅yres=x⋅y\\mathrm{res} = x \\cdot yif 1≤res≤1018if 1≤res≤1018\\text{if } 1 \\le \\mathrm{res} \\le 10^{18}x←resx←resx \\leftarrow \\mathrm{res}\"1\"elseelse\\mathrm{else}x←xx←xx \\leftarrow x\"0\"\"div yyy\"1≤y≤10181≤y≤10181 \\le y \\le 10^{18}res=x/yres=x/y\\mathrm{res} = x/yif yif y\\text{if } y divides xxxx←resx←resx \\leftarrow \\mathrm{res}\"1\"elseelse\\mathrm{else}x←xx←xx \\leftarrow x\"0\"\"digit\"—res=S(x)\\mathrm{res} = S(x)∗^{\\text{∗}}—x←resx \\leftarrow \\mathrm{res}\"1\" Let f(n)f(n) be the minimum integer such that there is a sequence of f(n)f(n) commands that transforms xx into nn for all x(1≤x≤109)x(1 \\le x \\le 10^9). You do not know the value of xx in advance. Find f(n)f(n) such that, no matter what xx is, you can always transform it into nn using at most f(n)f(n) commands.Your task is to change xx into nn using at most f(n)f(n) commands.∗^{\\text{∗}}S(n)S(n) is a function that returns the sum of all the individual digits of a non-negative integer nn. For example, S(123)=1+2+3=6S(123) = 1 + 2 + 3 = 6"
  },
  {
    "title": "Hacking Numbers (Medium Version)",
    "url": "https://codeforces.com/problemset/problem/2109/C2",
    "description": "This is the medium version of the problem. In this version, you can send at most 44\\mathbf{4} commands. You can make hacks only if all versions of the problem are solved.This is an interactive problem.Welcome, Duelists! In this interactive challenge, there is an unknown integer xxx (1≤x≤1091≤x≤1091 \\le x \\le 10^9). You must make it equal to a given integer in the input nnn. By harnessing the power of \"Mathmech\" monsters, you can send a command to do one of the following: CommandConstraintResultCaseUpdateJury's response\"add yyy\"−1018≤y≤1018−1018≤y≤1018-10^{18} \\le y \\le 10^{18}res=x+yres=x+y\\mathrm{res} = x + yif 1≤res≤1018if 1≤res≤1018\\text{if } 1 \\le \\mathrm{res} \\le 10^{18}x←resx←resx \\leftarrow \\mathrm{res}\"1\"elseelse\\mathrm{else}x←xx←xx \\leftarrow x\"0\"\"mul yyy\"1≤y≤10181≤y≤10181 \\le y \\le 10^{18}res=x⋅yres=x⋅y\\mathrm{res} = x \\cdot yif 1≤res≤1018if 1≤res≤1018\\text{if } 1 \\le \\mathrm{res} \\le 10^{18}x←resx←resx \\leftarrow \\mathrm{res}\"1\"elseelse\\mathrm{else}x←xx \\leftarrow x\"0\"\"div yy\"1≤y≤10181 \\le y \\le 10^{18}res=x/y\\mathrm{res} = x/yif y\\text{if } y divides xxx←resx \\leftarrow \\mathrm{res}\"1\"else\\mathrm{else}x←xx \\leftarrow x\"0\"\"digit\"—res=S(x)\\mathrm{res} = S(x)∗^{\\text{∗}}—x←resx \\leftarrow \\mathrm{res}\"1\" You have to make xx equal to nn using at most 4\\mathbf{4} commands.∗^{\\text{∗}}S(n)S(n) is a function that returns the sum of all the individual digits of a non-negative integer nn. For example, S(123)=1+2+3=6S(123) = 1 + 2 + 3 = 6"
  },
  {
    "title": "Hacking Numbers (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2109/C1",
    "description": "This is the easy version of the problem. In this version, you can send at most 77\\mathbf{7} commands. You can make hacks only if all versions of the problem are solved.This is an interactive problem.Welcome, Duelists! In this interactive challenge, there is an unknown integer xxx (1≤x≤1091≤x≤1091 \\le x \\le 10^9). You must make it equal to a given integer in the input nnn. By harnessing the power of \"Mathmech\" monsters, you can send a command to do one of the following: CommandConstraintResultCaseUpdateJury's response\"add yyy\"−1018≤y≤1018−1018≤y≤1018-10^{18} \\le y \\le 10^{18}res=x+yres=x+y\\mathrm{res} = x + yif 1≤res≤1018if 1≤res≤1018\\text{if } 1 \\le \\mathrm{res} \\le 10^{18}x←resx \\leftarrow \\mathrm{res}\"1\"else\\mathrm{else}x←xx \\leftarrow x\"0\"\"mul yy\"1≤y≤10181 \\le y \\le 10^{18}res=x⋅y\\mathrm{res} = x \\cdot yif 1≤res≤1018\\text{if } 1 \\le \\mathrm{res} \\le 10^{18}x←resx \\leftarrow \\mathrm{res}\"1\"else\\mathrm{else}x←xx \\leftarrow x\"0\"\"div yy\"1≤y≤10181 \\le y \\le 10^{18}res=x/y\\mathrm{res} = x/yif y\\text{if } y divides xxx←resx \\leftarrow \\mathrm{res}\"1\"else\\mathrm{else}x←xx \\leftarrow x\"0\"\"digit\"—res=S(x)\\mathrm{res} = S(x)∗^{\\text{∗}}—x←resx \\leftarrow \\mathrm{res}\"1\" You have to make xx equal to nn using at most 7\\mathbf{7} commands.∗^{\\text{∗}}S(n)S(n) is a function that returns the sum of all the individual digits of a non-negative integer nn. For example, S(123)=1+2+3=6S(123) = 1 + 2 + 3 = 6"
  },
  {
    "title": "Slice to Survive",
    "url": "https://codeforces.com/problemset/problem/2109/B",
    "description": "Duelists Mouf and Fouad enter the arena, which is an n×mn×mn \\times m grid!Fouad's monster starts at cell (a,b)(a, b), where rows are numbered 11 to nn and columns 11 to mm.Mouf and Fouad will keep duelling until the grid consists of only one cell.In each turn:   Mouf first cuts the grid along a row or column line into two parts, discarding the part without Fouad's monster. Note that the grid must have at least two cells; otherwise, the game has already ended.  After that, in the same turn, Fouad moves his monster to any cell (possibly the same one it was in) within the remaining grid.     Visualization of the phases of the fourth test case. Mouf wants to minimize the number of turns, while Fouad wants to maximize them. How many turns will this epic duel last if both play optimally?"
  },
  {
    "title": "It's Time To Duel",
    "url": "https://codeforces.com/problemset/problem/2109/A",
    "description": "Something you may not know about Mouf is that he is a big fan of the Yu-Gi-Oh! card game. He loves to duel with anyone he meets. To gather all fans who love to play as well, he decided to organize a big Yu-Gi-Oh! tournament and invited nnn players.Mouf arranged the nnn players in a line, numbered from 111 to nnn. They then held n−1n−1n - 1 consecutive duels: for each iii from 111 to n−1n−1n - 1, player iii faced player i+1i+1i + 1, producing one winner and one loser per match. Afterward, each player reports a value ai(0≤ai≤1)ai(0≤ai≤1)a_i(0 \\le a_i \\le 1):  000 indicating they won no duels;  111 indicating they won at least one duel. Since some may lie about their results (e.g., reporting a 111 instead of a 000, or vice versa) to influence prize outcomes, Mouf will cancel the tournament if he can prove any report to be false.Given the array aaa, determine whether at least one player must be lying."
  },
  {
    "title": "Fallen Towers",
    "url": "https://codeforces.com/problemset/problem/2108/F",
    "description": " Pizano built an array aaa of nnn towers, each consisting of ai≥0ai≥0a_i \\ge 0 blocks.Pizano can knock down a tower so that the next aiaia_i towers grow by 111. In other words, he can take the element aiaia_i, increase the next aiaia_i elements by one, and then set aiaia_i to 000. The blocks that fall outside the array of towers disappear. If Pizano knocks down a tower with 000 blocks, nothing happens.Pizano wants to knock down all nnn towers in any order, each exactly once. That is, for each iii from 111 to nnn, he will knock down the tower at position iii exactly once.Moreover, the resulting array of tower heights must be non-decreasing. This means that after he knocks down all nnn towers, for any i<ji<ji < j, the tower at position iii must not be taller than the tower at position jjj.You are required to output the maximum MEXMEX\\text{MEX} of the resulting array of tower heights.The MEXMEX\\text{MEX} of an array is the smallest non-negative integer that is not present in the array."
  },
  {
    "title": "Spruce Dispute",
    "url": "https://codeforces.com/problemset/problem/2108/E",
    "description": "  It's already a hot April outside, and Polycarp decided that this is the perfect time to finally take down the spruce tree he set up several years ago. As he spent several hours walking around it, gathering his strength, he noticed something curious: the spruce is actually a tree∗^{\\text{∗}} — and not just any tree, but one consisting of an odd number of vertices nn. Moreover, on n−1n-1 of the vertices hang Christmas ornaments, painted in exactly n−12\\frac{n-1}{2} distinct colors, with exactly two ornaments painted in each color. The remaining vertex, as tradition dictates, holds the tree's topper.At last, after several days of mental preparation, Polycarp began dismantling the spruce. First, he removed the topper and had already started taking apart some branches when suddenly a natural question struck him: how can he remove one of the tree's edges and rearrange the ornaments in such a way that the sum of the lengths of the simple paths between ornaments of the same color is as large as possible?In this problem, removing an edge from the tree is defined as follows: choose a pair of adjacent vertices aa and bb (a<ba < b), then remove vertex bb from the tree and reattach all of bb's adjacent vertices (except for aa) directly to aa.Polycarp cannot continue dismantling his spruce until he gets an answer to this question. However, checking all possible options would take him several more years. Knowing your experience in competitive programming, he turned to you for help. But can you solve this dispute?∗^{\\text{∗}}A tree is a connected graph without cycles. "
  },
  {
    "title": "Needle in a Numstack",
    "url": "https://codeforces.com/problemset/problem/2108/D",
    "description": "This is an interactive problem.You found the numbers kk and nn in the attic, but lost two arrays AA and BB.You remember that:  |A|+|B|=n|A| + |B| = n, the total length of the arrays is nn.  |A|≥k|A| \\geq k and |B|≥k|B| \\geq k, the length of each array is at least kk.  The arrays consist only of numbers from 11 to kk.  If you take any kk consecutive elements from array AA, they will all be different. Also, if you take any kk consecutive elements from array BB, they will all be different. Fortunately, a kind spirit that settled in the attic found these arrays and concatenated them into an array CC of length nn. That is, the elements of array AA were first written into array CC, followed by the elements of array BB.You can ask the kind spirit up to 250250 questions. Each question contains an index ii (1≤i≤n1 \\leq i \\leq n). In response, you will receive the ii-th element of the concatenated array CC.You need to find the lengths of arrays AA and BB, or report that it is impossible to determine them uniquely."
  },
  {
    "title": "Neo's Escape",
    "url": "https://codeforces.com/problemset/problem/2108/C",
    "description": " Neo wants to escape from the Matrix. In front of him are nn buttons arranged in a row. Each button has a weight given by an integer: a1,a2,…,ana_1, a_2, \\ldots, a_n.Neo is immobilized, but he can create and move clones. This means he can perform an unlimited number of actions of the following two types in any order:   Create a clone in front of a specific button.  Move an existing clone one position to the left or right. As soon as a clone is in front of another button that has not yet been pressed—regardless of whether he was created or moved — he immediately presses it. If the button has already been pressed, a clone does nothing — buttons can only be pressed once.For Neo to escape, he needs to press all the buttons in such an order that the sequence of their weights is non-increasing — that is, if b1,b2,…,bnb_1, b_2, \\ldots, b_n are the weights of the buttons in the order they are pressed, then it must hold that b1≥b2≥⋯≥bnb_1 \\geq b_2 \\geq \\cdots \\geq b_n.Your task is to determine the minimum number of clones that Neo needs to create in order to press all the buttons in a valid order."
  },
  {
    "title": "SUMdamental Decomposition",
    "url": "https://codeforces.com/problemset/problem/2108/B",
    "description": " On a recent birthday, your best friend Maurice gave you a pair of numbers nn and xx, and asked you to construct an array of positive numbers aa of length nn such that a1⊕a2⊕⋯⊕an=xa_1 \\oplus a_2 \\oplus \\cdots \\oplus a_n = x ∗^{\\text{∗}}. This task seemed too simple to you, and therefore you decided to give Maurice a return gift by constructing an array among all such arrays that has the smallest sum of its elements. You immediately thought of a suitable array; however, since writing it down turned out to be too time-consuming, Maurice will have to settle for just the sum of its elements.∗^{\\text{∗}}⊕\\oplus denotes the bitwise XOR operation. "
  },
  {
    "title": "Permutation Warm-Up",
    "url": "https://codeforces.com/problemset/problem/2108/A",
    "description": " For a permutation ppp of length nn∗^{\\text{∗}}, we define the function:f(p)=n∑i=1|pi−i| f(p) = \\sum_{i=1}^{n} \\lvert p_i - i \\rvert You are given a number nn. You need to compute how many distinct values the function f(p)f(p) can take when considering all possible permutations of the numbers from 11 to nn.∗^{\\text{∗}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). "
  },
  {
    "title": "Cycling (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2107/F2",
    "description": "This is the hard version of the problem. The difference between the versions is that in this version, 1≤n≤1061\\le n\\le 10^6 and you need to output the answer for each prefix. You can hack only if you solved all versions of this problem.Leo works as a programmer in the city center, and his lover teaches at a high school in the suburbs. Every weekend, Leo would ride his bike to the suburbs to spend a nice weekend with his lover.There are nn cyclists riding in front of Leo on this road right now. They are numbered 11, 22, …\\ldots, nn from front to back. Initially, Leo is behind the nn-th cyclist. The ii-th cyclist has an agility value aia_i. Leo wants to get ahead of the 11-st cyclist. Leo can take the following actions as many times as he wants:  Assuming that the first person in front of Leo is cyclist ii, he can go in front of cyclist ii for a cost of aia_i. This puts him behind cyclist i−1i - 1.  Using his super powers, swap aia_i and aja_j (1≤i<j≤n1\\le i < j\\le n) for a cost of (j−i)(j - i). Leo wants to know the minimum cost to get in front of the 11-st cyclist. In addition, he wants to know the answer for each 1≤i≤n1\\le i \\le n, [a1,a2,…,ai][a_1, a_2, \\ldots, a_i] as the original array. The problems of different ii are independent. To be more specific, in the ii-th problem, Leo starts behind the ii-th cyclist instead of the nn-th cyclist, and cyclists numbered i+1,i+2,…,ni + 1, i + 2, \\ldots, n are not present."
  },
  {
    "title": "Cycling (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2107/F1",
    "description": "This is the easy version of the problem. The difference between the versions is that in this version, 1≤n≤5⋅1031\\le n\\le 5\\cdot 10^3 and you don't need to output the answer for each prefix. You can hack only if you solved all versions of this problem.Leo works as a programmer in the city center, and his lover teaches at a high school in the suburbs. Every weekend, Leo would ride his bike to the suburbs to spend a nice weekend with his lover.There are nn cyclists riding in front of Leo on this road right now. They are numbered 11, 22, …\\ldots, nn from front to back. Initially, Leo is behind the nn-th cyclist. The ii-th cyclist has an agility value aia_i. Leo wants to get ahead of the 11-st cyclist. Leo can take the following actions as many times as he wants:  Assuming that the first person in front of Leo is cyclist ii, he can go in front of cyclist ii for a cost of aia_i. This puts him behind cyclist i−1i - 1.  Using his super powers, swap aia_i and aja_j (1≤i<j≤n1\\le i < j\\le n) for a cost of (j−i)(j - i). Leo wants to know the minimum cost to get in front of the 11-st cyclist. Here you only need to print the answer for the whole array, i.e. [a1,a2,…,an][a_1, a_2, \\ldots, a_n]."
  },
  {
    "title": "Ain and Apple Tree",
    "url": "https://codeforces.com/problemset/problem/2107/E",
    "description": "If I was also hit by an apple falling from an apple tree, could I become as good at physics as Newton?To be better at physics, Ain wants to build an apple tree so that she can get hit by apples on it. Her apple tree has nn nodes and is rooted at 11. She defines the weight of an apple tree as n∑i=1n∑j=i+1dep(lca(i,j))\\sum \\limits_{i=1}^n \\sum \\limits_{j=i+1}^n \\text{dep}(\\operatorname{lca}(i,j)). Here, dep(x)\\text{dep}(x) is defined as the number of edges on the unique shortest path from node 11 to node xx. lca(i,j)\\operatorname{lca}(i, j) is defined as the unique node xx with the largest value of dep(x)\\text{dep}(x) and which is present on both the paths (1,i)(1, i) and (1,j)(1, j).From some old books Ain reads, she knows that Newton's apple tree's weight is around kk, but the exact value of it is lost.As Ain's friend, you want to build an apple tree with nn nodes for her, and the absolute difference between your tree's weight and kk should be at most 11, i.e. |weight−k|≤1|\\text{weight} - k| \\le 1. Unfortunately, this is not always possible, in this case please report it. "
  },
  {
    "title": "Apple Tree Traversing",
    "url": "https://codeforces.com/problemset/problem/2107/D",
    "description": "There is an apple tree with nn nodes, initially with one apple at each node. You have a paper with you, initially with nothing written on it.You are traversing on the apple tree, by doing the following action as long as there is at least one apple left:  Choose an apple path (u,v)(u,v). A path (u,v)(u,v) is called an apple path if and only if for every node on the path (u,v)(u,v), there's an apple on it.  Let dd be the number of apples on the path, write down three numbers (d,u,v)(d,u,v), in this order, on the paper.  Then remove all the apples on the path (u,v)(u,v). Here, the path (u,v)(u, v) refers to the sequence of vertices on the unique shortest walk from uu to vv. Let the number sequence on the paper be aa. Your task is to find the lexicographically largest possible sequence aa. "
  },
  {
    "title": "Maximum Subarray Sum",
    "url": "https://codeforces.com/problemset/problem/2107/C",
    "description": "You are given an array a1,a2,…,ana_1,a_2,\\ldots,a_n of length nn and a positive integer kk, but some parts of the array aa are missing. Your task is to fill the missing part so that the maximum subarray sum∗^{\\text{∗}} of aa is exactly kk, or report that no solution exists.Formally, you are given a binary string ss and a partially filled array aa, where:  If you remember the value of aia_i, si=1s_i = 1 to indicate that, and you are given the real value of aia_i.  If you don't remember the value of aia_i, si=0s_i = 0 to indicate that, and you are given ai=0a_i = 0. All the values that you remember satisfy |ai|≤106|a_i| \\le 10^6. However, you may use values up to 101810^{18} to fill in the values that you do not remember. It can be proven that if a solution exists, a solution also exists satisfying |ai|≤1018|a_i| \\le 10^{18}. ∗^{\\text{∗}}The maximum subarray sum of an array aa of length nn, i.e. a1,a2,…ana_1, a_2, \\ldots a_n is defined as max1≤i≤j≤nS(i,j)\\max_{1 \\le i \\le j \\le n} S(i, j) where S(i,j)=ai+ai+1+…+ajS(i, j) = a_i + a_{i + 1} + \\ldots + a_j."
  },
  {
    "title": "Apples in Boxes",
    "url": "https://codeforces.com/problemset/problem/2107/B",
    "description": "Tom and Jerry found some apples in the basement. They decided to play a game to get some apples.There are nn boxes, and the ii-th box has aia_i apples inside. Tom and Jerry take turns picking up apples. Tom goes first. On their turn, they have to do the following:  Choose a box ii (1≤i≤n1 \\le i \\le n) with a positive number of apples, i.e. ai>0a_i > 0, and pick 11 apple from this box. Note that this reduces aia_i by 11.  If no valid box exists, the current player loses.  If after the move, max(a1,a2,…,an)−min(a1,a2,…,an)>k\\max(a_1, a_2, \\ldots, a_n) - \\min(a_1, a_2, \\ldots, a_n) > k holds, then the current player (who made the last move) also loses. If both players play optimally, predict the winner of the game."
  },
  {
    "title": "LRC and VIP",
    "url": "https://codeforces.com/problemset/problem/2107/A",
    "description": " You have an array aa of size nn — a1,a2,…ana_1, a_2, \\ldots a_n. You need to divide the nn elements into 22 sequences BB and CC, satisfying the following conditions:  Each element belongs to exactly one sequence.  Both sequences BB and CC contain at least one element.  gcd\\gcd (B1,B2,…,B|B|)≠gcd(C1,C2,…,C|C|)(B_1, B_2, \\ldots, B_{|B|}) \\ne \\gcd(C_1, C_2, \\ldots, C_{|C|}) ∗^{\\text{∗}} ∗^{\\text{∗}}gcd(x,y)\\gcd(x, y) denotes the greatest common divisor (GCD) of integers xx and yy. "
  },
  {
    "title": "Baudelaire (hard version)",
    "url": "https://codeforces.com/problemset/problem/2106/G2",
    "description": "This is the Hard Version of the problem. The only difference between the two versions is that in the Hard Version the tree may be of any shape.This problem is interactive.Baudelaire is very rich, so he bought a tree of size nnn, rooted at some arbitrary node. Additionally, every node has a value of 111 or −1−1-1. Cow the Nerd saw the tree and fell in love with it. However, computer science doesn't pay him enough, so he can't afford to buy it. Baudelaire decided to play a game with Cow the Nerd, and if he won, he would gift him the tree.Cow the Nerd does not know which node is the root, and he doesn't know the values of the nodes either. However, he can ask Baudelaire queries of two types:  111 kkk u1u1u_1 u2u2u_2 ......... ukuku_k: Let f(u)f(u)f(u) be the sum of the values of all nodes in the path from the root of the tree to node uuu. Cow the Nerd may choose an integer kkk (1≤k≤n)(1≤k≤n)(1 \\le k \\le n) and kkk nodes u1,u2,...,uku1,u2,...,uku_1, u_2, ..., u_k, and he will receive the value f(u1)+f(u2)+...+f(uk)f(u1)+f(u2)+...+f(uk)f(u_1) + f(u_2) + ... + f(u_k). 222 uuu: Baudelaire will toggle the value of node uuu. Specifically, if the value of uuu is 111, it will become −1−1-1, and vice versa. Cow the Nerd wins if he guesses the value of every node correctly (the values of the final tree, after performing the queries) within n+200n+200n + 200 total queries. Can you help him win?"
  },
  {
    "title": "Baudelaire (easy version)",
    "url": "https://codeforces.com/problemset/problem/2106/G1",
    "description": "This is the easy version of the problem. The only difference between the two versions is that in this version, it is guaranteed that every node is adjacent to node 11.This problem is interactive.Baudelaire is very rich, so he bought a tree of size nn that is rooted at some arbitrary node. Additionally, every node has a value of 11 or −1-1. In this version, every node is adjacent to node 11. However, please note that node 11 is not necessarily the root.Cow the Nerd saw the tree and fell in love with it. However, computer science doesn't pay him enough, so he can't afford to buy it. Baudelaire decided to play a game with Cow the Nerd, and if he won, he would gift him the tree.Cow the Nerd does not know which node is the root, and he doesn't know the values of the nodes either. However, he can ask Baudelaire queries of two types:  11 kk u1u_1 u2u_2 ...... uku_k: Let f(u)f(u) be the sum of the values of all nodes in the path from the root of the tree to node uu. Cow the Nerd may choose an integer kk (1≤k≤n)(1 \\le k \\le n) and kk nodes u1,u2,...,uku_1, u_2, ..., u_k, and he will receive the value f(u1)+f(u2)+...+f(uk)f(u_1) + f(u_2) + ... + f(u_k). 22 uu: Baudelaire will toggle the value of node uu. Specifically, if the value of uu is 11 it will become −1-1, and vice versa. Cow the Nerd wins if he guesses the value of every node correctly (the values of the final tree, after performing the queries) within n+200n + 200 total queries. Can you help him win?"
  },
  {
    "title": "Goblin",
    "url": "https://codeforces.com/problemset/problem/2106/F",
    "description": "Dr. TC has a new patient called Goblin. He wants to test Goblin's intelligence, but he has gotten bored of his standard test. So, he decided to make it a bit harder.First, he creates a binary string∗∗^{\\text{∗}} sss having nnn characters. Then, he creates nnn binary strings a1,a2,…,ana1,a2,…,ana_1, a_2, \\ldots, a_n. It is known that aiaia_i is created by first copying sss, then flipping the iii-th character (1\\texttt{1} becomes 0\\texttt{0} and vice versa). After creating all nn strings, he arranges them into an n×nn \\times n grid gg where gi,j=aijg_{i, j} = a_{i_j}. A set SS of size kk containing distinct integer pairs {(x1,y1),(x2,y2),…,(xk,yk)}\\{(x_1, y_1), (x_2, y_2), \\ldots, (x_k, y_k)\\} is considered good if:   1≤xi,yi≤n1 \\leq x_i, y_i \\leq n for all 1≤i≤k1 \\leq i \\leq k.  gxi,yi=0g_{x_i, y_i} = \\texttt{0} for all 1≤i≤k1 \\leq i \\leq k.  For any two integers ii and jj (1≤i,j≤k1 \\leq i, j \\leq k), coordinate (xi,yi)(x_i, y_i) is reachable from coordinate (xj,yj)(x_j, y_j) by traveling through a sequence of adjacent cells (which share a side) that all have a value of 0\\texttt{0}. Goblin's task is to find the maximum possible size of a good set SS. Because Dr. TC is generous, this time he gave him two seconds to find the answer instead of one. Goblin is not known for his honesty, so he has asked you to help him cheat.∗^{\\text{∗}}A binary string is a string that only consists of characters 1\\texttt{1} and 0\\texttt{0}."
  },
  {
    "title": "Wolf",
    "url": "https://codeforces.com/problemset/problem/2106/E",
    "description": "Wolf has found nnn sheep with tastiness values p1,p2,...,pnp_1, p_2, ..., p_n where pp is a permutation∗^{\\text{∗}}. Wolf wants to perform binary search on pp to find the sheep with tastiness of kk, but pp may not necessarily be sorted. The success of binary search on the range [l,r][l, r] for kk is represented as f(l,r,k)f(l, r, k), which is defined as follows:If l>rl > r, then f(l,r,k)f(l, r, k) fails. Otherwise, let m=⌊l+r2⌋m = \\lfloor\\frac{l + r}{2}\\rfloor, and:  If pm=kp_m = k, then f(l,r,k)f(l, r, k) is successful,  If pm<kp_m < k, then f(l,r,k)=f(m+1,r,k)f(l, r, k) = f(m+1, r, k),  If pm>kp_m > k, then f(l,r,k)=f(l,m−1,k)f(l, r, k) = f(l, m-1, k). Cow the Nerd decides to help Wolf out. Cow the Nerd is given qq queries, each consisting of three integers ll, rr, and kk. Before the search begins, Cow the Nerd may choose a non-negative integer dd, and dd indices 1≤i1<i2<…<id≤n1 \\le i_1 < i_2 < \\ldots < i_d \\le n where pij≠kp_{i_j} \\neq k over all 1≤j≤d1 \\leq j \\leq d. Then, he may re-order the elements pi1,pi2,...,pidp_{i_1}, p_{i_2}, ..., p_{i_d} however he likes.For each query, output the minimum integer dd that Cow the Nerd must choose so that f(l,r,k)f(l, r, k) can be successful, or report that it is impossible. Note that the queries are independent and the reordering is not actually performed.∗^{\\text{∗}}A permutation of length nn is an array that contains every integer from 11 to nn exactly once."
  },
  {
    "title": "Flower Boy",
    "url": "https://codeforces.com/problemset/problem/2106/D",
    "description": "Flower boy has a garden of nn flowers that can be represented as an integer sequence a1,a2,…,ana_1, a_2, \\dots, a_n, where aia_i is the beauty of the ii-th flower from the left.Igor wants to collect exactly mm flowers. To do so, he will walk the garden from left to right and choose whether to collect the flower at his current position. The ii-th flower among ones he collects must have a beauty of at least bib_i.Igor noticed that it might be impossible to collect mm flowers that satisfy his beauty requirements, so before he starts collecting flowers, he can pick any integer kk and use his magic wand to grow a new flower with beauty kk and place it anywhere in the garden (between two flowers, before the first flower, or after the last flower). Because his magic abilities are limited, he may do this at most once.Output the minimum integer kk Igor must pick when he performs the aforementioned operation to ensure that he can collect mm flowers. If he can collect mm flowers without using the operation, output 00. If it is impossible to collect mm flowers despite using the operation, output −1-1."
  },
  {
    "title": "Cherry Bomb",
    "url": "https://codeforces.com/problemset/problem/2106/C",
    "description": "Two integer arrays aa and bb of size nn are complementary if there exists an integer xx such that ai+bi=xa_i + b_i = x over all 1≤i≤n1 \\le i \\le n. For example, the arrays a=[2,1,4]a = [2, 1, 4] and b=[3,4,1]b = [3, 4, 1] are complementary, since ai+bi=5a_i + b_i = 5 over all 1≤i≤31 \\le i \\le 3. However, the arrays a=[1,3]a = [1, 3] and b=[2,1]b = [2, 1] are not complementary.Cow the Nerd thinks everybody is interested in math, so he gave Cherry Bomb two integer arrays aa and bb. It is known that aa and bb both contain nn non-negative integers not greater than kk. Unfortunately, Cherry Bomb has lost some elements in bb. Lost elements in bb are denoted with −1-1. Help Cherry Bomb count the number of possible arrays bb such that:  aa and bb are complementary.  All lost elements are replaced with non-negative integers no more than kk. "
  },
  {
    "title": "St",
    "url": "https://codeforces.com/problemset/problem/2106/B",
    "description": "Given a permutation∗^{\\text{∗}} pp of length nn that contains every integer from 00 to n−1n-1 and a strip of nn cells, St. Chroma will paint the ii-th cell of the strip in the color MEX(p1,p2,...,pi)\\operatorname{MEX}(p_1, p_2, ..., p_i)†^{\\text{†}}.For example, suppose p=[1,0,3,2]p = [1, 0, 3, 2]. Then, St. Chroma will paint the cells of the strip in the following way: [0,2,2,4][0, 2, 2, 4].You have been given two integers nn and xx. Because St. Chroma loves color xx, construct a permutation pp such that the number of cells in the strip that are painted color xx is maximized.∗^{\\text{∗}}A permutation of length nn is a sequence of nn elements that contains every integer from 00 to n−1n-1 exactly once. For example, [0,3,1,2][0, 3, 1, 2] is a permutation, but [1,2,0,1][1, 2, 0, 1] isn't since 11 appears twice, and [1,3,2][1, 3, 2] isn't since 00 does not appear at all.†^{\\text{†}}The MEX\\operatorname{MEX} of a sequence is defined as the first non-negative integer that does not appear in it. For example, MEX(1,3,0,2)=4\\operatorname{MEX}(1, 3, 0, 2) = 4, and MEX(3,1,2)=0\\operatorname{MEX}(3, 1, 2) = 0."
  },
  {
    "title": "Dr",
    "url": "https://codeforces.com/problemset/problem/2106/A",
    "description": "In order to test his patients' intelligence, Dr. TC created the following test.First, he creates a binary string∗^{\\text{∗}} ss having nn characters. Then, he creates nn binary strings a1,a2,…,ana_1, a_2, \\ldots, a_n. It is known that aia_i is created by first copying ss, then flipping the ii'th character (1\\texttt{1} becomes 0\\texttt{0} and vice versa). After creating all nn strings, he arranges them into a grid where the ii'th row is aia_i. For example,   If s=101s = \\texttt{101}, a=[001,111,100]a = [\\texttt{001}, \\texttt{111}, \\texttt{100}].  If s=0000s = \\texttt{0000}, a=[1000,0100,0010,0001]a = [\\texttt{1000}, \\texttt{0100}, \\texttt{0010}, \\texttt{0001}]. The patient needs to count the number of 11s written on the board in less than a second. Can you pass the test?∗^{\\text{∗}}A binary string is a string that only consists of characters 1\\texttt{1} and 0\\texttt{0}."
  },
  {
    "title": "Modulo 3",
    "url": "https://codeforces.com/problemset/problem/2104/G",
    "description": "Surely, you have seen problems which require you to output the answer modulo 109+710^9+7, 109+910^9+9, or 998244353998244353. But have you ever seen a problem where you have to print the answer modulo 33?You are given a functional graph consisting of nn vertices, numbered from 11 to nn. It is a directed graph, in which each vertex has exactly one outgoing arc. The graph is given as the array g1,g2,…,gng_1, g_2, \\dots, g_n, where gig_i means that there is an arc that goes from ii to gig_i. For some vertices, the outgoing arcs might be self-loops.Initially, all vertices of the graph are colored in color 11. You can perform the following operation: select a vertex and a color from 11 to kk, and then color this vertex and all vertices that are reachable from it. You can perform this operation any number of times (even zero).You should process qq queries. The query is described by three integers xx, yy and kk. For each query, you should:   assign gx:=yg_x := y;  then calculate the number of different graph colorings for the given value of kk (two colorings are different if there exists at least one vertex that is colored in different colors in these two colorings); since the answer can be very large, print it modulo 33. Note that in every query, the initial coloring of the graph is reset (all vertices initially have color 11 in each query)."
  },
  {
    "title": "Unpleasant Strings",
    "url": "https://codeforces.com/problemset/problem/2104/E",
    "description": "Let's call a letter allowed if it is a lowercase letter and is one of the first kk letters of the Latin alphabet.You are given a string ss of length nn, consisting only of allowed letters.Let's call a string tt pleasant if tt is a subsequence of ss.You are given qq strings t1,t2,…,tqt_1, t_2, \\dots, t_q. All of them consist only of allowed letters. For each string tit_i, calculate the minimum number of allowed letters you need to append to it on the right so that it stops being pleasant.A sequence tt is a subsequence of a sequence ss if tt can be obtained from ss by the deletion of several (possibly, zero or all) element from arbitrary positions. "
  },
  {
    "title": "Array and GCD",
    "url": "https://codeforces.com/problemset/problem/2104/D",
    "description": "You are given an integer array aa of size nn.You can perform the following operations any number of times (possibly, zero):   pay one coin and increase any element of the array by 11 (you must have at least 11 coin to perform this operation);  gain one coin and decrease any element of the array by 11. Let's say that an array is ideal if both of the following conditions hold:   each element of the array is at least 22;  for each pair of indices ii and jj (1≤i,j≤n1 \\le i, j \\le n; i≠ji \\ne j) the greatest common divisor (GCD) of aia_i and aja_j is equal to 11. If the array has less than 22 elements, this condition is automatically satisfied. Let's say that an array is beautiful if it can be transformed into an ideal array using the aforementioned operations, provided that you initially have no coins. If the array is already ideal, then it is also beautiful.The given array is not necessarily beautiful or ideal. You can remove any elements from it (including removing the entire array or not removing anything at all). Your task is to calculate the minimum number of elements you have to remove (possibly, zero) from the array aa to make it beautiful."
  },
  {
    "title": "Card Game",
    "url": "https://codeforces.com/problemset/problem/2104/C",
    "description": "Alice and Bob are playing a game. They have nn cards numbered from 11 to nn. At the beginning of the game, some of these cards are given to Alice, and the rest are given to Bob.Card with number ii beats card with number jj if and only if i>ji > j, with one exception: card 11 beats card nn.The game continues as long as each player has at least one card. During each turn, the following occurs:  Alice chooses one of her cards and places it face up on the table;  Bob, seeing Alice's card, chooses one of his cards and places it face up on the table;  if Alice's card beats Bob's card, both cards are taken by Alice. Otherwise, both cards are taken by Bob. A player can use a card that they have taken during one of the previous turns.The player who has no cards at the beginning of a turn loses. Determine who will win if both players play optimally."
  },
  {
    "title": "Move to the End",
    "url": "https://codeforces.com/problemset/problem/2104/B",
    "description": "You are given an array aa consisting of nn integers.For every integer kk from 11 to nn, you have to do the following:  choose an arbitrary element of aa and move it to the right end of the array (you can choose the last element, then the array won't change);  print the sum of kk last elements of aa;  move the element you've chosen on the first step to its original position (restore the original array aa). For every kk, you choose the element which you move so that the value you print is the maximum possible.Calculate the value you print for every kk."
  },
  {
    "title": "Three Decks",
    "url": "https://codeforces.com/problemset/problem/2104/A",
    "description": "Monocarp placed three decks of cards in a row on the table. The first deck consists of aa cards, the second deck consists of bb cards, and the third deck consists of cc cards, with the condition a<b<ca < b < c.Monocarp wants to take some number of cards (at least one, but no more than cc) from the third deck and distribute them between the first two decks so that each of the taken cards ends up in either the first or the second deck. It is possible that all the cards taken from the third deck will go into the same deck.Your task is to determine whether Monocarp can make the number of cards in all three decks equal using the described operation."
  },
  {
    "title": "Maximize Nor",
    "url": "https://codeforces.com/problemset/problem/2103/F",
    "description": "  The bitwise nor∗∗^{\\text{∗}} of an array of kk-bit integers b1,b2,…,bmb_1, b_2, \\ldots, b_m can be computed by calculating the bitwise nor cumulatively from left to right. More formally, nor(b1,b2,…,bm)=nor(nor(b1,b2,…,bm−1),bm)\\operatorname{nor}(b_1, b_2, \\ldots, b_m) = \\operatorname{nor}(\\operatorname{nor}(b_1, b_2, \\ldots, b_{m - 1}), b_m) for m≥2m\\ge 2, and nor(b1)=b1\\operatorname{nor}(b_1) = b_1.You are given an array of kk-bit integers a1,a2,…,ana_1, a_2, \\ldots, a_n. For each index ii (1≤i≤n1\\le i\\le n), find the maximum bitwise nor among all subarrays†^{\\text{†}} of aa containing index ii. In other words, for each index ii, find the maximum value of nor(al,al+1,…,ar)\\operatorname{nor}(a_l, a_{l+1}, \\ldots, a_r) among all 1≤l≤i≤r≤n1 \\le l \\le i \\le r \\le n.∗^{\\text{∗}} The logical nor of two boolean values is 11 if both values are 00, and 00 otherwise. The bitwise nor of two kk-bit integers is calculated by performing the logical nor operation on each pair of the corresponding bits.For example, let us compute nor(2,6)\\operatorname{nor}(2, 6) when they are represented as 44-bit numbers. In binary, 22=001020010_2 and 6=011026=0110_2. Therefore, nor(2,6)=10012=9\\operatorname{nor}(2,6) = 1001_2 = 9 as by performing the logical nor operations from left to right, we have:  nor(0,0)=1\\operatorname{nor}(0,0) = 1  nor(0,1)=0\\operatorname{nor}(0,1) = 0  nor(1,0)=0\\operatorname{nor}(1,0) = 0  nor(1,1)=0\\operatorname{nor}(1,1) = 0 Note that if 22 and 66 were represented as 33-bit integers instead, then nor(2,6)=1\\operatorname{nor}(2,6) = 1. †^{\\text{†}}An array xx is a subarray of an array yy if xx can be obtained from yy by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. "
  },
  {
    "title": "Keep the Sum",
    "url": "https://codeforces.com/problemset/problem/2103/E",
    "description": " You are given an integer kk and an array aa of length nn, where each element satisfies 0≤ai≤k0 \\le a_i \\le k for all 1≤i≤n1 \\le i \\le n. You can perform the following operation on the array:  Choose two distinct indices ii and jj (1≤i,j≤n1 \\le i,j \\le n and i≠ji \\neq j) such that ai+aj=ka_i + a_j = k.  Select an integer xx satisfying −aj≤x≤ai-a_j \\le x \\le a_i.  Decrease aia_i by xx and increase aja_j by xx. In other words, update ai:=ai−xa_i := a_i - x and aj:=aj+xa_j := a_j + x. Note that the constraints on xx ensure that all elements of array aa remain between 00 and kk throughout the operations.Your task is to determine whether it is possible to make the array aa non-decreasing∗^{\\text{∗}} using the above operation. If it is possible, find a sequence of at most 3n3n operations that transforms the array into a non-decreasing one.It can be proven that if it is possible to make the array non-decreasing using the above operation, there exists a solution that uses at most 3n3n operations.∗^{\\text{∗}} An array a1,a2,…,ana_1, a_2, \\ldots, a_n is said to be non-decreasing if for all 1≤i≤n−11 \\le i \\le n - 1, it holds that ai≤ai+1a_i \\le a_{i+1}. "
  },
  {
    "title": "Local Construction",
    "url": "https://codeforces.com/problemset/problem/2103/D",
    "description": "  An element bib_i (1≤i≤m1\\le i\\le m) in an array b1,b2,…,bmb_1, b_2, \\ldots, b_m is a local minimum if at least one of the following holds:   2≤i≤m−12\\le i\\le m - 1 and bi<bi−1b_i < b_{i - 1} and bi<bi+1b_i < b_{i + 1}, or  i=1i = 1 and b1<b2b_1 < b_2, or  i=mi = m and bm<bm−1b_m < b_{m - 1}. Similarly, an element bib_i (1≤i≤m1\\le i\\le m) in an array b1,b2,…,bmb_1, b_2, \\ldots, b_m is a local maximum if at least one of the following holds:   2≤i≤m−12\\le i\\le m - 1 and bi>bi−1b_i > b_{i - 1} and bi>bi+1b_i > b_{i + 1}, or  i=1i = 1 and b1>b2b_1 > b_2, or  i=mi = m and bm>bm−1b_m > b_{m - 1}. Note that local minima and maxima are not defined for arrays with only one element.There is a hidden permutation∗^{\\text{∗}} pp of length nn. The following two operations are applied to permutation pp alternately, starting from operation 1, until there is only one element left in pp:  Operation 1 — remove all elements of pp which are not local minima.  Operation 2 — remove all elements of pp which are not local maxima. More specifically, operation 1 is applied during every odd iteration, and operation 2 is applied during every even iteration, until there is only one element left in pp.For each index ii (1≤i≤n1\\le i\\le n), let aia_i be the iteration number that element pip_i is removed, or −1-1 if it was never removed.It can be proven that there will be only one element left in pp after at most ⌈log2n⌉\\lceil \\log_2 n\\rceil iterations (in other words, ai≤⌈log2n⌉a_i \\le \\lceil \\log_2 n\\rceil).You are given the array a1,a2,…,ana_1, a_2, \\ldots, a_n. Your task is to construct any permutation pp of nn elements that satisfies array aa.∗^{\\text{∗}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). "
  },
  {
    "title": "Median Splits",
    "url": "https://codeforces.com/problemset/problem/2103/C",
    "description": "  The median of an array b1,b2,…bmb_1, b_2, \\ldots b_m, written as med(b1,b2,…,bm)\\operatorname{med}(b_1, b_2, \\ldots, b_m), is the ⌈m2⌉\\left\\lceil \\frac{m}{2} \\right\\rceil-th∗^{\\text{∗}} smallest element of array bb.You are given an array of integers a1,a2,…,ana_1, a_2, \\ldots, a_n and an integer kk. You need to determine whether there exists a pair of indices 1≤l<r<n1 \\le l < r < n such that:med(med(a1,a2,…,al),med(al+1,al+2,…,ar),med(ar+1,ar+2,…,an))≤k.\\operatorname{med}(\\operatorname{med}(a_1, a_2, \\ldots, a_l), \\operatorname{med}(a_{l+1}, a_{l+2}, \\ldots, a_r), \\operatorname{med}(a_{r+1}, a_{r+2}, \\ldots, a_n)) \\le k.In other words, determine whether it is possible to split the array into three contiguous subarrays†^{\\text{†}} such that the median of the three subarray medians is less than or equal to kk.∗^{\\text{∗}}⌈x⌉\\lceil x \\rceil is the ceiling function which returns the least integer greater than or equal to xx.†^{\\text{†}}An array xx is a subarray of an array yy if xx can be obtained from yy by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. "
  },
  {
    "title": "Binary Typewriter",
    "url": "https://codeforces.com/problemset/problem/2103/B",
    "description": "  You are given a binary string sss of length nn and a typewriter with two buttons: 0 and 1. Initially, your finger is on the button 0. You can do the following two operations:  Press the button your finger is currently on. This will type out the character that is on the button.  Move your finger to the other button. If your finger is on button 0, move it to button 1, and vice versa. The cost of a binary string is defined as the minimum number of operations needed to type the entire string. Before typing, you may reverse at most one substring∗^{\\text{∗}} of ss. More formally, you can choose two indices 1≤l≤r≤n1\\le l\\le r\\le n, and reverse the substring sl…rs_{l\\ldots r}, resulting in the new string s1s2…sl−1srsr−1…slsr+1…sns_1s_2\\ldots s_{l-1}s_rs_{r-1}\\ldots s_ls_{r+1}\\ldots s_n. Your task is to find the minimum possible cost among all strings obtainable by performing at most one substring reversal on ss.∗^{\\text{∗}}A string aa is a substring of a string bb if aa can be obtained from bb by the deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end. "
  },
  {
    "title": "Common Multiple",
    "url": "https://codeforces.com/problemset/problem/2103/A",
    "description": " You are given an array of integers a1,a2,…,ana_1, a_2, \\ldots, a_n. An array x1,x2,…,xmx_1, x_2, \\ldots, x_m is beautiful if there exists an array y1,y2,…,ymy_1, y_2, \\ldots, y_m such that the elements of yy are distinct (in other words, yi≠yjy_i\\neq y_j for all 1≤i<j≤m1 \\le i < j \\le m), and the product of xix_i and yiy_i is the same for all 1≤i≤m1 \\le i \\le m (in other words, xi⋅yi=xj⋅yjx_i\\cdot y_i = x_j\\cdot y_j for all 1≤i<j≤m1 \\le i < j \\le m).Your task is to determine the maximum size of a subsequence∗^{\\text{∗}} of array aa that is beautiful.∗^{\\text{∗}}A sequence bb is a subsequence of a sequence aa if bb can be obtained from aa by the deletion of several (possibly, zero or all) element from arbitrary positions. "
  },
  {
    "title": "The Picky Cat",
    "url": "https://codeforces.com/problemset/problem/2102/B",
    "description": " You are given an array of integers a1,a2,…,ana_1, a_2, \\ldots, a_n. You are allowed to do the following operation any number of times (possibly zero):  Choose an index ii (1≤i≤n1\\le i\\le n). Multiply aia_i by −1-1 (i.e., update ai:=−aia_i := -a_i). Your task is to determine whether it is possible to make the element at index 11 become the median of the array after doing the above operation any number of times. Note that operations can be applied to index 11 as well, meaning the median can be either the original value of a1a_1 or its negation.The median of an array b1,b2,…,bmb_1, b_2, \\ldots, b_m is defined as the ⌈m2⌉\\left\\lceil \\frac{m}{2} \\right\\rceil-th∗^{\\text{∗}} smallest element of array bb. For example, the median of the array [3,1,2][3, 1, 2] is 22, while the median of the array [10,1,8,3][10, 1, 8, 3] is 33.It is guaranteed that the absolute value of the elements of aa are distinct. Formally, there are no pairs of indices 1≤i<j≤n1\\le i < j\\le n where |ai|=|aj||a_i| = |a_j|.∗^{\\text{∗}}⌈x⌉\\lceil x \\rceil is the ceiling function which returns the least integer greater than or equal to xx."
  },
  {
    "title": "Dinner Time",
    "url": "https://codeforces.com/problemset/problem/2102/A",
    "description": "Given four integers nn, mm, pp, and qq, determine whether there exists an integer array a1,a2,…,ana_1, a_2, \\ldots, a_n (elements may be negative) satisfying the following conditions:  The sum of all elements in the array is equal to mm: a1+a2+…+an=ma_1 + a_2 + \\ldots + a_n = m  The sum of every pp consecutive elements is equal to qq: ai+ai+1+…+ai+p−1=q, for all 1≤i≤n−p+1a_i + a_{i + 1} + \\ldots + a_{i + p - 1} = q,\\qquad\\text{ for all }1\\le i\\le n-p+1 "
  },
  {
    "title": "Shoo Shatters the Sunshine",
    "url": "https://codeforces.com/problemset/problem/2101/F",
    "description": " You are given a tree with nn vertices, where each vertex can be colored red, blue, or white. The coolness of a coloring is defined as the maximum distance∗^{\\text{∗}} between a red and a blue vertex.Formally, if we denote the color of the ii-th vertex as cic_i, the coolness of a coloring is maxd(u,v)\\max d(u, v) over all pairs of vertices 1≤u,v≤n1\\le u, v\\le n where cuc_u is red and cvc_v is blue. If there are no red or no blue vertices, the coolness is zero.Your task is to calculate the sum of coolness over all 3n3^n possible colorings of the tree, modulo 998244353998\\,244\\,353.∗^{\\text{∗}}The distance between two vertices aa and bb in a tree is equal to the number of edges on the unique simple path between vertex aa and vertex bb."
  },
  {
    "title": "Kia Bakes a Cake",
    "url": "https://codeforces.com/problemset/problem/2101/E",
    "description": " You are given a binary string ss of length nn and a tree TT with nn vertices. Let kk be the number of 1s in ss. We will construct a complete undirected weighted graph with kk vertices as follows:  For each 1≤i≤n1\\le i\\le n with si=1s_i = \\mathtt{1}, create a vertex labeled ii.  For any two vertices labeled uu and vv that are created in the above step, define the edge weight between them w(u,v)w(u, v) as the distance∗^{\\text{∗}} between vertex uu and vertex vv in the tree TT. A simple path†^{\\text{†}} that visits vertices labeled v1,v2,…,vmv_1, v_2, \\ldots, v_m in this order is nice if for all 1≤i≤m−21\\le i\\le m - 2, the condition 2⋅w(vi,vi+1)≤w(vi+1,vi+2)2\\cdot w(v_i, v_{i + 1})\\le w(v_{i + 1}, v_{i + 2}) holds. In other words, the weight of each edge in the path must be at least twice the weight of the previous edge. Note that svi=1s_{v_i} = \\mathtt{1} has to be satisfied for all 1≤i≤m1\\le i\\le m, as otherwise, there would be no vertex with the corresponding label.For each vertex labeled ii (1≤i≤n1\\le i\\le n and si=1s_i = \\mathtt{1}) in the complete undirected weighted graph, determine the maximum number of vertices in any nice simple path starting from the vertex labeled ii.∗^{\\text{∗}}The distance between two vertices aa and bb in a tree is equal to the number of edges on the unique simple path between vertex aa and vertex bb.†^{\\text{†}}A path is a sequence of vertices v1,v2,…,vmv_1, v_2, \\ldots, v_m such that there is an edge between viv_i and vi+1v_{i + 1} for all 1≤i≤m−11\\le i\\le m - 1. A simple path is a path with no repeated vertices, i.e., vi≠vjv_i\\neq v_j for all 1≤i<j≤m1\\le i < j\\le m."
  },
  {
    "title": "Mani and Segments",
    "url": "https://codeforces.com/problemset/problem/2101/D",
    "description": "    An array bb of length |b||b| is cute if the sum of the length of its Longest Increasing Subsequence (LIS) and the length of its Longest Decreasing Subsequence (LDS)∗^{\\text{∗}} is exactly one more than the length of the array. More formally, the array bb is cute if LIS(b)+LDS(b)=|b|+1\\operatorname{LIS}(b) + \\operatorname{LDS}(b) = |b| + 1.You are given a permutation aa of length nn†^{\\text{†}}. Your task is to count the number of non-empty subarrays‡^{\\text{‡}} of permutation aa that are cute.∗^{\\text{∗}}A sequence xx is a subsequence of a sequence yy if xx can be obtained from yy by the deletion of several (possibly, zero or all) element from arbitrary positions. The longest increasing (decreasing) subsequence of an array is the longest subsequence such that its elements are ordered in strictly increasing (decreasing) order.†^{\\text{†}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). ‡^{\\text{‡}}An array xx is a subarray of an array yy if xx can be obtained from yy by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. "
  },
  {
    "title": "23 Kingdom",
    "url": "https://codeforces.com/problemset/problem/2101/C",
    "description": " The distance of a value xx in an array cc, denoted as dx(c)d_x(c), is defined as the largest gap between any two occurrences of xx in cc. Formally, dx(c)=max(j−i)d_x(c) = \\max(j - i) over all pairs i<ji < j where ci=cj=xc_i = c_j = x. If xx appears only once or not at all in cc, then dx(c)=0d_x(c) = 0. The beauty of an array is the sum of the distances of each distinct value in the array. Formally, the beauty of an array cc is equal to ∑1≤x≤ndx(c)\\sum\\limits_{1\\le x\\le n} d_x(c).Given an array aa of length nn, an array bb is nice if it also has length nn and its elements satisfy 1≤bi≤ai1\\le b_i\\le a_i for all 1≤i≤n1\\le i\\le n. Your task is to find the maximum possible beauty of any nice array."
  },
  {
    "title": "Quartet Swapping",
    "url": "https://codeforces.com/problemset/problem/2101/B",
    "description": "   You are given a permutation aa of length nn∗^{\\text{∗}}. You are allowed to do the following operation any number of times (possibly zero):  Choose an index 1≤i≤n−31\\le i\\le n - 3. Then, swap aia_i with ai+2a_{i + 2}, and ai+1a_{i + 1} with ai+3a_{i + 3} simultaneously. In other words, permutation aa will be transformed from […,ai,ai+1,ai+2,ai+3,…][\\ldots, a_i, a_{i+1}, a_{i+2}, a_{i+3}, \\ldots] to […,ai+2,ai+3,ai,ai+1,…][\\ldots, a_{i+2}, a_{i+3}, a_{i}, a_{i+1}, \\ldots]. Determine the lexicographically smallest permutation†^{\\text{†}} that can be obtained by applying the above operation any number of times.∗^{\\text{∗}}A permutation of length nn is an array consisting of nn distinct integers from 11 to nn in arbitrary order. For example, [2,3,1,5,4][2,3,1,5,4] is a permutation, but [1,2,2][1,2,2] is not a permutation (22 appears twice in the array), and [1,3,4][1,3,4] is also not a permutation (n=3n=3 but there is 44 in the array). †^{\\text{†}}An array xx is lexicographically smaller than an array yy of the same size if and only if the following holds:   in the first position where xx and yy differ, the array xx has a smaller element than the corresponding element in yy.  "
  },
  {
    "title": "Mex in the Grid",
    "url": "https://codeforces.com/problemset/problem/2101/A",
    "description": " You are given n2n^2 cards with values from 00 to n2−1n^2-1. You are to arrange them in a nn by nn grid such that there is exactly one card in each cell.The MEX (minimum excluded value) of a subgrid∗^{\\text{∗}} is defined as the smallest non-negative integer that does not appear in the subgrid.Your task is to arrange the cards such that the sum of MEX values over all (n(n+1)2)2\\left(\\frac{n(n+1)}{2}\\right)^2 subgrids is maximized.∗^{\\text{∗}}A subgrid of a nn by nn grid is specified by four numbers l1,r1,l2,r2l_1, r_1, l_2, r_2 satisfying 1≤l1≤r1≤n1\\le l_1\\le r_1\\le n and 1≤l2≤r2≤n1\\le l_2\\le r_2\\le n. The element in the ii-th row and the jj-th column of the grid is part of the subgrid if and only if l1≤i≤r1l_1\\le i\\le r_1 and l2≤j≤r2l_2\\le j\\le r_2."
  },
  {
    "title": "Sasha and the Apartment Purchase",
    "url": "https://codeforces.com/problemset/problem/2098/B",
    "description": "Sasha wants to buy an apartment on a street where the houses are numbered from 11 to 10910^9 from left to right.There are nn bars on this street, located in houses with numbers a1,a2,…,ana_1, a_2, \\ldots, a_n. Note that there might be multiple bars in the same house, and in this case, these bars are considered distinct.Sasha is afraid that by the time he buys the apartment, some bars may close, but no more than kk bars can close.For any house with number xx, define f(x)f(x) as the sum of |x−y||x - y| over all open bars yy (that is, after closing some bars).Sasha can potentially buy an apartment in a house with number xx (where 1≤x≤1091 \\le x \\le 10^9) if and only if it is possible to close at most kk bars so that after that f(x)f(x) becomes minimal among all houses.Determine how many different houses Sasha can potentially buy an apartment in."
  },
  {
    "title": "Vadim's Collection",
    "url": "https://codeforces.com/problemset/problem/2098/A",
    "description": "We call a phone number a beautiful if it is a string of 101010 digits, where the ii-th digit from the left is at least 10−i10 - i. That is, the first digit must be at least 99, the second at least 88, …\\ldots, with the last digit being at least 00.For example, 9988776655 is a beautiful phone number, while 9099999999 is not, since the second digit, which is 00, is less than 88.Vadim has a beautiful phone number. He wants to rearrange its digits in such a way that the result is the smallest possible beautiful phone number. Help Vadim solve this problem.Please note that the phone numbers are compared as integers."
  },
  {
    "title": "Lost Luggage",
    "url": "https://codeforces.com/problemset/problem/2097/F",
    "description": "As is known, the airline \"Trouble\" often loses luggage, and concerned journalists decided to calculate the maximum number of luggage pieces that may not return to travelers.The airline \"Trouble\" operates flights between nn airports, numbered from 11 to nn. The journalists' experiment will last for mm days. It is known that at midnight before the first day of the experiment, there were sjs_j lost pieces of luggage in the jj-th airport. On the ii-th day, the following occurs:  In the morning, 2n2n flights take off simultaneously, including nn flights of the first type and nn flights of the second type.   The jj-th flight of the first type flies from airport jj to airport (((j−2)modn)+1)(((j-2) \\bmod n )+ 1) (the previous airport, with the first airport being the last), and it can carry no more than ai,ja_{i,j} lost pieces of luggage.  The jj-th flight of the second type flies from airport jj to airport ((jmodn)+1)((j \\bmod n) + 1) (the next airport, with the last airport being the first), and it can carry no more than ci,jc_{i,j} lost pieces of luggage.   In the afternoon, a check of lost luggage is conducted at the airports. If after the flights have departed on that day, there are xx pieces of luggage remaining in the jj-th airport and x≥bi,jx \\ge b_{i, j}, then at least x−bi,jx - b_{i, j} pieces of luggage are found, and they cease to be lost.  In the evening, all 2n2n flights conclude, and the lost luggage transported that day arrives at the corresponding airports. For each kk from 11 to mm, the journalists want to know the maximum number of lost pieces of luggage that may be unfound during the checks over the first kk days. Note that for each kk, these values are calculated independently."
  },
  {
    "title": "Clearing the Snowdrift",
    "url": "https://codeforces.com/problemset/problem/2097/E",
    "description": "Boy Vasya loves to travel very much. In particular, flying in airplanes brings him extraordinary pleasure. He was about to fly to another city, but the runway was heavily covered with snow and needed to be cleared.The runway can be represented as nn consecutive sections numbered from 11 to nn. The snowstorm was quite strong, but it has already stopped, so Vasya managed to calculate that the ii-th section is covered with aia_i meters of snow. For such situations, the airport has a snowplow that works in a rather unusual way. In one minute, the snowplow can do the following:  Choose a consecutive segment of length no more than dd and remove one meter of snow from the most snow-covered sections.Formally, one can choose 1≤l≤r≤n1 \\le l \\le r \\le n (r−l+1≤dr - l + 1 \\le d). After that, c=max{al,al+1,…,ar}c = \\max \\{ a_l, a_{l + 1}, \\ldots , a_r \\} is calculated, and if c>0c > 0, then for all i:l≤i≤ri \\colon l \\le i \\le r such that ai=ca_i = c, the value of aia_i is decreased by one. Vasya has been preparing for the flight for a long time and wants to understand how much time he has left to wait until all sections are completely cleared of snow. In other words, it is required to calculate the minimum number of minutes that the snowplow will need to achieve ai=0a_i = 0 for all ii from 11 to nn."
  },
  {
    "title": "Homework",
    "url": "https://codeforces.com/problemset/problem/2097/D",
    "description": "Some teachers work at the educational center \"Sirius\" while simultaneously studying at the university. In this case, the trip does not exempt them from completing their homework, so they do their homework right on the plane. Artem is one of those teachers, and he was assigned the following homework at the university.With an arbitrary string aa of even length mm, he can perform the following operation. Artem splits the string aa into two halves xx and yy of equal length, after which he performs exactly one of three actions:   For each i∈{1,2,…,m2}i \\in \\left\\{ 1, 2, \\ldots, \\frac{m}{2}\\right\\} assign xi=(xi+yi)mod2x_i = (x_i + y_i) \\bmod 2;  For each i∈{1,2,…,m2}i \\in \\left\\{ 1, 2, \\ldots, \\frac{m}{2}\\right\\} assign yi=(xi+yi)mod2y_i = (x_i + y_i) \\bmod 2;  Perform an arbitrary number of operations (the same operations defined above, applied recursively) on the strings xx and yy, independently of each other. Note that in this case, the strings xx and yy must be of even length.  After that, the string aa is replaced by the strings xx and yy, concatenated in the same order.Unfortunately, Artem fell asleep on the plane, so you will have to complete his homework. Artem has two binary strings ss and tt of length nn, each consisting of nn characters 0 or 1. Determine whether it is possible to make string ss equal to string tt with an arbitrary number of operations."
  },
  {
    "title": "Bermuda Triangle",
    "url": "https://codeforces.com/problemset/problem/2097/C",
    "description": "The Bermuda Triangle — a mysterious area in the Atlantic Ocean where, according to rumors, ships and airplanes disappear without a trace. Some blame magnetic anomalies, others — portals to other worlds, but the truth remains hidden in a fog of mysteries.A regular passenger flight 814 was traveling from Miami to Nassau on a clear sunny day. Nothing foreshadowed trouble until the plane entered a zone of strange flickering fog. Radio communication was interrupted, the instruments spun wildly, and flashes of unearthly light flickered outside the windows.For simplicity, we will assume that the Bermuda Triangle and the airplane are on a plane, and the vertices of the triangle have coordinates (0,0)(0, 0), (0,n)(0, n), and (n,0)(n, 0). Initially, the airplane is located at the point (x,y)(x, y) strictly inside the Bermuda Triangle and is moving with a velocity vector (vx,vy)(v_x, v_y). All instruments have failed, so the crew cannot control the airplane.The airplane can escape from the triangle if it ever reaches exactly one of the vertices of the triangle. However, if at any moment (possibly non-integer) the airplane hits the boundary of the triangle (but not at a vertex), its velocity vector is immediately reflected relative to that side†^\\dagger, and the airplane continues to move in the new direction.Determine whether the airplane can ever escape from the Bermuda Triangle (i.e., reach exactly one of its vertices). If this is possible, also calculate how many times before that moment the airplane will hit the boundary of the triangle (each touch of the boundary, even at the same point, counts; crossing a vertex does not count).†^\\dagger Reflection occurs according to the usual laws of physics. The angle of incidence equals the angle of reflection."
  },
  {
    "title": "Baggage Claim",
    "url": "https://codeforces.com/problemset/problem/2097/B",
    "description": "Every airport has a baggage claim area, and Balbesovo Airport is no exception. At some point, one of the administrators at Sheremetyevo came up with an unusual idea: to change the traditional shape of the baggage claim conveyor from a carousel to a more complex form.Suppose that the baggage claim area is represented as a rectangular grid of size n×mn \\times m. The administration proposed that the path of the conveyor should pass through the cells p1,p2,…,p2k+1p_1, p_2, \\ldots, p_{2k+1}, where pi=(xi,yi)p_i = (x_i, y_i).For each cell pip_i and the next cell pi+1p_{i+1} (where 1≤i≤2k1 \\leq i \\leq 2k), these cells must share a common side. Additionally, the path must be simple, meaning that for no pair of indices i≠ji \\neq j should the cells pip_i and pjp_j coincide.Unfortunately, the route plan was accidentally spoiled by spilled coffee, and only the cells with odd indices of the path were preserved: p1,p3,p5,…,p2k+1p_1, p_3, p_5, \\ldots, p_{2k+1}. Your task is to determine the number of ways to restore the original complete path p1,p2,…,p2k+1p_1, p_2, \\ldots, p_{2k+1} given these k+1k+1 cells.Since the answer can be very large, output it modulo 109+710^9+7."
  },
  {
    "title": "Sports Betting",
    "url": "https://codeforces.com/problemset/problem/2097/A",
    "description": "The boarding process for various flights can occur in different ways: either by bus or through a telescopic jet bridge. Every day, exactly one flight is made from St. Petersburg to Minsk, and Vadim decided to demonstrate to the students that he always knows in advance how the boarding will take place.Vadim made a bet with nn students, and with the ii-th student, he made a bet on day aia_i. Vadim wins the bet if he correctly predicts the boarding process on both day ai+1a_i+1 and day ai+2a_i+2.Although Vadim does not know in advance how the boarding will occur, he really wants to win the bet at least with one student and convince him of his predictive abilities. Check if there exists a strategy for Vadim that allows him to guarantee success."
  },
  {
    "title": "Wonderful XOR Problem",
    "url": "https://codeforces.com/problemset/problem/2096/H",
    "description": "You are the proud... never mind, just solve this problem.There are nn intervals [l1,r1],[l2,r2],…[ln,rn][l_1, r_1], [l_2, r_2], \\ldots [l_n, r_n]. For each xx from 00 to 2m−12^m - 1, find the number, modulo 998244353998\\,244\\,353, of sequences a1,a2,…ana_1, a_2, \\ldots a_n such that: li≤ai≤ril_i \\leq a_i \\leq r_i for all ii from 11 to nn;  a1⊕a2⊕…⊕an=xa_1 \\oplus a_2 \\oplus \\ldots \\oplus a_n = x, where ⊕\\oplus denotes the bitwise XOR operator. "
  },
  {
    "title": "Wonderful Guessing Game",
    "url": "https://codeforces.com/problemset/problem/2096/G",
    "description": "This is an interactive problem.You are a proud teacher at the Millennium Science School. Today, a student named Alice challenges you to a guessing game.Alice is thinking of an integer from 11 to nn, and you must guess it by asking her some queries.To make things harder, she says you must ask all the queries first, and she will ignore exactly 11 query.For each query, you choose an array of kk distinct integers from 11 to nn, where kk is even. Then, Alice will respond with one of the following: L\\texttt{L}: the number is one of the first k2\\frac{k}{2} elements of the array;  R\\texttt{R}: the number is one of the last k2\\frac{k}{2} elements of the array;  N\\texttt{N}: the number is not in the array;  ?\\texttt{?}: this query is ignored.Alice is impatient, so you must find a strategy that minimizes the number of queries. Can you do it?Formally, let f(n)f(n) be the minimum number of queries required to determine Alice's number. Then you must find a strategy that uses exactly f(n)f(n) queries.Note that the interactor is adaptive, which means Alice's number is not fixed at the beginning and may depend on your queries. However, it is guaranteed that there exists at least one number that is consistent with Alice's responses.We can show that f(n)≤20f(n) \\leq 20 for all nn such that 2≤n≤2⋅1052 \\le n \\le 2 \\cdot 10^5."
  },
  {
    "title": "Wonderful Impostors",
    "url": "https://codeforces.com/problemset/problem/2096/F",
    "description": "You are a proud live streamer known as Gigi Murin. Today, you will play a game with nn viewers numbered 11 to nn.In the game, each player is either a crewmate or an impostor. You don't know the role of each viewer.There are mm statements numbered 11 to mm, which are either true or false. For each ii from 11 to mm, statement ii is one of two types: 0aibi0\\:a_i\\:b_i (1≤ai≤bi≤n1 \\leq a_i \\leq b_i \\leq n) — there are no impostors among viewers ai,ai+1,…,bia_i, a_i + 1, \\ldots, b_i; 1aibi1\\:a_i\\:b_i (1≤ai≤bi≤n1 \\leq a_i \\leq b_i \\leq n) — there is at least one impostor among viewers ai,ai+1,…,bia_i, a_i + 1, \\ldots, b_i.Answer qq questions of the following form: lrl\\:r (1≤l≤r≤m1 \\leq l \\leq r \\leq m) — is it possible that statements l,l+1,…,rl, l + 1, \\ldots, r are all true?Note that it is not guaranteed that there is at least one impostor among all viewers, and it is not guaranteed that there is at least one crewmate among all viewers."
  },
  {
    "title": "Wonderful Teddy Bears",
    "url": "https://codeforces.com/problemset/problem/2096/E",
    "description": "You are the proud owner of nn teddy bears, which are arranged in a row on a shelf. Each teddy bear is colored either black or pink.An arrangement of teddy bears is beautiful if all the black teddy bears are to the left of all the pink teddy bears. In other words, there does not exist a pair of indices (i,j)(i, j) (1≤i<j≤n1 \\leq i < j \\leq n) such that the ii-th teddy bear is pink, and the jj-th teddy bear is black.You want to reorder the teddy bears into a beautiful arrangement. You are too short to reach the shelf, but luckily, you can send instructions to a robot to move the teddy bears around. In a single instruction, the robot can:  Choose an index ii (1≤i≤n−21 \\le i \\le n - 2) and reorder the teddy bears at positions ii, i+1i + 1 and i+2i + 2 so that all the black teddy bears are to the left of all the pink teddy bears. What is the minimum number of instructions needed to reorder the teddy bears?"
  },
  {
    "title": "Wonderful Lightbulbs",
    "url": "https://codeforces.com/problemset/problem/2096/D",
    "description": "You are the proud owner of an infinitely large grid of lightbulbs, represented by a Cartesian coordinate system. Initially, all of the lightbulbs are turned off, except for one lightbulb, where you buried your proudest treasure.In order to hide your treasure's position, you perform the following operation an arbitrary number of times (possibly zero):  Choose two integer numbers xx and yy, and switch the state of the 44 lightbulbs at (x,y)(x, y), (x,y+1)(x, y + 1), (x+1,y−1)(x + 1, y - 1), and (x+1,y)(x + 1, y). In other words, for each lightbulb, turn it on if it was off, and turn it off if it was on. Note that there are no constraints on xx and yy. In the end, there are nn lightbulbs turned on at coordinates (x1,y1),(x2,y2),…,(xn,yn)(x_1, y_1), (x_2, y_2), \\ldots, (x_n, y_n). Unfortunately, you have already forgotten where you buried your treasure, so now you have to figure out one possible position of the treasure. Good luck!"
  },
  {
    "title": "Wonderful City",
    "url": "https://codeforces.com/problemset/problem/2096/C",
    "description": "You are the proud leader of a city in Ancient Berland. There are n2n^2 buildings arranged in a grid of nn rows and nn columns. The height of the building in row ii and column jj is hi,jh_{i, j}.The city is beautiful if no two adjacent by side buildings have the same height. In other words, it must satisfy the following:  There does not exist a position (i,j)(i, j) (1≤i≤n1 \\leq i \\leq n, 1≤j≤n−11 \\leq j \\leq n - 1) such that hi,j=hi,j+1h_{i, j} = h_{i, j + 1}.  There does not exist a position (i,j)(i, j) (1≤i≤n−11 \\leq i \\leq n - 1, 1≤j≤n1 \\leq j \\leq n) such that hi,j=hi+1,jh_{i, j} = h_{i + 1, j}. There are nn workers at company A, and nn workers at company B. Each worker can be hired at most once.It costs aia_i coins to hire worker ii at company A. After hiring, worker ii will:  Increase the heights of all buildings in row ii by 11. In other words, increase hi,1,hi,2,…,hi,nh_{i, 1}, h_{i, 2}, \\ldots, h_{i, n} by 11. It costs bjb_j coins to hire worker jj at company B. After hiring, worker jj will:  Increase the heights of all buildings in column jj by 11. In other words, increase h1,j,h2,j,…,hn,jh_{1, j}, h_{2, j}, \\ldots, h_{n, j} by 11. Find the minimum number of coins needed to make the city beautiful, or report that it is impossible."
  },
  {
    "title": "Wonderful Gloves",
    "url": "https://codeforces.com/problemset/problem/2096/B",
    "description": "You are the proud owner of many colorful gloves, and you keep them in a drawer. Each glove is in one of nnn colors numbered 11 to nn. Specifically, for each ii from 11 to nn, you have lil_i left gloves and rir_i right gloves with color ii.Unfortunately, it's late at night, so you can't see any of your gloves. In other words, you will only know the color and the type (left or right) of a glove after you take it out of the drawer.A matching pair of gloves with color ii consists of exactly one left glove and one right glove with color ii. Find the minimum number of gloves you need to take out of the drawer to guarantee that you have at least kk matching pairs of gloves with different colors.Formally, find the smallest positive integer xx such that:  For any set of xx gloves you take out of the drawer, there will always be at least kk matching pairs of gloves with different colors. "
  },
  {
    "title": "Wonderful Sticks",
    "url": "https://codeforces.com/problemset/problem/2096/A",
    "description": "You are the proud owner of nn sticks. Each stick has an integer length from 11 to nn. The lengths of the sticks are distinct.You want to arrange the sticks in a row. There is a string ss of length n−1n - 1 that describes the requirements of the arrangement.Specifically, for each ii from 11 to n−1n - 1: If si=<s_i = \\texttt{<}, then the length of the stick at position i+1i + 1 must be smaller than all sticks before it;  If si=>s_i = \\texttt{>}, then the length of the stick at position i+1i + 1 must be larger than all sticks before it.Find any valid arrangement of sticks. We can show that an answer always exists."
  },
  {
    "title": "Premiere at a Wrong Time",
    "url": "https://codeforces.com/problemset/problem/2095/J",
    "description": "No description"
  },
  {
    "title": "Mysterious Script",
    "url": "https://codeforces.com/problemset/problem/2095/I",
    "description": "An extraterrestrial species has visited the authors of April Fools Day Contest 2025 while they were preparing problems. They call themselves the \"Balikons\" and expressed interest in chatting with humans. Although they can make sounds that are similar to human speech, they seem to prefer communicating by writing using a variety of media.  Figure 1. A Balikon entity communicates with a human linguist (2025, colorized) Fortunately, there is a linguistics expert in the author team. With some effort, they were eventually able to fully understand the Balikon language. The following is a table of some example phrases they translated. Balikon scriptLatin scriptTranslationbalikonBalikonbalikong shasthree Balikonsfibucho shezali kin chakog leshasbuy shezali∗^{\\text{∗}} for twelve chakos†^{\\text{†}}fibuchog zinfa bashin(I) bought the wrong penshons ze tes to les konbilo lonshonletashashaleteshatesfive plus seven minus one modulo 998244358 Table 1. A few pieces of text in the Balikon language After some conversations, the Balikons learned about a popular human activity called competitive programming and were excited to try. In fact, they just created their first problem. Please check it out!∗^{\\text{∗}}a dish in traditional Balikon cuisine, similar to meatballs†^{\\text{†}}currency unit"
  },
  {
    "title": "Blurry Vision",
    "url": "https://codeforces.com/problemset/problem/2095/H",
    "description": " Please direct your vision to line number xx. Now, read the word you see on that line. If you struggle, I might have to prescribe eyeglasses. "
  },
  {
    "title": "Definitely a Geometry Problem",
    "url": "https://codeforces.com/problemset/problem/2095/G",
    "description": "Megumin is a wizard who can cast powerful magic spells that affect large areas. She is obsessed with the extremely devastating Explosion spell that can destroy everything around its target.There are currently nn slimes in the wild. Each slime's location can be described in 2D Cartesian coordinates. Megumin wishes to kill at least kk slimes so she can earn more experience points to level up her Explosion. To do that, she can choose any circle on the plane and cast an Explosion spell which kills every slime inside or on the border of the circle.However, the Explosion magic requires a large amount of mana to cast, and Megumin can only use it once per day. The amount of mana used is equal to the area inside the circle she chooses. What is the minimum amount of mana she needs to spend to kill kk slimes with a single Explosion?"
  },
  {
    "title": "⅓ оf а Рrоblеm",
    "url": "https://codeforces.com/problemset/problem/2095/F",
    "description": "a4+−+−)2a\\qquad \\mathord{4}\\qquad \\mathord{+}\\qquad \\mathord{-}\\qquad \\mathord{+}\\qquad \\mathord{-}\\qquad \\mathord{)}\\qquad \\mathord{2}"
  },
  {
    "title": "Pair Count",
    "url": "https://codeforces.com/problemset/problem/2095/E",
    "description": "You are given a prime number pp, nn integers a1,a2,…,ana_1, a_2, \\ldots, a_n, and an integer kk.Find the number of pairs of indexes (i,j)(i, j) (1≤i<j≤n1 \\le i < j \\le n) for which (ai⊕aj)(a2i⊕a2j)≡kmodp(a_i \\oplus a_j)(a_i^2 \\oplus a_j^2) \\equiv k \\bmod p.Here ⊕\\oplus denotes the bitwise XOR operation."
  },
  {
    "title": "Where Am I?",
    "url": "https://codeforces.com/problemset/problem/2095/D",
    "description": "  "
  },
  {
    "title": "Would It Be Unrated?",
    "url": "https://codeforces.com/problemset/problem/2095/C",
    "description": "It's a disaster. During the last April fools round, Codeforces crashed and consequentially, the round was unrated. No one knows what happened to some of the poor authors afterwards. After careful investigation, the Codeforces team has found out the reason behind this catastrophe. Apparently, authors added too many tests as they forgot the pretests were equal to system tests.We don't want to repeat this unfortunate incident and cause this round to be unrated as well. That's why we ask you for your help. Could you please help us check how many tests this problem has?"
  },
  {
    "title": "Plinko",
    "url": "https://codeforces.com/problemset/problem/2095/B",
    "description": "  Can you win 10 times?"
  },
  {
    "title": "Piecing It Together",
    "url": "https://codeforces.com/problemset/problem/2095/A",
    "description": "  "
  },
  {
    "title": "La Vaca Saturno Saturnita",
    "url": "https://codeforces.com/problemset/problem/2094/H",
    "description": "Saturnita's mood depends on an array aaa of length nnn, which only he knows the meaning of, and a function f(k,a,l,r)f(k,a,l,r)f(k, a, l, r), which only he knows how to compute. Shown below is the pseudocode for his function f(k,a,l,r)f(k,a,l,r)f(k, a, l, r). function f(k, a, l, r):   ans := 0   for i from l to r (inclusive):      while k is divisible by a[i]:         k := k/a[i]      ans := ans + k   return ansYou are given qqq queries, each containing integers kkk, lll, and rrr. For each query, please output f(k,a,l,r)f(k,a,l,r)f(k,a,l,r)."
  },
  {
    "title": "Chimpanzini Bananini",
    "url": "https://codeforces.com/problemset/problem/2094/G",
    "description": "Chimpanzini Bananini stands on the brink of a momentous battle—one destined to bring finality.For an arbitrary array bb of length mm, let's denote the rizziness of the array to be ∑mi=1bi⋅i=b1⋅1+b2⋅2+b3⋅3+…+bm⋅m\\sum_{i=1}^mb_i\\cdot i=b_1\\cdot 1+b_2\\cdot 2+b_3\\cdot 3+\\ldots + b_m\\cdot m.Chimpanzini Bananini gifts you an empty array. There are three types of operations you can perform on it.   Perform a cyclic shift on the array. That is, the array [a1,a2,…,an][a_1, a_2, \\ldots, a_n] becomes [an,a1,a2,…,an−1].[a_n, a_1, a_2, \\ldots, a_{n-1}].  Reverse the entire array. That is, the array [a1,a2,…,an][a_1, a_2, \\ldots, a_n] becomes [an,an−1,…,a1].[a_n, a_{n-1}, \\ldots, a_1].  Append an element to the end of the array. The array [a1,a2,…,an][a_1, a_2, \\ldots, a_n] becomes [a1,a2,…,an,k][a_1, a_2, \\ldots, a_n, k] after appending kk to the end of the array. After each operation, you are interested in calculating the rizziness of your array. Note that all operations are persistent. This means that each operation modifies the array, and subsequent operations should be applied to the current state of the array after the previous operations."
  },
  {
    "title": "Trulimero Trulicina",
    "url": "https://codeforces.com/problemset/problem/2094/F",
    "description": "Trulicina gives you integers nn, mm, and kk. It is guaranteed that k≥2k\\geq 2 and n⋅m≡0(modk)n\\cdot m\\equiv 0 \\pmod{k}.Output a nn by mm grid of integers such that each of the following criteria hold:  Each integer in the grid is between 11 and kk, inclusive.  Each integer from 11 to kk appears an equal number of times.  No two cells that share an edge have the same integer. It can be shown that such a grid always exists. If there are multiple solutions, output any."
  },
  {
    "title": "Boneca Ambalabu",
    "url": "https://codeforces.com/problemset/problem/2094/E",
    "description": "Boneca Ambalabu gives you a sequence of nn integers a1,a2,…,ana_1,a_2,\\ldots,a_n.Output the maximum value of (ak⊕a1)+(ak⊕a2)+…+(ak⊕an)(a_k\\oplus a_1)+(a_k\\oplus a_2)+\\ldots+(a_k\\oplus a_n) among all 1≤k≤n1 \\leq k \\leq n. Note that ⊕\\oplus denotes the bitwise XOR operation."
  },
  {
    "title": "Tung Tung Sahur",
    "url": "https://codeforces.com/problemset/problem/2094/D",
    "description": "You have two drums in front of you: a left drum and a right drum. A hit on the left can be recorded as \"L\", and a hit on the right as \"R\".The strange forces that rule this world are fickle: sometimes, a blow sounds once, and sometimes it sounds twice. Therefore, a hit on the left drum could have sounded as either \"L\" or \"LL\", and a hit on the right drum could have sounded as either \"R\" or \"RR\".The sequence of hits made is recorded in the string pp, and the sounds heard are in the string ss. Given pp and ss, determine whether it is true that the string ss could have been the result of the hits from the string pp.For example, if p=p=\"LR\", then the result of the hits could be any of the strings \"LR\", \"LRR\", \"LLR\", and \"LLRR\", but the strings \"LLLR\" or \"LRL\" cannot."
  },
  {
    "title": "Brr Brrr Patapim",
    "url": "https://codeforces.com/problemset/problem/2094/C",
    "description": "Brr Brrr Patapim is trying to learn of Tiramisù's secret passcode, which is a permutation∗^{\\text{∗}} of 2⋅n2\\cdot n elements. To help Patapim guess, Tiramisù gave him an n×nn\\times n grid GG, in which Gi,jG_{i,j} (or the element in the ii-th row and jj-th column of the grid) contains pi+jp_{i+j}, or the (i+j)(i+j)-th element in the permutation. Given this grid, please help Patapim crack the forgotten code. It is guaranteed that the permutation exists, and it can be shown that the permutation can be determined uniquely.∗^{\\text{∗}}A permutation of mm integers is a sequence of mm integers which contains each of 1,2,…,m1,2,\\ldots,m exactly once. For example, [1,3,2][1, 3, 2] and [2,1][2, 1] are permutations, while [1,2,4][1, 2, 4] and [1,3,2,3][1, 3, 2, 3] are not."
  },
  {
    "title": "Bobritto Bandito",
    "url": "https://codeforces.com/problemset/problem/2094/B",
    "description": "In Bobritto Bandito's home town of residence, there are an infinite number of houses on an infinite number line, with houses at …,−2,−1,0,1,2,…\\ldots, -2, -1, 0, 1, 2, \\ldots. On day 00, he started a plague by giving an infection to the unfortunate residents of house 00. Each succeeding day, the plague spreads to exactly one healthy household that is next to an infected household. It can be shown that each day the infected houses form a continuous segment.Let the segment starting at the ll-th house and ending at the rr-th house be denoted as [l,r][l, r]. You know that after nn days, the segment [l,r][l, r] became infected. Find any such segment [l′,r′][l', r'] that could have been infected on the mm-th day (m≤nm \\le n)."
  },
  {
    "title": "Trippi Troppi",
    "url": "https://codeforces.com/problemset/problem/2094/A",
    "description": "Trippi Troppi resides in a strange world. The ancient name of each country consists of three strings. The first letter of each string is concatenated to form the country's modern name. Given the country's ancient name, please output the modern name."
  },
  {
    "title": "Shorten the Array",
    "url": "https://codeforces.com/problemset/problem/2093/G",
    "description": "The beauty of an array bb of length mm is defined as max(bi⊕bj)\\max(b_i \\oplus b_j) among all possible pairs 1≤i≤j≤m1 \\le i \\le j \\le m, where x⊕yx \\oplus y is the bitwise XOR of numbers xx and yy. We denote the beauty value of the array bb as f(b)f(b).An array bb is called beautiful if f(b)≥kf(b) \\ge k.Recently, Kostya bought an array aa of length nn from the store. He considers this array too long, so he plans to cut out some beautiful subarray from it. That is, he wants to choose numbers ll and rr (1≤l≤r≤n1 \\le l \\le r \\le n) such that the array al…ra_{l \\dots r} is beautiful. The length of such a subarray will be the number r−l+1r - l + 1. The entire array aa is also considered a subarray (with l=1l = 1 and r=nr = n).Your task is to find the length of the shortest beautiful subarray in the array aa. If no subarray is beautiful, you should output the number −1-1."
  },
  {
    "title": "Hackers and Neural Networks",
    "url": "https://codeforces.com/problemset/problem/2093/F",
    "description": "Hackers are once again trying to create entertaining phrases using the output of neural networks. This time, they want to obtain an array of strings aa of length nn.Initially, they have an array cc of length nn, filled with blanks, which are denoted by the symbol ∗*. Thus, if n=4n=4, then initially c=[∗,∗,∗,∗]c=[*,*,*,*].The hackers have access to mm neural networks, each of which has its own version of the answer to their request – an array of strings bib_i of length nn.The hackers are trying to obtain the array aa from the array cc using the following operations:   Choose a neural network ii, which will perform the next operation on the array cc: it will select a random blank, for example, at position jj, and replace cjc_j with bi,jb_{i, j}.For example, if the first neural network is chosen and c=[∗,«like»,∗]c = [*, \\text{«like»}, *], and b1=[«I»,«love»,«apples»]b_1 = [\\text{«I»}, \\text{«love»}, \\text{«apples»}], then after the operation with the first neural network, cc may become either [«I»,«like»,∗][\\text{«I»}, \\text{«like»}, *] or [∗,«like»,«apples»][*, \\text{«like»}, \\text{«apples»}]. Choose position jj and replace cjc_j with a blank. Unfortunately, because of the way hackers access neural networks, they will only be able to see the modified array cc after all operations are completed, so they will have to specify the entire sequence of operations in advance.However, the random behavior of the neural networks may lead to the situation where the desired array is never obtained, or obtaining it requires an excessive number of operations. Therefore, the hackers are counting on your help in choosing a sequence of operations that will guarantee the acquisition of array aa in the minimum number of operations.More formally, if there exists a sequence of operations that can guarantee obtaining array aa from array cc, then among all such sequences, find the one with the minimum number of operations, and output the number of operations in it.If there is no sequence of operations that transforms array cc into array aa, then output −1-1."
  },
  {
    "title": "Min Max MEX",
    "url": "https://codeforces.com/problemset/problem/2093/E",
    "description": "You are given an array aa of length nn and a number kk.A subarray is defined as a sequence of one or more consecutive elements of the array. You need to split the array aa into kk non-overlapping subarrays b1,b2,…,bkb_1, b_2, \\dots, b_k such that the union of these subarrays equals the entire array. Additionally, you need to maximize the value of xx, which is equal to the minimum MEX(bi)(b_i), for i∈[1..k]i \\in [1..k].MEX(v)(v) denotes the smallest non-negative integer that is not present in the array vv."
  },
  {
    "title": "Skibidi Table",
    "url": "https://codeforces.com/problemset/problem/2093/D",
    "description": "Vadim loves filling square tables with integers. But today he came up with a way to do it for fun! Let's take, for example, a table of size 2×22 \\times 2, with rows numbered from top to bottom and columns numbered from left to right. We place 11 in the top left cell, 22 in the bottom right, 33 in the bottom left, and 44 in the top right. That's all he needs for fun!Fortunately for Vadim, he has a table of size 2n×2n2^n \\times 2^n. He plans to fill it with integers from 11 to 22n2^{2n} in ascending order. To fill such a large table, Vadim will divide it into 44 equal square tables, filling the top left one first, then the bottom right one, followed by the bottom left one, and finally the top right one. Each smaller table will be divided into even smaller ones as he fills them until he reaches tables of size 2×22 \\times 2, which he will fill in the order described above.Now Vadim is eager to start filling the table, but he has qq questions of two types:   what number will be in the cell at the xx-th row and yy-th column;  in which cell coordinates will the number dd be located.  Help answer Vadim's questions."
  },
  {
    "title": "Simple Repetition",
    "url": "https://codeforces.com/problemset/problem/2093/C",
    "description": "Pasha loves prime numbers∗^{\\text{∗}}! Once again, in his attempts to find a new way to generate prime numbers, he became interested in an algorithm he found on the internet:  To obtain a new number yy, repeat kk times the decimal representation of the number xx (without leading zeros). For example, for x=52x = 52 and k=3k = 3, we get y=525252y = 525252, and for x=6x = 6 and k=7k = 7, we get y=6666666y = 6666666.Pasha really wants the resulting number yy to be prime, but he doesn't yet know how to check the primality of numbers generated by this algorithm. Help Pasha and tell him whether yy is prime!∗^{\\text{∗}}An integer xx is considered prime if it has exactly 22 distinct divisors: 11 and xx. For example, 1313 is prime because it has only 22 divisors: 11 and 1313. Note that the number 11 is not prime, as it has only one divisor."
  },
  {
    "title": "Expensive Number",
    "url": "https://codeforces.com/problemset/problem/2093/B",
    "description": "The cost of a positive integer nn is defined as the result of dividing the number nn by the sum of its digits.For example, the cost of the number 104104 is 1041+0+4=20.8\\frac{104}{1 + 0 + 4} = 20.8, and the cost of the number 111111 is 1111+1+1=37\\frac{111}{1 + 1 + 1} = 37.You are given a positive integer nn that does not contain leading zeros. You can remove any number of digits from the number nn (including none) so that the remaining number contains at least one digit and is strictly greater than zero. The remaining digits cannot be rearranged. As a result, you may end up with a number that has leading zeros.For example, you are given the number 103554103554. If you decide to remove the digits 11, 44, and one digit 55, you will end up with the number 035035, whose cost is 0350+3+5=4.375\\frac{035}{0 + 3 + 5} = 4.375.What is the minimum number of digits you need to remove from the number so that its cost becomes the minimum possible?"
  },
  {
    "title": "Ideal Generator",
    "url": "https://codeforces.com/problemset/problem/2093/A",
    "description": "We call an array aa, consisting of kk positive integers, palindromic if [a1,a2,…,ak]=[ak,ak−1,…,a1][a_1, a_2, \\dots, a_k] = [a_k, a_{k-1}, \\dots, a_1]. For example, the arrays [1,2,1][1, 2, 1] and [5,1,1,5][5, 1, 1, 5] are palindromic, while the arrays [1,2,3][1, 2, 3] and [21,12][21, 12] are not.We call a number kk an ideal generator if any integer nn (n≥kn \\ge k) can be represented as the sum of the elements of a palindromic array of length exactly kk. Each element of the array must be greater than 00.For example, the number 11 is an ideal generator because any natural number nn can be generated using the array [n][n]. However, the number 22 is not an ideal generator — there is no palindromic array of length 22 that sums to 33.Determine whether the given number kk is an ideal generator."
  },
  {
    "title": "Andryusha and CCB",
    "url": "https://codeforces.com/problemset/problem/2092/F",
    "description": "Let us define the beauty of a binary string zz as the number of indices ii such that 1≤i<|z|1 \\le i < |z| and zi≠zi+1z_i \\neq z_{i+1}.While waiting for his friends from the CCB, Andryusha baked a pie, represented by a binary string ss of length nn. To avoid offending anyone, he wants to divide this string into kk substrings such that each digit belongs to exactly one substring, and the beauties of all substrings are the same.Andryusha does not know the exact number of friends from the CCB who will come to his house, so he wants to find the number of values of kk for which it is possible to split the pie into exactly kk parts with equal beauties.However, Andryusha's brother, Tristan, decided that this formulation of the problem is too simple. Therefore, he wants you to find the number of such values of kk for each prefix of the string. In other words, for each ii from 11 to nn, you need to find the number of values of kk for which it is possible to split the prefix s1s2…sis_1 s_2 \\ldots s_i into exactly kk parts with equal beauties."
  },
  {
    "title": "She knows...",
    "url": "https://codeforces.com/problemset/problem/2092/E",
    "description": "D. Pippy is preparing for a \"black-and-white\" party at his home. He only needs to repaint the floor in his basement, which can be represented as a board of size n×mn \\times m.After the last party, the entire board is painted green, except for some kk cells (x1,y1),(x2,y2),…,(xk,yk)(x_1, y_1), (x_2, y_2), \\ldots, (x_k, y_k), each of which is painted either white or black. For the upcoming party, D. Pippy wants to paint each of the remaining green cells either black or white. At the same time, he wants the number of pairs of adjacent cells with different colors on the board to be even after repainting.Formally, if A={((i1,j1),(i2,j2)) | 1≤i1,i2≤n,1≤j1,j2≤m,i1+j1<i2+j2,|i1−i2|+|j1−j2|=1,color(i1,j1)≠color(i2,j2)},A = \\left\\{((i_1, j_1), (i_2, j_2)) \\ | \\ 1 \\le i_1, i_2 \\le n, 1 \\le j_1, j_2 \\le m, i_1+j_1<i_2+j_2, |i_1-i_2|+|j_1-j_2| = 1, \\operatorname{color}(i_1, j_1) \\neq \\operatorname{color}(i_2, j_2) \\right\\}, where color(x,y)\\operatorname{color}(x, y) denotes the color of the cell (x,y)(x, y), then it is required that |A||A| be even.Help D. Pippy find the number of ways to repaint the floor so that the condition is satisfied. Since this number can be large, output the remainder of its division by 109+710^9 + 7."
  },
  {
    "title": "Mishkin Energizer",
    "url": "https://codeforces.com/problemset/problem/2092/D",
    "description": "In anticipation of a duel with his old friend Fernan, Edmond is preparing an energy drink called \"Mishkin Energizer\". The drink consists of a string ss of length nn, made up only of the characters L, I, and T, which correspond to the content of three different substances in the drink.We call the drink balanced if it contains an equal number of all substances. To boost his aura and ensure victory in the duel, Edmond must make the initial string balanced by applying the following operation:   Choose an index ii such that si≠si+1s_i \\neq s_{i+1} (where i+1i + 1 must not exceed the current size of the string).  Insert a character xx, either L, I, or T, between them such that x≠six \\neq s_i and x≠si+1x \\neq s_{i+1}. Help Edmond make the drink balanced and win the duel by performing no more than 2n\\textbf{2n} operations. If there are multiple solutions, any one of them can be output. If it is impossible, you must report this."
  },
  {
    "title": "Asuna and the Mosquitoes",
    "url": "https://codeforces.com/problemset/problem/2092/C",
    "description": "For her birthday, each of Asuna's nn admirers gifted her a tower. The height of the tower from the ii-th admirer is equal to aia_i. Asuna evaluates the beauty of the received gifts as max(a1,a2,…,an)\\max(a_1, a_2, \\ldots, a_n). She can perform the following operation an arbitrary number of times (possibly, zero).   Take such 1≤i≠j≤n1 \\le i \\neq j \\le n that ai+aja_i + a_j is odd and ai>0a_i > 0, then decrease aia_i by 11 and increase aja_j by 11.  It is easy to see that the heights of the towers remain non-negative during the operations. Help Asuna find the maximum possible beauty of the gifts after any number of operations!"
  },
  {
    "title": "Lady Bug",
    "url": "https://codeforces.com/problemset/problem/2092/B",
    "description": "As soon as Dasha Purova crossed the border of France, the villain Markaron kidnapped her and placed her in a prison under his large castle. Fortunately, the wonderful Lady Bug, upon hearing the news about Dasha, immediately ran to save her in Markaron's castle. However, to get there, she needs to crack a complex password.The password consists of two bit strings aa and bb, each of which has a length of nn. In one operation, Lady Bug can choose any index 2≤i≤n2 \\le i \\le n and perform one of the following actions:   swap(aia_i, bi−1b_{i-1}) (swap the values of aia_i and bi−1b_{i-1}), or  swap(bib_i, ai−1a_{i-1}) (swap the values of bib_i and ai−1a_{i-1}). Lady Bug can perform any number of operations. The password is considered cracked if she can ensure that the first string consists only of zeros. Help her understand whether or not she will be able to save the unfortunate Dasha."
  },
  {
    "title": "Kamilka and the Sheep",
    "url": "https://codeforces.com/problemset/problem/2092/A",
    "description": "Kamilka has a flock of nn sheep, the ii-th of which has a beauty level of aia_i. All aia_i are distinct. Morning has come, which means they need to be fed. Kamilka can choose a non-negative integer dd and give each sheep dd bunches of grass. After that, the beauty level of each sheep increases by dd.In the evening, Kamilka must choose exactly two sheep and take them to the mountains. If the beauty levels of these two sheep are xx and yy (after they have been fed), then Kamilka's pleasure from the walk is equal to gcd(x,y)\\gcd(x, y), where gcd(x,y)\\gcd(x, y) denotes the greatest common divisor (GCD) of integers xx and yy. The task is to find the maximum possible pleasure that Kamilka can get from the walk."
  },
  {
    "title": "Gleb and Boating",
    "url": "https://codeforces.com/problemset/problem/2091/G",
    "description": "Programmer Gleb frequently visits the IT Campus \"NEIMARK\" to participate in programming training sessions.Not only is Gleb a programmer, but he is also a renowned rower, so he covers part of his journey from home to the campus by kayaking along a river. Assume that Gleb starts at point 00 and must reach point ss (i.e., travel ss meters along a straight line). To make the challenge tougher, Gleb has decided not to go outside the segment [0,s][0, s]. The dimensions of the kayak can be neglected.Gleb is a strong programmer! Initially, his power is kk. Gleb's power directly affects the movement of his kayak. If his current power is xx, then with one paddle stroke the kayak moves xx meters in the current direction. Gleb can turn around and continue moving in the opposite direction, but such a maneuver is quite challenging, and after each turn, his power decreases by 11. The power can never become 00 — if his current power is 11, then even after turning it remains 11. Moreover, Gleb cannot make two turns in a row — after each turn, he must move at least once before making another turn. Similarly, Gleb cannot make a turn immediately after the start — he must first perform a paddle stroke.Gleb wants to reach point ss from point 00 without leaving the segment [0,s][0, s] and while preserving as much power as possible. Help him — given the value ss and his initial power kk, determine the maximum possible power he can have upon reaching point ss."
  },
  {
    "title": "Igor and Mountain",
    "url": "https://codeforces.com/problemset/problem/2091/F",
    "description": "The visitors of the IT Campus \"NEIMARK\" are not only strong programmers but also physically robust individuals! Some practice swimming, some rowing, and some rock climbing!Master Igor is a prominent figure in the local rock climbing community. One day, he went on a mountain hike to ascend one of the peaks. As an experienced climber, Igor decided not to follow the established trails but to use his skills to climb strictly vertically.Igor found a rectangular vertical section of the mountain and mentally divided it into nnn horizontal levels. He then split each level into mmm segments using vertical partitions. Upon inspecting these segments, Igor discovered convenient protrusions that can be grasped (hereafter referred to as holds). Thus, the selected part of the mountain can be represented as an n×mn×mn \\times m rectangle, with some cells containing holds.Being an experienced programmer, Igor decided to count the number of valid routes. A route is defined as a sequence of distinct holds. A route is considered valid if the following conditions are satisfied:   The first hold in the route is located on the very bottom level (row nnn);  The last hold in the route is located on the very top level (row 111);  Each subsequent hold is not lower than the previous one;  At least one hold is used on each level (i.e., in every row of the rectangle);  At most two holds are used on each level (since Igor has only two hands);  Igor can reach from the current hold to the next one if the distance between the centers of the corresponding sections does not exceed Igor's arm span. Igor's arm span is ddd, which means he can move from one hold to another if the Euclidean distance between the centers of the corresponding segments does not exceed ddd. The distance between sections (i1,j1i1,j1i_1, j_1) and (i2,j2i2,j2i_2, j_2) is given by √(i1−i2)2+(j1−j2)2(i1−i2)2+(j1−j2)2−−−−−−−−−−−−−−−−−√\\sqrt{(i_1 - i_2) ^ 2 + (j_1 - j_2) ^ 2}.Calculate the number of different valid routes. Two routes are considered different if they differ in the list of holds used or in the order in which these holds are visited."
  },
  {
    "title": "Interesting Ratio",
    "url": "https://codeforces.com/problemset/problem/2091/E",
    "description": "Recently, Misha at the IT Campus \"NEIMARK\" camp learned a new topic — the Euclidean algorithm.He was somewhat surprised when he realized that a⋅b=lcm(a,b)⋅gcd(a,b)a⋅b=lcm(a,b)⋅gcd(a,b)a \\cdot b = lcm(a, b) \\cdot gcd(a, b), where gcd(a,b)gcd(a,b)gcd(a, b) — is the greatest common divisor (GCD) of the numbers aaa and bbb and lcm(a,b)lcm(a,b)lcm(a, b) — is the least common multiple (LCM). Misha thought that since the product of LCM and GCD exists, it might be interesting to consider their quotient: F(a,b)=lcm(a,b)gcd(a,b)F(a,b)=lcm(a,b)gcd(a,b)F(a,b)=\\frac{lcm(a, b)}{gcd(a, b)}.For example, he took a=2a=2a = 2 and b=4b=4b = 4, computed F(2,4)=42=2F(2,4)=42=2F(2, 4) = \\frac{4}{2} = 2 and obtained a prime number (a number is prime if it has exactly two divisors)! Now he considers F(a,b)F(a,b)F(a, b) to be an interesting ratio if a<ba<ba < b and F(a,b)F(a,b)F(a, b) is a prime number.Since Misha has just started studying number theory, he needs your help to calculate — how many different pairs of numbers aaa and bbb are there such that F(a,b)F(a,b)F(a, b) is an interesting ratio and 1≤a<b≤n1≤a<b≤n1 \\leq a < b \\leq n?"
  },
  {
    "title": "Place of the Olympiad",
    "url": "https://codeforces.com/problemset/problem/2091/D",
    "description": "For the final of the first Olympiad by IT Campus \"NEIMARK\", a rectangular venue was prepared. You may assume that the venue is divided into nn rows, each containing mm spots for participants' desks. A total of kk participants have registered for the final, and each participant will sit at an individual desk. Now, the organizing committee must choose the locations for the desks in the venue.Each desk occupies one of the mm spots in a row. Moreover, if several desks occupy consecutive spots in the same row, we call such a group of desks a bench, and the number of desks in the group is the bench's length. For example, seating 77 participants on a 3×43 \\times 4 venue (with n=3,m=4n = 3, m = 4) can be arranged as follows:  In the figure above, the first row has one bench of length 33, the second row has one bench of length 22, and the third row has two benches of length 11.The organizing committee wants to choose the locations so that the length of the longest bench is as small as possible. In particular, the same 77 desks can be arranged in a more optimal way, so that the lengths of all benches do not exceed 22:  Given the integers nn, mm, and kk, determine the minimum possible length of the longest bench."
  },
  {
    "title": "Combination Lock",
    "url": "https://codeforces.com/problemset/problem/2091/C",
    "description": "At the IT Campus \"NEIMARK\", there are several top-secret rooms where problems for major programming competitions are developed. To enter one of these rooms, you must unlock a circular lock by selecting the correct code. This code is updated every day.Today's code is a permutation∗^{\\text{∗}} of the numbers from 11 to nn, with the property that in every cyclic shift†^{\\text{†}} of it, there is exactly one fixed point. That is, in every cyclic shift, there exists exactly one element whose value is equal to its position in the permutation.Output any valid permutation that satisfies this condition. Keep in mind that a valid permutation might not exist, then output −1-1.∗^{\\text{∗}}A permutation is defined as a sequence of length nn consisting of integers from 11 to nn, where each number appears exactly once. For example, (2 1 3), (1), (4 3 1 2) are permutations; (1 2 2), (3), (1 3 2 5) are not.†^{\\text{†}}A cyclic shift of an array is obtained by moving the last element to the beginning of the array. A permutation of length nn has exactly nn cyclic shifts."
  },
  {
    "title": "Team Training",
    "url": "https://codeforces.com/problemset/problem/2091/B",
    "description": "At the IT Campus \"NEIMARK\", there are training sessions in competitive programming — both individual and team-based!For the next team training session, nn students will attend, and the skill of the ii-th student is given by a positive integer aia_i.The coach considers a team strong if its strength is at least xx. The strength of a team is calculated as the number of team members multiplied by the minimum skill among the team members.For example, if a team consists of 44 members with skills [5,3,6,8][5, 3, 6, 8], then the team's strength is 4⋅min([5,3,6,8])=124 \\cdot min([5, 3, 6, 8]) = 12.Output the maximum possible number of strong teams, given that each team must have at least one participant and every participant must belong to exactly one team."
  },
  {
    "title": "Olympiad Date",
    "url": "https://codeforces.com/problemset/problem/2091/A",
    "description": "The final of the first Olympiad by IT Campus \"NEIMARK\" is scheduled for March 1, 2025. A nameless intern was tasked with forming the date of the Olympiad using digits — 01.03.2025.To accomplish this, the intern took a large bag of digits and began drawing them one by one. In total, he drew nn digits — the digit aia_i was drawn in the ii-th turn.You suspect that the intern did extra work. Determine at which step the intern could have first assembled the digits to form the date of the Olympiad (the separating dots can be ignored), or report that it is impossible to form this date from the drawn digits. Note that leading zeros must be displayed."
  },
  {
    "title": "Dining Hall",
    "url": "https://codeforces.com/problemset/problem/2090/C",
    "description": "Inside the large kingdom, there is an infinite dining hall. It can be represented as a set of cells (x,yx,yx, y), where xxx and yyy are non-negative integers. There are an infinite number of tables in the hall. Each table occupies four cells (3x+1,3y+13x+1,3y+13x + 1, 3y + 1), (3x+1,3y+23x+1,3y+23x + 1, 3y + 2), (3x+2,3y+13x+2,3y+13x + 2, 3y + 1), (3x+2,3y+23x+2,3y+23x + 2, 3y + 2), where xxx and yyy are arbitrary non-negative integers. All cells that do not belong to any of the tables are corridors.There are nnn guests that come to the dining hall one by one. Each guest appears in the cell (0,0)(0,0)(0, 0) and wants to reach a table cell. In one step, they can move to any neighboring by side corridor cell, and in their last step, they must move to a neighboring by side a free table cell. They occupy the chosen table cell, and no other guest can move there.Each guest has a characteristic titit_i, which can either be 000 or 111. They enter the hall in order, starting to walk from the cell (0,00,00, 0). If ti=1ti=1t_i=1, the iii-th guest walks to the nearest vacant table cell. If ti=0ti=0t_i=0, they walk to the nearest table cell that belongs to a completely unoccupied table. Note that other guests may choose the same table later.The distance is defined as the smallest number of steps needed to reach the table cell. If there are multiple table cells at the same distance, the guests choose the cell with the smallest xxx, and if there are still ties, they choose among those the cell with the smallest yyy.For each guest, find the table cell which they choose."
  },
  {
    "title": "Pushing Balls",
    "url": "https://codeforces.com/problemset/problem/2090/B",
    "description": "Ecrade has an n×mn×mn \\times m grid, originally empty, and he has pushed several (possibly, zero) balls in it.Each time, he can push one ball into the grid either from the leftmost edge of a particular row or the topmost edge of a particular column of the grid.When a ball moves towards a position:  If there is no ball originally at that position, the incoming ball will stop and occupy the position.  If there is already a ball at that position, the incoming ball will stop and occupy the position, while the original ball will continue moving to the next position in the same direction. Note that if a row or column is full (i.e., all positions in that row or column have balls), he cannot push a ball into that row or column.Given the final state of whether there is a ball at each position of the grid, you need to determine whether it is possible for Ecrade to push the balls to reach the final state."
  },
  {
    "title": "Treasure Hunt",
    "url": "https://codeforces.com/problemset/problem/2090/A",
    "description": "Little B and his friend Little K found a treasure map, and now they just need to dig up the treasure, which is buried at a depth of a.5a.5 meters.They take turns digging. On the first day, Little B digs; on the second day, Little K. After each day, they switch. Little B digs exactly xx meters of soil each day, while Little K digs yy meters. They became curious about who will dig up the treasure first, meaning during whose day the total dug depth will exceed a.5a.5.But they are too busy digging, so help them and tell who will dig up the treasure!"
  },
  {
    "title": "Black Cat Collapse",
    "url": "https://codeforces.com/problemset/problem/2089/E",
    "description": "The world of the black cat is collapsing. In this world, which can be represented as a rooted tree with root at node 111, Liki and Sasami need to uncover the truth about the world. Each day, they can explore a node uuu that has not yet collapsed. After this exploration, the black cat causes uuu and all nodes in its subtree to collapse. Additionally, at the end of the iii th day, if it exists, the number n−i+1n−i+1n-i+1 node will also collapse. For each iii from 111 to nnn, determine the number of exploration schemes where Liki and Sasami explore exactly iii days (i.e., they perform exactly iii operations), with the last exploration being at node 111. The result should be computed modulo 998244353998244353998\\,244\\,353.Note: It is guaranteed that nodes 111 to nnn can form a \"DFS\" order of the tree, meaning there exists a depth-first search traversal where the iii th visited node is iii."
  },
  {
    "title": "Conditional Operators",
    "url": "https://codeforces.com/problemset/problem/2089/D",
    "description": "In C++, the conditional operator ?: is used as the value of x?y:z is yyy if xx is true; otherwise, the value is zz. xx, yy, and zz may also be expressions. It is right-associated; that is, a?b:c?d:e is equivalent to a?b:(c?d:e). 00 means false and 11 means true.Given a binary string with length 2n+12n+1, you need to show whether the value of the expression can be 11 after inserting nn conditional operators into the string. You can use parentheses. For example, the string 10101 can be transformed into (1?0:1)?0:1, whose value is 11."
  },
  {
    "title": "Key of Like (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2089/C2",
    "description": "  This is the hard version of the problem. The difference between the versions is that in this version, kk can be non-zero. You can hack only if you solved all versions of this problem. A toy box is a refrigerator filled with childhood delight. Like weakness, struggle, hope ... When such a sleeper is reawakened, what kind of surprises will be waiting?M received her toy box as a birthday present from her mother. A jewellery designer would definitely spare no effort in decorating yet another priceless masterpiece as a starry firmament with exquisitely shaped gemstones. In addition, ll distinct locks secure the tiny universe of her lovely daughter: a hair clip featuring a flower design, a weathered feather pen, a balloon shaped like the letter M ... each piece obscures a precious moment.A few days ago, M rediscovered her toy box when she was reorganizing her bedroom, along with a ring of keys uniquely designed for the toy box. Attached to the key ring are (l+k)(l + k) keys, of which ll keys are able to open one of the ll locks correspondingly, while the other kk keys are nothing but counterfeits to discourage brute-force attack. To remind the correspondence, M's mother adorned each key with a gemstone of a different type. However, passing days have faded M's memory away.\"... So I have to turn to you all,\" M said while laying that ring of keys on the table.K picked up the keys and examined them carefully. \"The appearance of these keys unveils nothing fruitful. Thus, I am afraid that we shall inspect them sequentially.\"Although everyone is willing to help M, nobody has a plan. Observing others' reactions, T suggested, \"Let's play a game. Everyone tries a key in turn, and who opens the most locks is amazing.\"nn members, including M herself, take turns to unlock the toy box recursively in the same order until all the ll locks are unlocked. At each turn, the current member only selects a single key and tests it on exactly one of the locks. To open the toy box as soon as possible, every member chooses the key and the lock that maximize the probability of being a successful match. If there are multiple such pairs, a member will randomly choose one of such pairs with equal probability. Apparently, if a lock has been matched with a key, then neither the lock nor the key will be chosen again in following attempts.Assume that at the very beginning, the probability that a lock can be opened by any key is equal. If everyone always tries the optimal pairs of keys and locks based on all the historical trials, what will the expected number of successful matches be for each member?"
  },
  {
    "title": "Key of Like (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2089/C1",
    "description": "  This is the easy version of the problem. The difference between the versions is that in this version, it is guaranteed that k=0k=0. You can hack only if you solved all versions of this problem. A toy box is a refrigerator filled with childhood delight. Like weakness, struggle, hope ... When such a sleeper is reawakened, what kind of surprises will be waiting?M received her toy box as a birthday present from her mother. A jewellery designer would definitely spare no effort in decorating yet another priceless masterpiece as a starry firmament with exquisitely shaped gemstones. In addition, ll distinct locks secure the tiny universe of her lovely daughter: a hair clip featuring a flower design, a weathered feather pen, a balloon shaped like the letter M ... each piece obscures a precious moment.A few days ago, M rediscovered her toy box when she was reorganizing her bedroom, along with a ring of keys uniquely designed for the toy box. Attached to the key ring are (l+k)(l + k) keys, of which ll keys are able to open one of the ll locks correspondingly, while the other kk keys are nothing but counterfeits to discourage brute-force attack. To remind the correspondence, M's mother adorned each key with a gemstone of a different type. However, passing days have faded M's memory away.\"... So I have to turn to you all,\" M said while laying that ring of keys on the table.K picked up the keys and examined them carefully. \"The appearance of these keys unveils nothing fruitful. Thus, I am afraid that we shall inspect them sequentially.\"Although everyone is willing to help M, nobody has a plan. Observing others' reactions, T suggested, \"Let's play a game. Everyone tries a key in turn, and who opens the most locks is amazing.\"nn members, including M herself, take turns to unlock the toy box recursively in the same order until all the ll locks are unlocked. At each turn, the current member only selects a single key and tests it on exactly one of the locks. To open the toy box as soon as possible, every member chooses the key and the lock that maximize the probability of being a successful match. If there are multiple such pairs, a member will randomly choose one of such pairs with equal probability. Apparently, if a lock has been matched with a key, then neither the lock nor the key will be chosen again in following attempts.Assume that at the very beginning, the probability that a lock can be opened by any key is equal. If everyone always tries the optimal pairs of keys and locks based on all the historical trials, what will the expected number of successful matches be for each member?"
  },
  {
    "title": "Canteen (Hard Version)",
    "url": "https://codeforces.com/problemset/problem/2089/B2",
    "description": " This is the hard version of the problem. The difference between the versions is that in this version, there are no additional limits on kkk. You can hack only if you solved all versions of this problem. Ecrade has two sequences a0,a1,…,an−1a_0, a_1, \\ldots, a_{n - 1} and b0,b1,…,bn−1b_0, b_1, \\ldots, b_{n - 1} consisting of integers. It is guaranteed that the sum of all elements in aa does not exceed the sum of all elements in bb.Initially, Ecrade can make exactly kk changes to the sequence aa. It is guaranteed that kk does not exceed the sum of aa. In each change:  Choose an integer ii (0≤i<n0 \\le i < n) such that ai>0a_i > 0, and perform ai:=ai−1a_i := a_i - 1. Then Ecrade will perform the following three operations sequentially on aa and bb, which constitutes one round of operations:  For each 0≤i<n0 \\le i < n: t:=min(ai,bi),ai:=ai−t,bi:=bi−tt := \\min(a_i, b_i), a_i := a_i - t, b_i := b_i - t;  For each 0≤i<n0 \\le i < n: ci:=a(i−1)modnc_i := a_{(i - 1) \\bmod n};  For each 0≤i<n0 \\le i < n: ai:=cia_i := c_i; Ecrade wants to know the minimum number of rounds required for all elements in aa to become equal to 00 after exactly kk changes to aa.However, this seems a bit complicated, so please help him!"
  },
  {
    "title": "Canteen (Easy Version)",
    "url": "https://codeforces.com/problemset/problem/2089/B1",
    "description": " This is the easy version of the problem. The difference between the versions is that in this version, k=0k=0. You can hack only if you solved all versions of this problem. Ecrade has two sequences a0,a1,…,an−1a_0, a_1, \\ldots, a_{n - 1} and b0,b1,…,bn−1b_0, b_1, \\ldots, b_{n - 1} consisting of integers. It is guaranteed that the sum of all elements in aa does not exceed the sum of all elements in bb.Initially, Ecrade can make exactly kk changes to the sequence aa. It is guaranteed that kk does not exceed the sum of aa. In each change:  Choose an integer ii (0≤i<n0 \\le i < n) such that ai>0a_i > 0, and perform ai:=ai−1a_i := a_i - 1. Then Ecrade will perform the following three operations sequentially on aa and bb, which constitutes one round of operations:  For each 0≤i<n0 \\le i < n: t:=min(ai,bi),ai:=ai−t,bi:=bi−tt := \\min(a_i, b_i), a_i := a_i - t, b_i := b_i - t;  For each 0≤i<n0 \\le i < n: ci:=a(i−1)modnc_i := a_{(i - 1) \\bmod n};  For each 0≤i<n0 \\le i < n: ai:=cia_i := c_i; Ecrade wants to know the minimum number of rounds required for all elements in aa to become equal to 00 after exactly kk changes to aa.However, this seems a bit complicated, so please help him!"
  },
  {
    "title": "Simple Permutation",
    "url": "https://codeforces.com/problemset/problem/2089/A",
    "description": "Given an integer nnn. Construct a permutation p1,p2,…,pnp_1, p_2, \\ldots, p_n of length nn that satisfies the following property:For 1≤i≤n1 \\le i \\le n, define ci=⌈p1+p2+…+pii⌉c_i = \\lceil \\frac{p_1+p_2+\\ldots +p_i}{i} \\rceil, then among c1,c2,…,cnc_1,c_2,\\ldots,c_n there must be at least ⌊n3⌋−1\\lfloor \\frac{n}{3} \\rfloor - 1 prime numbers."
  },
  {
    "title": "Hamiltonian Partition",
    "url": "https://codeforces.com/problemset/problem/2087/I",
    "description": "You are given a directed acyclic graph with nnn vertices and mmm edges. The graph contains no cycles or multiple edges.You need to partition all the edges of this graph into Hamiltonian cycles (cycles that visit each of the nnn vertices of the graph exactly once) such that each edge belongs to exactly one cycle. It is obvious that this is impossible for the original graph, so before partitioning, you must add the minimum number of edges to the graph so that such a partition exists.After adding edges, the graph may contain cycles and/or multiple edges, but it should still not have any self-loops."
  },
  {
    "title": "Nim with Special Numbers",
    "url": "https://codeforces.com/problemset/problem/2087/H",
    "description": "Let's recall the rules of the game \"Nim\". The game is played by two players who take turns. They have a certain number of piles of stones (the piles can be of the same size or different sizes; the size is defined as the number of stones in a pile). On their turn, a player must choose any non-empty pile of stones and remove any number of stones from it (at least one). The player who cannot make a move loses.In this problem, a modified version of the game will be used. There is a special set of numbers SSS that prohibits certain moves. For each number sis_i in this set, if the current size of the pile of stones is strictly greater than sis_i, it cannot be made strictly less than sis_i in one move. In other words, if the current size of the pile is xx, and the player tries to make a move that results in a size of yy, and x>si>yx > s_i > y for some number si∈Ss_i \\in S, such a move is not allowed.Your task is as follows. Initially, the set SS is empty. You need to process queries of three types:  add a certain number sis_i to the set;  remove a certain number sis_i from the set;  determine who will win if this modified version of Nim is played with piles of stones of sizes a1,a2,…,aka_1, a_2, \\dots, a_k. Assume that both players play optimally. "
  },
  {
    "title": "Esports in Berland",
    "url": "https://codeforces.com/problemset/problem/2087/G",
    "description": "Recently, esports has been recognized as an official sport in Berland, and regular competitions have begun to take place. Riding the wave of popularity, Monocarp also decided to participate in the upcoming competitions (besides, prizes have never hurt anyone).In each of the following nnn days, one competition will be held. Monocarp would like to participate in all of them, but unfortunately, his current skill level sss is 000. At the same time, the prize money Monocarp can earn in competitions depends on his skill level. Therefore, Monocarp decided that he could sacrifice participating in some competitions to train and increase his skill level on those days.In general, on the iii-th day, Monocarp can:   either participate in the iii-th competition and earn ai+sai+sa_i + s units of money, where sss is his current skill level;  or skip the competition to train: Monocarp will earn nothing but will increase his skill level sss by 111. Help Monocarp calculate his maximum total income and the number of training plans with such income. Two training plans are considered different if there exists a day that is a training day in one plan and a competition day in the other one."
  },
  {
    "title": "Weapon Upgrade",
    "url": "https://codeforces.com/problemset/problem/2087/F",
    "description": "Monocarp is playing a game. The game is divided into stages, and there are a total of 13371337 stages. The game character uses a weapon with two attack modes: physical and elemental. Initially, the weapon's physical attack power is 11, and its elemental attack power is also 11.During the ii-th stage of the game, the following events occur in order:   If i≤ni \\le n, a monster with a physical defense aia_i and elemental defense bib_i appears. Otherwise, nothing happens.  Monocarp can shoot at exactly one of the remaining monsters. If the monster's physical defense is at most the character's physical attack power or the monster's elemental defense is at most the character's elemental attack power, the monster will be killed. Otherwise, nothing happens.  Each surviving monster deals 11 damage to the game character. After each kill, Monocarp can upgrade one of the attacks of the weapon by 11.Your task is to calculate the minimum damage that Monocarp can get in order to kill all the monsters in the game (or report that it is impossible to kill all the monsters)."
  },
  {
    "title": "Color the Arrows",
    "url": "https://codeforces.com/problemset/problem/2087/E",
    "description": "There are nn arrows drawn in a row on a strip of paper, numbered from 11 to nn. Each arrow points either to the left or to the right. Initially, all arrows are painted blue.In one operation, you can repaint a blue arrow into red. For the first operation, you can choose any arrow. For each subsequent operation, you are only allowed to choose such an arrow that the arrow repainted on the previous operation points in its direction. That is, if the arrow repainted in the previous operation is a left arrow, then, for the current operation, you have to choose an arrow at a smaller index than the previous one. Similarly, if the previous arrow was a right arrow, the current one has to be at a greater index than it. Note that the arrows don't have to be adjacent.Each arrow has an integer reward for repainting it into red (which can be negative, positive, or zero).The final score is the sum of the rewards for the repainted arrows. What is the maximum score that can be achieved if you are allowed to perform any number of operations (including zero)?"
  },
  {
    "title": "Uppercase or Lowercase?",
    "url": "https://codeforces.com/problemset/problem/2087/D",
    "description": "This is an interactive problem.In a certain database, there are nn handles stored in the form of a numbered list. You are interested in one specific handle hh, or more precisely, in its position in this list.You can ask the database for the position ii from the list, and it will return the handle at the ii-th position.All handles are non-empty strings consisting of at most 2020 lowercase Latin letters, except the first one that can be either a lowercase or an uppercase Latin letter.You know that all handles are sorted in lexicographical order, but the problem is that it is unknown whether uppercase letters are considered less than lowercase ones. In other words, you do not know if it is true that all handles starting with uppercase letters come first, followed by those starting with lowercase letters — or vice versa, that all handles starting with lowercase letters come first, followed by those starting with uppercase letters.Lexicographical order is the order of standard string comparison, formally defined as follows:  if strings ss and tt differ in some positions, the earliest of which is position ii, then string ss comes before string tt in lexicographical order if and only if si<tis_i < t_i (for example, for the strings cats and current, the first position with different characters is 22, and the character a is less than the character u, so cats is lexicographically less than current);  if strings ss and tt have no positions with different characters, then the shorter one comes first. For example, the string cat comes before the string cats. Due to restricted access to the database, you can make no more than 1010 queries to it. Determine the position of the handle you are interested in, knowing that it is definitely in the list."
  }
]